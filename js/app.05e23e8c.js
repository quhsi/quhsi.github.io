(()=>{var e={84647:(e,t,n)=>{"use strict";n(18964),n(40702);var s=n(61957),i=n(71947),o=n(60499),a=n(59835);function l(e,t,n,s,i,o){const l=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(l)}const r=(0,a.aZ)({name:"App"});var d=n(11639);const u=(0,d.Z)(r,[["render",l]]),c=u;var p=n(54927),h=n(23340),g=n(28339);const m=[{path:"/",component:()=>Promise.all([n.e(736),n.e(64),n.e(389)]).then(n.bind(n,46804)),children:[{path:"",component:()=>Promise.all([n.e(736),n.e(64),n.e(443)]).then(n.bind(n,29443)),name:"feed"},{path:"/follow",component:()=>Promise.all([n.e(736),n.e(64),n.e(61)]).then(n.bind(n,24384)),name:"follow"},{path:"/settings/:initUser?",component:()=>Promise.all([n.e(736),n.e(64),n.e(499)]).then(n.bind(n,52801)),name:"settings"},{path:"/messages/inbox",component:()=>Promise.all([n.e(736),n.e(669)]).then(n.bind(n,38669)),name:"inbox"},{path:"/messages/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(721)]).then(n.bind(n,22721)),name:"messages"},{path:"/:eventId(note[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(64),n.e(782)]).then(n.bind(n,92782)),name:"event"},{path:"/notifications",component:()=>Promise.all([n.e(736),n.e(64),n.e(431)]).then(n.bind(n,1938)),name:"notifications"},{path:"/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(64),n.e(980)]).then(n.bind(n,63700)),name:"profile"},{path:"/hashtag/:hashtagId([a-zA-Z0-9_]{1,63})",component:()=>Promise.all([n.e(736),n.e(64),n.e(430)]).then(n.bind(n,82430)),name:"hashtag"},{path:"/devTools",component:()=>Promise.all([n.e(736),n.e(101)]).then(n.bind(n,98101)),name:"devTools"},{path:"/:catchAll(.*)*",component:()=>Promise.all([n.e(736),n.e(506)]).then(n.bind(n,29506))}]}],y=m,f=(0,h.BC)((()=>{const e=g.PO,t=(0,g.p7)({routes:y,history:e("/")});return t}));async function w(e,t){const s=e(c);s.use(i.Z,t);const a="function"===typeof p["default"]?await(0,p["default"])({}):p["default"],{storeKey:l}=await Promise.resolve().then(n.bind(n,54927)),r=(0,o.Xl)("function"===typeof f?await f({store:a}):f);return a.$router=r,{app:s,store:a,storeKey:l,router:r}}var v=n(6827),b=n(97286),k=n(79231);const x={config:{dark:!0,notify:{closeBtn:!0}},plugins:{Notify:v.Z,Dialog:b.Z,Meta:k.ZP}},C="/";async function M({app:e,router:t,store:n,storeKey:s},i){let o=!1;const a=e=>{try{return t.resolve(e).href}catch(n){}return Object(e)===e?null:e},l=e=>{if(o=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=a(e);null!==t&&(window.location.href=t)},r=window.location.href.replace(window.location.origin,"");for(let u=0;!1===o&&u<i.length;u++)try{await i[u]({app:e,router:t,store:n,ssrContext:null,redirect:l,urlPath:r,publicPath:C})}catch(d){return d&&d.url?void l(d.url):void console.error("[Quasar] boot error:",d)}!0!==o&&(e.use(t),e.use(n,s),e.mount("#q-app"))}w(s.ri,x).then((e=>Promise.all([Promise.resolve().then(n.bind(n,37638)),Promise.resolve().then(n.bind(n,55635))]).then((t=>{const n=t.map((e=>e.default)).filter((e=>"function"===typeof e));M(e,n)}))))},37638:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tn});n(40702);var s=n(59835),i=n(86970),o=n(61957);const a=e=>((0,s.dD)("data-v-07a122a1"),e=e(),(0,s.Cn)(),e),l={clickable:"",avatar:"",top:"",class:"relative-position"},r={key:0,class:"is-reply-connector"},d={key:1,class:"has-reply-connector"},u={class:"flex column no-wrap col full-width"},c={class:"q-pb-xs"},p=a((()=>(0,s._)("span",null,"in reply to ",-1))),h={key:3},g={key:4,class:"reposts flex column q-pr-md",clickable:!1},m=["color"],y={key:0,class:"text-primary text-thin col q-pl-xs",style:{"font-size":"90%","font-weight":"300"}},f={class:"flex row no-wrap"},w=(0,s.Uk)(" embed "),v=(0,s.Uk)(" repost "),b=(0,s.Uk)(" quote "),k=(0,s.Uk)(" reply "),x={class:"flex row no-wrap items-center"},C=(0,s.Uk)(" cancel "),M={key:6,style:{"min-height":"1rem"}},_=a((()=>(0,s._)("span",{class:"text-caption"}," copy the formatted event ID below and paste it in any post to embed this event ",-1))),q=a((()=>(0,s._)("br",null,null,-1))),T={class:"text-primary",style:{"word-break":"break-all"}},B={key:1,class:"full-width"},S={key:2,style:{"min-height":".5rem"}};function z(e,t,n,a,z,Z){const W=(0,s.up)("BaseUserAvatar"),$=(0,s.up)("q-item-label"),j=(0,s.up)("BaseButtonRelays"),D=(0,s.up)("BaseButtonInfo"),L=(0,s.up)("q-space"),P=(0,s.up)("BaseUserName"),R=(0,s.up)("BaseMarkdown"),E=(0,s.up)("BaseRelayRecommend"),U=(0,s.up)("BaseUserCard"),I=(0,s.up)("BasePost",!0),N=(0,s.up)("BaseButtonLightning"),A=(0,s.up)("q-tab"),O=(0,s.up)("q-tooltip"),F=(0,s.up)("q-icon"),H=(0,s.up)("q-tabs"),Q=(0,s.up)("q-separator"),V=(0,s.up)("q-btn"),K=(0,s.up)("q-item-section"),J=(0,s.up)("BaseButtonCopy"),Y=(0,s.up)("q-tab-panel"),X=(0,s.up)("BasePostEntry"),G=(0,s.up)("q-tab-panels"),ee=(0,s.up)("BasePostThread");return(0,s.wg)(),(0,s.iD)("div",{color:"accent",class:(0,i.C_)(["post-padding cursor-pointer no-hover flex row no-wrap",(e.hasReply?"post-has-reply":"")+(e.isReply?" post-is-reply":"")+(e.highlighted?" post-highlighted":"")+(e.isChildReply?" post-is-child-reply":"")+(e.hasReplyChildren?" post-has-child-reply":"")]),clickable:"","manual-focus":"",onClick:t[14]||(t[14]=(0,o.iM)((t=>e.toEvent(e.event.id)),["stop"]))},[(0,s._)("div",l,[e.isReply?((0,s.wg)(),(0,s.iD)("div",r)):(0,s.kq)("",!0),(0,s.Wm)(W,{pubkey:e.event.pubkey,size:"1.5rem",round:!0,bordered:e.hasReply||e.isReply||e.hasReplyChildren||e.isChildReply,"hover-effect":!0,style:{"z-index":"1"}},null,8,["pubkey","bordered"]),e.hasReply?((0,s.wg)(),(0,s.iD)("div",d)):(0,s.kq)("",!0),"reply"===e.replyMode?((0,s.wg)(),(0,s.iD)("div",{key:2,class:"has-replying-connector",style:(0,i.j5)("height: "+e.postHeight+"px;")},null,4)):(0,s.kq)("",!0),e.hasReplyChildren?((0,s.wg)(),(0,s.iD)("div",{key:3,ref:"hasChildReplyConnector",class:"has-child-reply-connector",style:(0,i.j5)([{visibility:"hidden"},e.childReplyConnectorStyle()])},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.event.replies,((t,n)=>((0,s.wg)(),(0,s.iD)("div",{key:t[0].id,ref_for:!0,ref:"hasChildReplyConnectorTick",class:"has-child-reply-tick",style:(0,i.j5)(e.childReplyTickStyle(n))},null,4)))),128))],4)):(0,s.kq)("",!0)]),(0,s._)("div",u,[(0,s.Wm)(K,{ref:"postContent",class:"relative-position",style:{padding:"0 .2rem"}},{default:(0,s.w5)((()=>[(0,s._)("div",{class:"absolute-top-right flex row items-center post-info",style:{"z-index":"1"},onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},[(0,s.Wm)($,{class:"q-pr-xs",style:{opacity:".8","font-size":"90%"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.niceDate(e.event.created_at)),1)])),_:1}),(0,s.Wm)(j,{"button-class":"text-secondary",event:e.event},null,8,["event"]),(0,s.Wm)(D,{"button-class":"text-secondary",event:e.event},null,8,["event"])]),(0,s._)("div",c,[(0,s.Wm)($,{caption:"",class:"text-secondary",style:{opacity:".7"}},{default:(0,s.w5)((()=>[(0,s._)("span",{onClick:t[1]||(t[1]=(0,o.iM)((t=>e.toProfile(e.event.pubkey)),["stop"]))},(0,i.zw)(e.shorten(e.hexToBech32(e.event.pubkey,"npub"))),1)])),_:1}),(0,s.Wm)(L),(0,s.Wm)($,{line:1,clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(P,{pubkey:e.event.pubkey,"show-verified":!0,class:"text-bold","show-following":!0},null,8,["pubkey"])])),_:1}),!e.tagged||"event"==e.$route.name||e.isReply||e.isChildReply?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)($,{key:0,class:"q-pl-sm",style:{"font-size":".9rem"}},{default:(0,s.w5)((()=>[p,(0,s._)("a",{onClick:t[2]||(t[2]=(0,o.iM)((t=>e.toEvent(e.tagged)),["stop"]))},(0,i.zw)(e.shorten(e.hexToBech32(e.tagged,"note"))),1)])),_:1}))]),1===e.event.kind?((0,s.wg)(),(0,s.j4)(R,{key:0,content:e.event.interpolated.text,"long-form":e.isLongForm,onExpand:t[3]||(t[3]=t=>e.isLongForm=!e.isLongForm),onResized:t[4]||(t[4]=t=>e.calcConnectorValues(10))},null,8,["content","long-form"])):2===e.event.kind?((0,s.wg)(),(0,s.j4)(E,{key:1,url:e.sanitize(e.event.content)},null,8,["url"])):0===e.event.kind?((0,s.wg)(),(0,s.j4)(U,{key:2,pubkey:e.event.pubkey,"header-mode":!0},null,8,["pubkey"])):((0,s.wg)(),(0,s.iD)("pre",h," "+(0,i.zw)(e.cleanEvent)+" ",1)),e.isEmbeded||!e.isQuote&&!e.isRepost?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",g,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.reposts,((n,i)=>((0,s.wg)(),(0,s.j4)(I,{key:n.id+"_"+e.reposts.length+"_"+i,event:n,"manual-focus":!1,"is-embeded":!0,onClick:(0,o.iM)((t=>e.toEvent(n.id)),["stop"]),onResized:t[5]||(t[5]=t=>e.calcConnectorValues(10))},null,8,["event","onClick"])))),128))])),!e.isRepost&&e.$store.state.keys.pub&&-1!==e.replyDepth?((0,s.wg)(),(0,s.iD)("div",{key:5,class:(0,i.C_)(["flex row items-center no-wrap reply-buttons",e.replying?"justify-between":"justify-end"]),color:e.replying?"primary":""},[e.replyMode&&"tip"!==e.replyMode?((0,s.wg)(),(0,s.iD)("div",y,(0,i.zw)(e.replyMode),1)):(0,s.kq)("",!0),(0,s._)("div",f,[(0,s.Wm)(H,{modelValue:e.replyMode,"onUpdate:modelValue":t[6]||(t[6]=t=>e.replyMode=t),class:"no-padding no-margin",unelevated:"",dense:"",flat:"","active-color":"primary",size:e.highlighted?"md":"sm",onClick:t[7]||(t[7]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(A,{name:"tip",class:"no-padding"},{default:(0,s.w5)((()=>[e.$store.getters.profileLud06(e.event.pubkey)?((0,s.wg)(),(0,s.j4)(N,{key:0,pubkey:e.event.pubkey,size:e.highlighted?"md":"sm"},null,8,["pubkey","size"])):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(A,{name:"embed",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{name:"link"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[w])),_:1})])),_:1})])),_:1}),(0,s.Wm)(A,{name:"repost",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{name:"repeat"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[v])),_:1})])),_:1})])),_:1}),(0,s.Wm)(A,{name:"quote",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{name:"format_quote"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[b])),_:1})])),_:1})])),_:1}),(0,s.Wm)(A,{name:"reply",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{name:"chat_bubble_outline",class:"flip-horizontal"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[k])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","size"]),(0,s._)("div",x,[e.replyMode&&"tip"!==e.replyMode?((0,s.wg)(),(0,s.j4)(Q,{key:0,color:"primary",size:"1px",vertical:"",spaced:"",class:(0,i.C_)(e.highlighted?"q-mt-sm":"q-mt-xs")},null,8,["class"])):(0,s.kq)("",!0),e.replyMode&&"tip"!==e.replyMode?((0,s.wg)(),(0,s.j4)(V,{key:1,icon:"close",color:"primary",flat:"",dense:"",onClick:t[8]||(t[8]=(0,o.iM)((t=>e.replyMode=null),["stop"])),size:e.highlighted?"md":"sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,null,{default:(0,s.w5)((()=>[C])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0)])])],10,m)):((0,s.wg)(),(0,s.iD)("div",M))])),_:1},512),e.replyMode&&"tip"!==e.replyMode?((0,s.wg)(),(0,s.j4)(K,{key:0,class:"new-reply-box",ref:"replyContent"},{default:(0,s.w5)((()=>[(0,s.Wm)(G,{modelValue:e.replyPanel,"onUpdate:modelValue":t[11]||(t[11]=t=>e.replyPanel=t),class:"no-padding full-width overflow-hidden",style:{"background-color":"inherit","max-width":"100%",padding:"0 .25 0 0"},onTransition:t[12]||(t[12]=t=>e.calcConnectorValues(10))},{default:(0,s.w5)((()=>[(0,s.Wm)(Y,{name:"embed",class:"no-padding",onClick:t[9]||(t[9]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[_,(0,s.Wm)(J,{"button-text":e.hexToBech32(e.event.id,"note"),color:"primary",flat:"","tooltip-text":"copy event ID"},null,8,["button-text"]),q,(0,s._)("span",T,(0,i.zw)(e.hexToBech32(e.event.id,"note")),1)])),_:1}),(0,s.Wm)(Y,{name:"reply",class:"q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(X,{event:e.event,"reply-mode":e.replyMode,onSent:e.replySent,onResized:t[10]||(t[10]=t=>e.calcConnectorValues(10))},null,8,["event","reply-mode","onSent"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,s.kq)("",!0),e.hasReplyChildren&&-1!==e.replyDepth?((0,s.wg)(),(0,s.iD)("div",B,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.event.replies,(n=>((0,s.wg)(),(0,s.iD)("div",{key:n[0].id,ref_for:!0,ref:"childReplyContent"},[(0,s.Wm)(ee,{events:n,"reply-depth":e.replyDepth+1,onResized:t[13]||(t[13]=t=>e.calcConnectorValues(10)),onAddEvent:e.addEvent},null,8,["events","reply-depth","onAddEvent"])])))),128))])):(0,s.kq)("",!0),e.isRepost?((0,s.wg)(),(0,s.iD)("div",S)):(0,s.kq)("",!0)])],2)}var Z=n(22330),W=n(18933),$=n(73270),j=n(39057),D=n(45032),L=n(50105),P=n(76877),R=n(78414),E=n(88995);const U=(0,s.aZ)({name:"BasePost",emits:["resized","add-event","mounted"],mixins:[W.Z],props:{event:{type:Object,required:!0},highlighted:{type:Boolean,default:!1},position:{type:String,default:"standalone"},replyDepth:{type:Number,default:0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:$.Z,BaseButtonInfo:j.Z,BaseButtonCopy:D.Z,BaseMarkdown:L.Z,BaseRelayRecommend:P.Z,BaseButtonLightning:R.Z},data(){return{clicking:!1,replying:!1,childReplyHeights:[],postHeight:0,replyHeight:0,reposts:[],eventSub:null,replyMode:"",resizing:!1,trigger:1,isLongForm:!1}},computed:{tagged(){var e;let t=null===(e=this.event.interpolated)||void 0===e?void 0:e.replyEvents;return null!==t&&void 0!==t&&t.length?t[t.length-1]:null},isRepost(){var e;return""===(null===(e=this.event.interpolated)||void 0===e?void 0:e.text)&&this.event.interpolated.mentionEvents.length},isQuote(){var e;return(null===(e=this.event.interpolated)||void 0===e?void 0:e.text)&&this.event.interpolated.mentionEvents.length},mentionEvents(){var e;return null===(e=this.event.interpolated)||void 0===e?void 0:e.mentionEvents},isReply(){return"middle"===this.position||"last"===this.position},hasReply(){return"middle"===this.position||"first"===this.position},isChildReply(){return!!this.replyDepth},hasReplyChildren(){return!!(this.event.replies&&this.event.replies.length>0)},postContentWidth(){var e,t,n,s;return this.resizing?null===(e=this.$refs.postContent)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth:null===(n=this.$refs.postContent)||void 0===n||null===(s=n.$el)||void 0===s?void 0:s.clientWidth},postContentHeight(){var e,t,n,s;return this.resizing?null===(e=this.$refs.postContent)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientHeight:null===(n=this.$refs.postContent)||void 0===n||null===(s=n.$el)||void 0===s?void 0:s.clientHeight},replyContentHeight(){var e,t,n,s,i;return this.replyMode&&this.resizing&&null!==(e=this.$refs.replyContent)&&void 0!==e&&e.$el?null===(t=this.$refs.replyContent)||void 0===t||null===(n=t.$el)||void 0===n?void 0:n.clientHeight:(null===(s=this.$refs.replyContent)||void 0===s||null===(i=s.$el)||void 0===i?void 0:i.clientHeight)||0},replyPanel(){return"embed"===this.replyMode?"embed":this.replyMode?"reply":""},cleanEvent(){return this.sanitize(JSON.stringify((0,Z.CX)(this.event),null,2))}},mounted(){this.isEmbeded||!this.isQuote&&!this.isRepost||(Array.isArray(this.reposts)||(this.reposts=[]),this.processTaggedEvents(this.mentionEvents,this.reposts)),this.calcConnectorValues(),this.$emit("mounted"),this.isLongForm=this.event.content.length>600||this.event.content.split(/\r\n|\r|\n/).length>10},activated(){this.calcConnectorValues(),this.trigger++},deactivated(){if(this.reposts.length)for(let e of this.reposts)this.$store.dispatch("cancelUseProfile",{pubkey:e.pubkey})},methods:{childReplyConnectorStyle(){var e;if(null!==(e=this.childReplyHeights)&&void 0!==e&&e.length){let e=this.postHeight+this.childReplyHeights.slice(0,-1).reduce(((e,t)=>e+t),0);return this.replyHeight&&(e+=this.replyHeight),"visibility: visible; height: "+e+"px"}return""},childReplyTickStyle(e){var t;if(null!==(t=this.childReplyHeights)&&void 0!==t&&t.length){let t=this.postHeight+this.childReplyHeights.filter(((t,n)=>n<e)).reduce(((e,t)=>e+t),0);return this.replyHeight&&(t+=this.replyHeight),"visibility: visible; top: "+t+"px"}return""},calcConnectorValues(e=2e3){this.resizing=!this.resizing,(0,s.Y3)((()=>{setTimeout((()=>{var e;(this.postHeight=this.postContentHeight,this.replyHeight=this.replyContentHeight,this.hasReplyChildren)&&(this.childReplyHeights=null===(e=this.$refs.childReplyContent)||void 0===e?void 0:e.map((e=>e.clientHeight)));this.$emit("resized")}),e)}))},toggleReplying(){""===this.replyMode?(this.replying=!0,this.replyMode="reply"):(this.replyMode="",this.replying=!1),this.calcConnectorValues(10)},replySent(e){this.replying=!1,this.replyMode="",this.$emit("add-event",e)},niceDate(e){return this.trigger,this.niceDateUTC(e)},addEvent(e){this.$emit("add-event",e)},sanitize(e){return E.sanitize(e)}}});var I=n(11639),N=n(76749),A=n(33115),O=n(90136),F=n(47817),H=n(70900),Q=n(22857),V=n(46858),K=n(50926),J=n(24455),Y=n(89800),X=n(84106),G=n(69984),ee=n.n(G);const te=(0,I.Z)(U,[["render",z],["__scopeId","data-v-07a122a1"]]),ne=te;ee()(U,"components",{QItemSection:N.Z,QItemLabel:A.Z,QSpace:O.Z,QTabs:F.Z,QTab:H.Z,QIcon:Q.Z,QTooltip:V.Z,QSeparator:K.Z,QBtn:J.Z,QTabPanels:Y.Z,QTabPanel:X.Z});const se={key:0,class:"text-bold flex row no-wrap items-center",style:{gap:".2rem"},clickable:""},ie=(0,s.Uk)(" following "),oe={key:0,style:{opacity:".9","font-size":"90%","font-weight":"300","line-height":"90%"}},ae={key:1,style:{opacity:".9","font-size":"90%","font-weight":"300","line-height":"90%"}};function le(e,t,n,a,l,r){const d=(0,s.up)("q-tooltip"),u=(0,s.up)("q-icon"),c=(0,s.up)("BaseButtonNIP05");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["cursor-pointer flex",(n.alignRight?" justify-end":" justify-start")+(n.headerMode?" column items-start":" row items-center")+(n.wrap?"":" no-wrap")]),onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(n.pubkey)),["stop"])),style:(0,i.j5)([{gap:".1rem"},n.alignRight?"text-align: right;":"text-align: left"])},[e.$store.getters.name(n.pubkey)?((0,s.wg)(),(0,s.iD)("div",se,[(0,s.Uk)((0,i.zw)(e.$store.getters.name(n.pubkey))+" ",1),n.showFollowing&&r.isFollow?((0,s.wg)(),(0,s.j4)(u,{key:0,name:"visibility",size:n.headerMode?"sm":"xs",color:"secondary"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[ie])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",{class:"flex row no-wrap items-center",style:(0,i.j5)(n.headerMode?"gap: .3rem;":"gap: .1rem;")},[(0,s.Wm)(c,{pubkey:n.pubkey,"button-size":n.headerMode?"sm":"xs"},null,8,["pubkey","button-size"]),e.$store.getters.NIP05Id(n.pubkey)?((0,s.wg)(),(0,s.iD)("div",oe,(0,i.zw)(n.headerMode?r.niceNIP05:r.niceShortNIP05),1)):(0,s.kq)("",!0)],4),n.headerMode&&e.lnurlToLnAddr(e.$store.getters.profileLud06(n.pubkey))?((0,s.wg)(),(0,s.iD)("div",ae," ⚡️"+(0,i.zw)(e.lnurlToLnAddr(e.$store.getters.profileLud06(n.pubkey))),1)):(0,s.kq)("",!0)],6)}n(18964),n(46727);const re={class:"flex row justify-end"},de={class:"overflow-auto"},ue={class:"text-subtitle1 flex row overflow-auto items-end q-gutter-sm"},ce=(0,s.Uk)(" NIP05 identifier "),pe=["href"],he={key:0},ge=(0,s._)("div",null,[(0,s.Uk)("learn how to get NIP05 verified "),(0,s._)("a",{href:"https://gist.github.com/metasikander/609a538e6a03b2f67e5c8de625baed3e",target:"_"},"here")],-1),me=(0,s.Uk)(" NIP05 verified ");function ye(e,t,n,a,l,r){const d=(0,s.up)("q-btn"),u=(0,s.up)("q-spinner-orbit"),c=(0,s.up)("q-inner-loading"),p=(0,s.up)("q-card-section"),h=(0,s.up)("q-card"),g=(0,s.up)("q-dialog"),m=(0,s.up)("q-tooltip"),y=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(g,{modelValue:l.NIP05Dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>l.NIP05Dialog=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,s.w5)((()=>[(0,s._)("div",re,[(0,s.wy)((0,s.Wm)(d,{icon:"close",flat:"",dense:""},null,512),[[y]])]),(0,s._)("div",de,[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",ue,[ce,(0,s._)("a",{href:r.NIP05Link,target:"_"},(0,i.zw)(r.NIP05Link),9,pe)]),r.NIP05Loaded?((0,s.wg)(),(0,s.iD)("pre",he,(0,i.zw)(r.NIP05Formatted),1)):(0,s.kq)("",!0),(0,s.Wm)(c,{showing:!r.NIP05Loaded},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{color:"accent",size:"2rem"})])),_:1},8,["showing"]),ge])),_:1})])])),_:1})])),_:1},8,["modelValue"]),e.$store.getters.NIP05Id(n.pubkey)?((0,s.wg)(),(0,s.j4)(d,{key:0,icon:"verified",color:"accent",flat:"",dense:"",size:n.buttonSize,class:"no-padding",clickable:"",onClick:(0,o.iM)(r.openNIP05,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[me])),_:1})])),_:1},8,["size","onClick"])):(0,s.kq)("",!0)],64)}var fe=n(33688),we=n.n(fe),ve=n(6827);const be={mixins:[W.Z],props:{pubkey:{type:String,required:!0},buttonSize:{type:String,default:"xs"}},data(){return{NIP05Dialog:!1,NIP05Data:{}}},computed:{NIP05Link(){let[e,t]=this.$store.getters.NIP05Id(this.pubkey).split("@");return t||(t=e,e="_"),`https://${t}/.well-known/nostr.json?name=${e}`},NIP05Formatted(){return this.json(this.NIP05Data)},NIP05Loaded(){return!!Object.keys(this.NIP05Data).length}},methods:{openNIP05(){this.loadNIP05Data(),this.NIP05Dialog=!this.NIP05Dialog},async loadNIP05Data(){try{this.NIP05Data=await(await we()(this.NIP05Link)).json()}catch(e){ve.Z.create({message:"failed to fetch NIP05 identifier",color:"negative"})}}}};var ke=n(87743),xe=n(44458),Ce=n(63190),Me=n(60854),_e=n(10786),qe=n(62146);const Te=(0,I.Z)(be,[["render",ye]]),Be=Te;ee()(be,"components",{QDialog:ke.Z,QCard:xe.Z,QBtn:J.Z,QCardSection:Ce.Z,QInnerLoading:Me.Z,QSpinnerOrbit:_e.Z,QTooltip:V.Z}),ee()(be,"directives",{ClosePopup:qe.Z});const Se={mixins:[W.Z],components:{BaseButtonNIP05:Be},props:{pubkey:{type:String,required:!0},wrap:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},headerMode:{type:Boolean,default:!1},showFollowing:{type:Boolean,default:!1}},computed:{niceShortNIP05(){let e=this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0===t&&e===this.$store.getters.name(this.pubkey)?"":e)).join("@");return e.startsWith("_@")?e.replace("_@",""):e},niceNIP05(){return this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0===t&&"_"===e?"":e)).join("@")},isFollow(){return this.$store.state.follows.includes(this.pubkey)}}},ze=(0,I.Z)(Se,[["render",le]]),Ze=ze;ee()(Se,"components",{QIcon:Q.Z,QTooltip:V.Z});const We=["src"];function $e(e,t,n,a,l,r){const d=(0,s.up)("BaseButtonNIP05"),u=(0,s.up)("q-avatar");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)((n.bordered?"bordered-avatar":"")+(n.hoverEffect?" hovered-avatar":""))},[(0,s.Wm)(u,{rounded:!n.round,class:"relative-position",size:n.size,onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(n.pubkey)),["stop"]))},{default:(0,s.w5)((()=>[(0,s._)("img",{src:e.$store.getters.avatar(n.pubkey),loading:"lazy",async:""},null,8,We),(0,s._)("div",{class:(0,i.C_)([n.alignRight?"icon-right":"icon-left","q-pt-xs"])},[n.showVerified?((0,s.wg)(),(0,s.j4)(d,{key:0,pubkey:n.pubkey,"button-size":"xs"},null,8,["pubkey"])):(0,s.kq)("",!0)],2)])),_:1},8,["rounded","size"])],2)}const je={mixins:[W.Z],components:{BaseButtonNIP05:Be},props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,default:!1},size:{type:String,default:""},round:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},showVerified:{type:Boolean,default:!1},hoverEffect:{type:Boolean,default:!1}}};var De=n(61357);const Le=(0,I.Z)(je,[["render",$e],["__scopeId","data-v-43e98880"]]),Pe=Le;ee()(je,"components",{QAvatar:De.Z});var Re=n(35749);const Ee=e=>((0,s.dD)("data-v-67c80742"),e=e(),(0,s.Cn)(),e),Ue={key:1,clickable:!1,class:"embeded-message q-px-sm q-py-xs"},Ie={class:"relative-position"},Ne={key:0,class:"flex row items-center",style:{gap:".3rem"}},Ae={class:"input-area"},Oe={id:"input-placeholder"},Fe={id:"input-readonly-highlight",contenteditable:"true",spellcheck:"false"},He=["contenteditable"],Qe=Ee((()=>(0,s._)("div",{id:"input-readonly",contenteditable:"true",spellcheck:"false"},null,-1))),Ve={key:0,class:"absolute-top full-width row justify-center q-my-md"},Ke={style:{"font-size":".9rem"}},Je={key:0,class:"q-pl-xs"},Ye=Ee((()=>(0,s._)("div",{class:"text-secondary"},"links added",-1))),Xe={dense:"",style:{"font-size":".8rem","font-weight":"300"}},Ge={class:"col-11",style:{"overflow-x":"auto"}},et={class:"flex row justify-between"},tt=Ee((()=>(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[(0,s._)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),(0,s._)("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})],-1))),nt=(0,s.Uk)(" add emoji "),st=(0,s.Uk)(" add link "),it=(0,s.Uk)(" how to mention users and posts "),ot=Ee((()=>(0,s._)("div",null,[(0,s._)("span",{class:"text-bold"},(0,i.zw)("to mention a user: ")),(0,s.Uk)(" "+(0,i.zw)("type ")+" "),(0,s._)("code",null,(0,i.zw)('"@"')),(0,s.Uk)(" "+(0,i.zw)(" and select user from menu that pops up or paste in npub key"))],-1))),at=Ee((()=>(0,s._)("span",{class:"text-bold"},(0,i.zw)("to mention a post: "),-1))),lt=(0,s.Uk)("paste in note id (you can copy note id from embed "),rt=(0,s.Uk)(' button at the bottom of every post)"'),dt=(0,s.Uk)(" cancel "),ut={key:1,class:"char-left-label"},ct={key:0,class:"over-limit"},pt=(0,s.Uk)(" short form post "),ht=(0,s.Uk)(" long form post ");function gt(e,t,n,a,l,r){const d=(0,s.up)("BasePost"),u=(0,s.up)("q-btn"),c=(0,s.up)("BaseMessage"),p=(0,s.up)("q-list"),h=(0,s.up)("q-icon"),g=(0,s.up)("BaseUserAvatar"),m=(0,s.up)("q-spinner-orbit"),y=(0,s.up)("q-tooltip"),f=(0,s.up)("q-btn-toggle"),w=(0,s.up)("q-separator"),v=(0,s.up)("BaseEmojiPicker"),b=(0,s.up)("q-tab-panel"),k=(0,s.up)("BaseLinkForm"),x=(0,s.up)("q-tab-panels"),C=(0,s.up)("q-item"),M=(0,s.up)("q-circular-progress"),_=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.j4)(C,{unelevated:"",class:"q-pa-none post-entry-form flex coloumn",ref:"postEntry",onClick:t[20]||(t[20]=(0,o.iM)((()=>{}),["stop"])),onMouseup:t[21]||(t[21]=(0,o.iM)((()=>{}),["stop"])),onKeypress:t[22]||(t[22]=(0,o.D2)((0,o.iM)((()=>{}),["stop"]),["enter"])),onKeydown:t[23]||(t[23]=(0,o.iM)((()=>{}),["stop"])),onKeyup:t[24]||(t[24]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>["quote"===n.replyMode||"repost"===n.replyMode?((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,i.C_)(["reposts flex column q-px-sm q-py-xs","quote"===n.replyMode?"q-mb-sm":""]),clickable:!1},[(0,s.Wm)(d,{event:n.event,clickable:!1,"is-embeded":!0,"reply-depth":-1},null,8,["event"])],2)):(0,s.kq)("",!0),"reply"===n.messageMode&&n.event?((0,s.wg)(),(0,s.iD)("div",Ue,[(0,s._)("div",Ie,[(0,s.Wm)(u,{icon:"close",flat:"",dense:"",onClick:t[0]||(t[0]=(0,o.iM)((t=>e.$emit("clear-event")),["stop"])),size:"xs",class:"absolute-top-right z-top"})]),n.event?((0,s.wg)(),(0,s.j4)(c,{key:0,event:n.event,clickable:!1,"is-embeded":!0},null,8,["event"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("div",{class:"relative-position full-width",style:{gap:"5px"},onClick:t[9]||(t[9]=(0,o.iM)((()=>{}),["stop"]))},[(0,s.Wm)(p,{id:"tribute-wrapper",class:"overflow-auto flex row z-top",style:{"max-height":"40vh"},onClick:(0,o.iM)(l.focusInput,["stop"])},null,8,["onClick"]),!n.messageMode&&l.replyUserTags.length&&"embed"!==this.replyMode?((0,s.wg)(),(0,s.iD)("div",Ne,[(0,s.Wm)(h,{name:"alternate_email",color:"secondary",size:"sm"}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.replyUserTags,(t=>((0,s.wg)(),(0,s.j4)(u,{key:t,color:"secondary",outline:"",rounded:"",label:e.$store.getters.displayName(t),icon:"close",dense:"",size:"sm",class:"q-pr-sm","no-caps":"",onClick:(0,o.iM)((e=>r.removeReplyUserTag(t)),["stop"])},null,8,["label","onClick"])))),128))])):(0,s.kq)("",!0),(0,s._)("div",Ae,[(0,s.Wm)(g,{pubkey:e.$store.state.keys.pub,class:"avatar-image"},null,8,["pubkey"]),(0,s._)("span",Oe,(0,i.zw)(r.placeholderText),1),(0,s.wy)((0,s._)("div",Fe,null,512),[[o.F8,!l.longForm]]),(0,s._)("div",{id:"input-editable",contenteditable:!l.sending&&!l.mentionsUpdating,style:(0,i.j5)(l.mentionsUpdating?"opacity: .7;":""),onInput:t[1]||(t[1]=(...e)=>r.updateText&&r.updateText(...e)),onKeypress:[t[2]||(t[2]=(0,o.D2)(((...e)=>r.updateText&&r.updateText(...e)),["delete"])),t[5]||(t[5]=(0,o.D2)((0,o.iM)(((...e)=>r.send&&r.send(...e)),["ctrl"]),["enter"]))],onFocus:t[3]||(t[3]=(...e)=>r.textareaFocus&&r.textareaFocus(...e)),onBlur:t[4]||(t[4]=(...e)=>r.textareaBlur&&r.textareaBlur(...e)),onClick:t[6]||(t[6]=(0,o.iM)(((...e)=>r.updateText&&r.updateText(...e)),["stop"])),onTouchstart:t[7]||(t[7]=(0,o.iM)((()=>{}),["stop"])),onMousedown:t[8]||(t[8]=(0,o.iM)((()=>{}),["stop"]))},null,44,He),Qe,l.mentionsUpdating?((0,s.wg)(),(0,s.iD)("div",Ve,[(0,s.Wm)(m,{color:"accent",size:"md"})])):(0,s.kq)("",!0)])],512),[[o.F8,"repost"!==n.replyMode]]),(0,s._)("div",Ke,[l.links.length?((0,s.wg)(),(0,s.iD)("div",Je,[Ye,(0,s._)("ul",Xe,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.links,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:"flex row justify-between no-wrap",dense:""},[(0,s._)("div",Ge,[(0,s._)("strong",null,(0,i.zw)(r.linkName(e)),1),(0,s._)("span",null,(0,i.zw)(e.url),1)]),(0,s.Wm)(u,{icon:"remove_circle",clickable:"",onClick:(0,o.iM)((e=>r.removeLink(t)),["stop"]),flat:"",color:"negative",size:"xs",class:"no-padding"},null,8,["onClick"])])))),128))])])):(0,s.kq)("",!0)]),(0,s._)("div",{class:(0,i.C_)(["flex justify-between",l.toolSelected?"column":"row"]),onClick:t[19]||(t[19]=(0,o.iM)((()=>{}),["stop"]))},[(0,s._)("div",et,[(0,s.wy)((0,s.Wm)(f,{modelValue:l.toolSelected,"onUpdate:modelValue":t[13]||(t[13]=e=>l.toolSelected=e),class:(0,i.C_)(["flex",l.toolSelected?"column":"row"]),dense:"",unelevated:"","toggle-color":"","toggle-text-color":"accent",options:[{value:"emoji",slot:"emoji"},{value:"link",slot:"link"},{value:"help",slot:"help"}]},{emoji:(0,s.w5)((()=>[(0,s.Wm)(u,{unelevated:"",class:"no-padding button-emoji",dense:"",size:"sm",onClick:t[10]||(t[10]=(0,o.iM)((e=>r.toggleTool("emoji")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[tt])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[nt])),_:1})])),_:1})])),link:(0,s.w5)((()=>[(0,s.Wm)(u,{unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[11]||(t[11]=(0,o.iM)((e=>r.toggleTool("link")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"add_link",size:"sm"}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[st])),_:1})])),_:1})])),help:(0,s.w5)((()=>[(0,s.Wm)(u,{unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[12]||(t[12]=(0,o.iM)((e=>r.toggleTool("help")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"help",size:"xs"}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[it])),_:1})])),_:1})])),_:1},8,["modelValue","class"]),[[o.F8,"repost"!==n.replyMode]]),l.toolSelected?((0,s.wg)(),(0,s.j4)(C,{key:0,class:"col toolbox no-padding",ref:"toolbox"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{vertical:"",color:"accent",size:"1px"}),(0,s.Wm)(x,{modelValue:l.toolSelected,"onUpdate:modelValue":t[17]||(t[17]=e=>l.toolSelected=e),class:"no-padding full-width"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"emoji",class:"no-padding",onClick:t[14]||(t[14]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{onEmojiSelected:r.insertEmoji,"per-line":r.emojiPerRow,class:"full-width"},null,8,["onEmojiSelected","per-line"])])),_:1}),(0,s.Wm)(b,{name:"link",class:"q-pa-xs",onClick:t[15]||(t[15]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{links:l.links,onLinkAdded:r.addLink},null,8,["links","onLinkAdded"])])),_:1}),(0,s.Wm)(b,{name:"help",class:"q-pa-xs",onClick:t[16]||(t[16]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[ot,(0,s._)("div",null,[at,(0,s._)("span",null,[lt,(0,s.Wm)(h,{name:"link",size:"sm"}),rt])])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,s.kq)("",!0)]),(0,s.Wm)(_,{class:"flex items-center",unelevated:""},{default:(0,s.w5)((()=>[l.toolSelected?((0,s.wg)(),(0,s.j4)(u,{key:0,icon:"close",unelevated:"",class:"col button-close",dense:"",onClick:(0,o.iM)(r.closeTools,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[dt])),_:1})])),_:1},8,["onClick"])):(0,s.kq)("",!0),l.text&&!n.messageMode?((0,s.wg)(),(0,s.iD)("div",ut,[r.charLeft()<=0&&!l.longForm?((0,s.wg)(),(0,s.iD)("span",ct,(0,i.zw)(r.charLeft()),1)):(0,s.kq)("",!0),r.charLeft()>0?((0,s.wg)(),(0,s.j4)(M,{key:1,"show-value":r.charLeft()<=25,value:l.text.length%l.charLimit/l.charLimit*100,size:r.charLeft()<=25?"1.5rem":"1.2rem","font-size":".6rem",thickness:r.charLeft()<=25?.2:.1,color:r.charLeft()<=25?"warning":"secondary","track-color":"transparent",class:"no-padding","instant-feedback":""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(r.charLeft()),1)])),_:1},8,["show-value","value","size","thickness","color"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),!n.messageMode&&r.charLeft()<=0?((0,s.wg)(),(0,s.j4)(f,{key:2,modelValue:l.longForm,"onUpdate:modelValue":t[18]||(t[18]=e=>l.longForm=e),unelevated:"",dense:"","toggle-color":"primary",style:{border:"1px solid var(--q-primary)"},"text-color":"primary",class:"q-ml-md",options:[{value:!1,slot:"short"},{value:!0,slot:"long"}]},{short:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"short_text",size:"xs",style:(0,i.j5)(l.longForm?"":"color: var(--q-background")},null,8,["style"]),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[pt])),_:1})])),long:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"format_align_left",size:"xs",style:(0,i.j5)(l.longForm?"color: var(--q-background":"")},null,8,["style"]),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[ht])),_:1})])),_:1},8,["modelValue"])):(0,s.kq)("",!0),(0,s.Wm)(u,{flat:"",unelevated:"",color:"primary",type:"submit",onClick:(0,o.iM)(r.send,["stop"]),disable:!r.textValid()},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"send",style:(0,i.j5)("transform: translateX("+l.sendIconTranslation+"px);")},null,8,["style"])])),_:1},8,["onClick","disable"])])),_:1})],2)])),_:1},512)}n(38049),n(42498);var mt=n(75103),yt=n(26041);function ft(e,t,n,i,a,l){const r=(0,s.up)("Picker");return(0,s.wg)(),(0,s.j4)(r,{data:a.emojiIndex,set:"google","emoji-size":22,"per-line":n.perLine,"show-preview":!1,"show-skin-tomes":!1,onSelect:l.emojiSelected,onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["data","per-line","onSelect"])}var wt=n(32859),vt=n(50502);let bt=new vt.xd(wt);const kt={name:"BaseEmojiPicker",emits:["emoji-selected"],props:{perLine:{type:Number,required:!0}},components:{Picker:vt.cW},data(){return{emojiIndex:bt}},methods:{emojiSelected(e){this.$emit("emoji-selected",e)}}},xt=(0,I.Z)(kt,[["render",ft]]),Ct=xt;function Mt(e,t,n,o,a,l){const r=(0,s.up)("q-input"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-form");return(0,s.wg)(),(0,s.j4)(u,{onSubmit:t[2]||(t[2]=e=>l.addLink({url:a.url,name:a.name})),class:"no-padding flex row items-center no-wrap justify-between"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{modelValue:a.url,"onUpdate:modelValue":t[0]||(t[0]=e=>a.url=e),type:"url",label:"url",dense:"",outlined:"",autofocus:"",color:"accent",class:"no-padding col-9"},null,8,["modelValue"]),(0,s.Wm)(r,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=e=>a.name=e),label:"url name",disable:0===a.url.length,outlined:"",dense:"",color:"accent",class:"no-padding col-2"},null,8,["modelValue","disable"]),(0,s.Wm)(d,{icon:"add",type:"submit",disable:!a.validUrl,outline:"",round:"",color:"accent",size:"sm",class:(0,i.C_)(["no-padding",a.validUrl?"pulse-button":""])},null,8,["disable","class"])])),_:1})}n(84641),n(83269);const _t={name:"BaseLinkForm",emits:["link-added","link-removed"],props:{links:{type:Array,required:!0}},data(){return{url:"",name:"",validUrl:!1}},watch:{async url(e,t){if(e)try{this.validUrl=Boolean(new URL(e))}catch(n){this.validUrl=!1}else this.validUrl=!1}},methods:{linkName(e){return e.name?`${e.name}: `:""},addLink(e){0===e.name.length&&delete e.name,this.$emit("link-added",e),this.url="",this.name=""},removeLink(e){this.$emit("link-removed",e)}}};var qt=n(8326),Tt=n(66611);const Bt=(0,I.Z)(_t,[["render",Mt],["__scopeId","data-v-f9c12dcc"]]),St=Bt;ee()(_t,"components",{QForm:qt.Z,QInput:Tt.Z,QBtn:J.Z});var zt=n(31244),Zt=n(34136);const{getPaletteColor:Wt}=mt.ZP,$t={name:"BasePostEntry",mixins:[W.Z],emits:["sent","resized","clear-event"],components:{BaseEmojiPicker:Ct,BaseLinkForm:St,BaseMessage:zt.Z},props:{messageMode:{type:String,required:!1,default:""},replyMode:{type:String,required:!1,default:""},event:{type:Object,required:!1,default:null},autoFocus:{type:Boolean,default:!0}},data(){return{text:"",charLimit:280,sending:!1,toolSelected:"",sendIconTranslation:0,tags:[],mentionsUpdating:!1,focusInput(){setTimeout((async()=>{await this.$nextTick(),this.textarea.focus()}),1)},trigger:1,links:[],textareaRange:null,longForm:!1,replyUserTags:[]}},watch:{text(e,t){this.updateMentionsTags()},replyMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())},messageMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())}},computed:{postEntry(){return this.$refs.postEntry.$el},textarea(){return this.postEntry.querySelector("#input-editable")},readonlyTextarea(){return this.postEntry.querySelector("#input-readonly")},readonlyHighlightTextarea(){return this.postEntry.querySelector("#input-readonly-highlight")},placeholder(){return this.postEntry.querySelector("#input-placeholder")},profileMentionsProvider(){return this.createMentionsProvider()},postEntryWidth(){var e,t;return null===(e=this.$refs.postEntry)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth},toolboxWidth(){var e,t;return this.toolSelected?null===(e=this.$refs.toolbox)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth:0},emojiPerRow(){return this.toolboxWidth?Math.floor((this.toolboxWidth-10)/25):0},label(){if("reply"===this.messageMode)return"what's your reply?";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought?"}return"what's happening?"},placeholderText(){if(this.text.length)return"";if("reply"===this.messageMode)return"reply to message";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought on this?"}return"what's happening?"},textareaMentions(){return this.mentions()},hashtags(){if(0===this.text.length)return[];const e=/(?<s>^|[\s])#(?<i>[\w]{1,63})/g;let t=this.innertext.matchAll(e),n=[];for(let s of t)n.push(s.groups.i.toLowerCase());return n},caretRange(){const e="undefined"!==typeof window.getSelection;if(e&&this.trigger){const e=window.getSelection();if(0!==e.rangeCount){const t=e.getRangeAt(0);return t}}return null},hexPubkey(){return this.$route.params.pubkey?this.bech32ToHex(this.$route.params.pubkey):""}},mounted(){this.messageMode||this.profileMentionsProvider.attach(this.textarea),this.replyMode&&(this.replyUserTags=this.getReplyUserTags()),this.autoFocus&&this.focusInput(),this.$emit("resized")},activated(){},beforeUnmount(){this.messageMode||this.profileMentionsProvider.detach(this.textarea),this.reset(),this.$emit("resized")},methods:{updateText(e){this.trigger++,this.text=this.textarea.textContent,this.innertext=this.textarea.innerText,this.textareaRange=this.caretRange||this.textareaRange,this.updateReadonlyInput(),this.messageMode||this.updateReadonlyHightlightInput()},async send(){if(!this.textValid())return void console.log("text not valid");if(this.sending)return void console.log("send already in progress");let e;this.toolSelected="",this.sending=!0,this.animateSendIcon(),this.updateText(),await this.extractMentions(this.textarea,this.tags),e=this.replyMode?await this.sendReply():this.messageMode?await this.sendMessage():await this.sendPost(),e&&(this.messageMode||this.interpolateEventMentions(e),this.reset(),this.$emit("sent",e),this.replyMode||this.messageMode||this.toEvent(e.id)),this.sending=!1},async sendPost(){let e=Object.values(this.mentions()).map((e=>e.tag)),t=await this.formatMentionsForPublishing(e);this.appendHashtags(e),t=this.appendLinks(t);let n=await this.$store.dispatch("sendPost",{message:t,tags:e});if(n)return n},async sendReply(){"repost"===this.replyMode&&this.text&&(this.textarea.innerHTML="");let e=[],t=this.textarea.cloneNode(!0);this.replyUserTags.forEach((async t=>e.push(await(0,yt.l_)(t))));let n=this.event.tags.filter((([e,t])=>"e"===e&&t)).map((([...e])=>[...e]));if("quote"===this.replyMode||"repost"===this.replyMode){let n=await(0,yt.wn)(this.event.id,"mention");e.push(n),t.append(` #[${e.length-1}]`)}else{let t=n.find((([e,t,n,s])=>"e"===e&&"root"===s))||n.find((e=>"e"===e[0]&&!e[3]));t||1!==n.filter((([e,t,n,s])=>"e"===e&&"reply"===s)).length||(t=n.find((([e,t,n,s])=>"e"===e&&"reply"===s))),t?(e.push(await(0,yt.wn)(t[1],"root")),e.push(await(0,yt.wn)(this.event.id,"reply"))):e.push(await(0,yt.wn)(this.event.id,"root"))}let s=await this.formatMentionsForPublishing(e,!0,t);return this.appendHashtags(e),s=this.appendLinks(s),(0,Zt.nY)((0,Z.CX)(this.event)),await this.$store.dispatch("sendPost",{message:s,tags:e})},async sendMessage(){let e=Math.round(Date.now()/1e3),t=[];t.find((([e,t])=>t===this.hexPubkey))||t.push(["p",this.hexPubkey]),this.event&&!t.find((([e,t])=>t===this.event.id))&&t.push(await(0,yt.wn)(this.event.id,"mention"));let n=await this.formatMentionsForPublishing(t,!1);return n=this.appendLinks(n),await this.$store.dispatch("sendChatMessage",{now:e,pubkey:this.hexPubkey,text:n,tags:t})},async extractMentions(e,t){const n=/(?<t>note|npub)(?<v>[a-z0-9]{59})\b/g,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let i={},o=s.nextNode();while(o){let e=o.textContent;for(let s of e.matchAll(n)){let e=null;if("note"===s.groups.t)e="e";else{if("npub"!==s.groups.t)return;e="p"}let n=s[0],o=this.bech32ToHex(n),a=Object.entries(t),l=a.map((([e,t])=>t)).findIndex((([t,s])=>t===e&&s===n));if(-1!==l)i[n]=a[l][0];else if("e"===e){let e=`${this.shorten(n)}`;t[e]=await(0,yt.wn)(o,"mention"),i[n]=e}else{console.log("extract mentions",`"${n}"`,s);let e=`@${this.$store.getters.displayName(o)}`;t[e]=await(0,yt.l_)(o),i[n]=e}}e=e.replace(n,((e,t,n)=>i[e])),o.textContent=e,o=s.nextNode()}},mentions(e=this.textarea){if(0===this.text.length)return{};let t={};const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let s=n.nextNode(),i=0;while(s){for(let[e,n]of Object.entries(this.tags)){const o=new RegExp(`(?<i>${e})\\b`,"g");let a=s.textContent.matchAll(o);for(let e of a)this.tags[e.groups.i]&&(t[i+"."+e.index+"_"+e.groups.i]={el:s,pos:e.index,tag:Array.from(n),length:e.groups.i.length})}s=n.nextNode(),i++}return t},async formatMentionsForPublishing(e,t=!0,n=this.textarea.cloneNode(!0)){let s=this.mentions(n),i={el:null,offset:null};for(let a in s){let n=s[a],o=e.findIndex((([e,t])=>e===n.tag[0]&&t===n.tag[1]));if(-1===o){let s;"p"===n.tag[0]&&t?s=await(0,yt.l_)(n.tag[1]):"e"===n.tag[0]&&(s=await(0,yt.wn)(n.tag[1],"mention")),s&&(e.push(s),o=e.length-1)}i.el&&i.el!==n.el&&(i.offset=0);let l=i.el&&i.el===n.el?i.offset:0,r=new Range;r.setStart(n.el,n.pos+l),r.setEnd(n.el,n.pos+n.length+l);let d="p"!==n.tag[0]||t?`#[${o}]`:`@${n.tag[1]}`;this.insertText(d,r),i={el:n.el,offset:d.length-n.length+i.offset||0}}n.style.maxHeight="0",this.postEntry.appendChild(n);let o=n.innerText;return n.remove(),o},async updateMentionsTags(){this.trigger++;let{start:e}=this.startEndOfRange();const t=/(?<t>note|npub)(?<v>[a-z0-9]{59})/g;this.text.toLowerCase().match(t)&&(this.mentionsUpdating=!0,await this.extractMentions(this.textarea,this.tags),"#text"===e.el.nodeName&&e.pos>e.el.length?this.setCaret(e.el,e.el.length):this.setCaret(e.el,e.pos),this.updateText(),console.log("updateMentionTags",this.tags),Object.keys(this.tags).filter((e=>"p"===this.tags[e][0])).forEach((e=>{this.replyUserTags.includes(this.tags[e][1])||this.replyUserTags.push(this.tags[e][1])})),this.mentionsUpdating=!1)},startEndOfRange(e=this.caretRange){return{start:{el:e.startContainer,pos:e.startOffset},end:{el:e.endContainer,pos:e.endOffset}}},insertText(e,t=this.textareaRange){let{start:n,end:s}=this.startEndOfRange(t),i=n.el.textContent.slice(0,n.pos)+e+s.el.textContent.slice(s.pos);if(t.isCollapsed||(t.deleteContents(),s.el!==n.el&&s.el.remove()),"#text"===n.el.nodeName)n.el.textContent=i,this.setCaret(n.el,n.pos+e.length);else{let t=document.createTextNode(i);n.el.insertBefore(t,n.el.firstChild),this.setCaret(t,e.length)}this.updateText()},insertEmoji(e){e.native&&(this.trigger++,this.insertText(e.native))},animateSendIcon(){let e=setInterval((()=>{if(!this.sending)return clearInterval(e),void(this.sendIconTranslation=0);this.sendIconTranslation+=3,this.sendIconTranslation>50&&(this.sendIconTranslation-=this.postEntryWidth+40)}),50)},closeTools(){this.toolSelected=""},toggleTool(e){this.updateText(),this.toolSelected===e?this.closeTools():this.toolSelected=e},reset(){this.closeTools(),this.text="",this.textarea.innerHTML="",this.readonlyTextarea.innerHTML="",this.readonlyHighlightTextarea.innerHTML="",this.tags=[],this.links=[],this.focusInput()},appendHashtags(e){for(let t of this.hashtags)e.find((([e,n])=>n===t))||e.push(["t",t.toLowerCase()])},appendLinks(e){for(let t of this.links)t.name?e+=`\n[${t.name}](${t.url})`:e+=`\n${t.url}`;return e},setCaret(e,t){const n="undefined"!==typeof window.getSelection;if(n&&e){const n=window.getSelection(),s=document.createRange();n.removeAllRanges(),s.selectNodeContents(e),s.collapse(!0),s.setStart(e,t),n.addRange(s),this.focusInput()}},addLink(e){this.links.push(e)},linkName(e){return e.name?`${e.name}: `:""},removeLink(e){this.links.splice(e,1)},textareaFocus(e){const t=this.placeholder;t.style.opacity=".3"},textareaBlur(e){const t=this.placeholder;t.style.opacity=".6"},colorText(e){let t=document.createElement("span");return t.innerHTML=e,t.style.color=Wt("secondary"),t},updateReadonlyInput(){let e=this.textarea.innerHTML,t=Object.assign({},this.mentions());for(let n in t){let[t,s]=n.split("_");const i=new RegExp(`(?<i>${s})\\b`,"g");e=e.replaceAll(i,((e,t)=>this.colorText(s).outerHTML))}this.readonlyTextarea.innerHTML=e},updateReadonlyHightlightInput(){if(this.overCharLimit()){this.readonlyHighlightTextarea.innerHTML=this.textarea.innerHTML;let{el:e,pos:t}=this.charPos(this.charLimit,this.readonlyHighlightTextarea),n=e.length&&e.length>t,s=new Range;s.setStart(e,t),s.setEndAfter(this.readonlyHighlightTextarea.lastChild);let i=s.extractContents(),o=[].map.call(i.childNodes,((e,t)=>{if(0===t&&n)return"#text"===e.nodeName?e.textContent:e.innerHTML;let s=document.createElement("span");return s.style.background=Wt("negative"),s.style.opacity=".6",s.innerHTML=e.innerHTML,e.innerHTML=s.outerHTML,e.outerHTML})).join(""),a=document.createElement("span");a.innerHTML=o,a.style.background=Wt("negative"),a.style.opacity=".6";let l=new Range;l.setStart(e,t),l.collapse(!0),l.insertNode(a)}else this.readonlyHighlightTextarea.innerHTML=""},charPos(e,t=this.textarea){for(var n of t.childNodes)if(3===n.nodeType){if(n.length>=e)return{el:n,pos:e,char:-1};e-=n.length}else{let t=this.charPos(e,n);if(-1===t.char)return t;e=t.char}return{char:e}},extractUrls(e){const t=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;return e=e.replace(t,(e=>(this.addLink({url:e}),""))),e},charLeft(){return this.charLimit-this.text.length},overCharLimit(){return this.charLeft()<0},textValid(){return"repost"===this.replyMode||(!!this.links.length||!!this.text.length&&(!!this.messageMode||(!!this.longForm||!this.overCharLimit())))},getReplyUserTags(){if(!this.event)return[];let e=Object.assign({},this.event);e.tags||(e.tags=[]);let t=e.tags.filter((([e,t])=>"p"===e&&this.isKey(t))).map((([...e])=>[...e])),n=t.filter((([e,t])=>"p"===e)).map((([e,t])=>t)).slice(0,9);return n.find((t=>t===e.pubkey))||n.push(e.pubkey),n=n.filter((e=>e!==this.$store.state.keys.pub)),n},removeReplyUserTag(e){let t=this.mentions();Object.keys(t).forEach((n=>{let s=t[n];if(s.tag[1]===e){let e=new Range;e.setStart(s.el,s.pos),e.setEnd(s.el,s.pos+s.length),this.insertText("",e),this.updateText()}}));let n=Object.keys(this.tags).find((t=>e===this.tags[t][1]));delete this.tags[n],this.replyUserTags=this.replyUserTags.filter((t=>e!==t))}}};var jt=n(490),Dt=n(13246),Lt=n(1389),Pt=n(67236),Rt=n(11221),Et=n(83302);const Ut=(0,I.Z)($t,[["render",gt],["__scopeId","data-v-67c80742"]]),It=Ut;function Nt(e,t,n,i,a,l){const r=(0,s.up)("BaseButtonShowMore"),d=(0,s.up)("BasePost"),u=(0,s.up)("q-list");return(0,s.wg)(),(0,s.j4)(u,{ref:"thread",class:"no-padding"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.filledEvents,((t,i)=>((0,s.wg)(),(0,s.iD)("div",{key:t.id+i,class:"no-padding"},["FILLER"===t.id?((0,s.wg)(),(0,s.j4)(r,{key:0,root:t.root},null,8,["root"])):"REPLIES"===t.id?((0,s.wg)(),(0,s.j4)(r,{key:1,root:t.root,"reply-count":t.replyCount},null,8,["root","reply-count"])):((0,s.wg)(),(0,s.j4)(d,{key:2,event:t,position:l.position(i),"reply-depth":n.replyDepth,onResized:l.resize,onAddEvent:l.addEvent,onClick:(0,o.iM)((n=>e.toEvent(t.id)),["stop"])},null,8,["event","position","reply-depth","onResized","onAddEvent","onClick"]))])))),128))])),_:1},512)}function At(e,t,n,i,a,l){const r=(0,s.up)("q-separator"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{color:"accent"}),(0,s.Wm)(u,{flat:"",spread:"",dense:"","text-color":"accent"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{dense:"",flat:"",color:"accent",class:"text-weight-light",style:{"letter-spacing":".1rem"},onClick:(0,o.iM)(l.showMore,["stop"]),label:n.replyCount?n.replyCount+" replies":"show more"},null,8,["onClick","label"])])),_:1}),n.replyCount?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:0,color:"accent"}))],64)}ee()($t,"components",{QItem:jt.Z,QBtn:J.Z,QList:Dt.Z,QIcon:Q.Z,QSpinnerOrbit:_e.Z,QBtnToggle:Lt.Z,QTooltip:V.Z,QSeparator:K.Z,QTabPanels:Y.Z,QTabPanel:X.Z,QBtnGroup:Pt.Z,QCheckbox:Rt.Z,QCircularProgress:Et.Z});const Ot={name:"BaseButtonShowMore",mixins:[W.Z],props:{root:{type:String,required:!0},replyCount:{type:Number,default:0}},methods:{showMore(){this.toEvent(this.root)}}},Ft=(0,I.Z)(Ot,[["render",At]]),Ht=Ft;ee()(Ot,"components",{QSeparator:K.Z,QBtnGroup:Pt.Z,QBtn:J.Z});const Qt={name:"BasePostThread",emits:["resized","add-event"],mixins:[W.Z],props:{events:{type:Array,required:!0},isAncestors:{type:Boolean,default:!1},replyDepth:{type:Number,default:0}},components:{BaseButtonShowMore:Ht},data(){return{resizing:!1}},computed:{root(){return this.events[0].id},filledEvents(){if(!this.resizing||this.resizing){if(0===this.events.length)return[];var e=[this.events[0]];if(1===this.events.length)return this.pushShowMore(e);for(let t=1;t<this.events.length;t++){let n=this.events[t],s=this.events[t-1],i=n.interpolated.replyEvents||[];i.length&&i[i.length-1]!==s.id&&e.push({id:"FILLER",root:s.id}),e.push(n)}return this.pushShowMore(e)}}},methods:{position(e){return this.isAncestors?1===this.filledEvents.length||0===e?"first":(this.filledEvents.length,"middle"):1===this.filledEvents.length?"single":0===e?"first":e===this.filledEvents.length-1?"last":"middle"},addEvent(e){console.log("basepostthread add-event",e),this.$emit("add-event",e)},resize(e){this.resizing=!this.resizing,this.$emit("resized")},pushShowMore(e){var t;let n=e[e.length-1];if(null!==(t=n.replies)&&void 0!==t&&t.length&&this.threadWidth()&&(this.replyDepth>=2||this.replyDepth>0&&this.threadWidth()<300)){let t=Object.assign({},n);t.replyCount=t.replies.length,t.replies=[],e.pop(),e.push(t),e.push({id:"REPLIES",root:t.id,replyCount:t.replyCount})}return e},threadWidth(){var e,t;return null===(e=this.$refs.thread)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth}}},Vt=(0,I.Z)(Qt,[["render",Nt]]),Kt=Vt;ee()(Qt,"components",{QList:Dt.Z});const Jt={class:"text-h5 text-bold q-pt-md q-pb-sm q-px-sm"};function Yt(e,t,n,i,o,a){const l=(0,s.up)("q-separator");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",Jt,[(0,s.WI)(e.$slots,"default")]),e.separator?((0,s.wg)(),(0,s.j4)(l,{key:0,color:"accent",size:"1px"})):(0,s.kq)("",!0)])}const Xt=(0,s.aZ)({name:"BaseHeader",props:{separator:{type:Boolean,default:!0}}}),Gt=(0,I.Z)(Xt,[["render",Yt]]),en=Gt;ee()(Xt,"components",{QSeparator:K.Z});const tn=({app:e})=>{e.component("BasePost",ne),e.component("BaseUserName",Ze),e.component("BaseUserAvatar",Pe),e.component("BaseUserCard",Re.Z),e.component("BasePostEntry",It),e.component("BasePostThread",Kt),e.component("BaseHeader",en)}},55635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var s=n(37912);const i={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sun:"Sun",Mon:"Mon",Tues:"Tues",Wed:"Wed",Thurs:"Thurs",Fri:"Fri",Sat:"Sat",second:"second",day:"day",January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",UTC:"UTC",now:"now",s:"s",m:"m",h:"h",post:"post",follow:"follow",close:"close",setUser:"set user",read:"read",write:"write",reorderFollows:"reorder follows",cancel:"cancel",save:"save",searchProfiles:"search profiles",searchPosts:"search posts",feed:"feed",notifications:"notifications",messages:"messages",inbox:"inbox",settings:"settings",thread:"thread",event:"event",devTools:"dev tools",notFound:"Oops. Nothing here...",follows:"follows",followers:"followers",replies:"replies",profile:"profile",relays:"relays",faq:"faq",users:"users",nip05Maintainer:"NIP05 maintainer",inactiveRelays:"inactive relays",preferences:"preferences",colors:"colors",font:"font",lightningTips:"lightning tips",noFollows:"no follows",noFollowers:"no followers",noRelays:"no relays",dragDropReorder:"drag and drop to reorder"},o={en:i},a=({app:e})=>{const t=(0,s.o)({locale:"en",fallbackLocale:"en",globalInjection:!0,messages:o});e.use(t)}},34136:(e,t,n)=>{"use strict";n.d(t,{$d:()=>Z,BT:()=>z,E1:()=>S,JH:()=>W,LB:()=>r,MD:()=>x,NL:()=>k,Qg:()=>h,TE:()=>b,UD:()=>l,Uk:()=>p,W1:()=>$,Zd:()=>d,dq:()=>m,g2:()=>B,h0:()=>T,ix:()=>q,jg:()=>w,mX:()=>v,mw:()=>c,nY:()=>j,oQ:()=>u,pq:()=>_,sG:()=>M,sM:()=>C,t_:()=>f,uA:()=>g,w8:()=>y});n(40702),n(84641),n(83269);const s=new Worker(new URL(n.p+n.u(734),n.b)),i={};function o(e,t){let n=e+" "+Math.random().toString().slice(-4);return s.postMessage({id:n,name:e,args:t}),new Promise(((e,t)=>{i[n]={resolve:e,reject:t}}))}function a(e,t,n){let o=e+" "+Math.random().toString().slice(-4);return i[o]=n,s.postMessage(JSON.stringify({id:o,name:e,args:t,stream:!0})),{update(...t){s.postMessage(JSON.stringify({id:o,name:e,args:t,stream:!0}))},cancel(){s.postMessage(JSON.stringify({id:o,cancel:!0})),delete i[o]}}}async function l(){return o("dbErase",[])}async function r(e){return o("dbSave",[e])}function d(e=Math.round(Date.now()/1e3),t=(()=>{})){return o("dbFeed",[e])}function u(e=Math.round(Date.now()/1e3),t=(()=>{})){return a("streamFeed",[e],t)}async function c(e){return o("dbChats",[e])}async function p(e,t,n=50,s=Math.round(Date.now()/1e3)){return o("dbMessages",[e,t,n,s])}async function h(e=(()=>{})){return a("listenMessages",[],e)}async function g(e){return o("dbEvent",[e])}async function m(e,t,n,s=(()=>{})){return a("dbStreamTagKind",[e,t,n],s)}async function y(e,t=(()=>{}),n=!1){return a("dbStreamEvent",[e,n],t)}async function f(e,t=50,n=Math.round(Date.now()/1e3)){return o("dbMentions",[e,t,n])}function w(e,t=(()=>{})){return a("listenMentions",[e],t)}async function v(e,t=Math.round(Date.now()/1e3)){return o("dbUnreadMentionsCount",[e,t])}async function b(e,t,n=Math.round(Date.now()/1e3)){return o("dbUnreadMessagesCount",[e,t,n])}async function k(e){return o("dbUserProfile",[e])}async function x(e){return o("dbUserFollows",[e])}async function C(e,t=Math.round(Date.now()/1e3),n=50){return o("dbUserNotes",[e,t,n])}function M(e,t=(()=>{})){return a("streamUser",[e],t)}function _(e,t=(()=>{})){return a("streamUserNotes",[e],t)}function q(e,t=(()=>{})){return a("streamUserProfile",[e],t)}function T(e,t=(()=>{})){return a("dbStreamUserFollows",[e],t)}function B(e,t=(()=>{})){return a("dbStreamUserFollows",[e],t)}function S(e,t=(()=>{})){return a("dbStreamUserFollowers",[e],t)}function z(e,t=(()=>{})){return a("streamUserTags",[e],t)}async function Z(e){return o("dbQuery",[e])}function W(e){return o("setRelays",[JSON.parse(JSON.stringify(e))])}function $(e){return o("setPrivateKey",[e])}function j(e,t){return o("publish",[JSON.parse(JSON.stringify(e)),t])}s.onmessage=e=>{var t,n;let{id:s,success:o,error:a,data:l,stream:r,type:d,notice:u}="string"===typeof e.data?JSON.parse(e.data):e.data;if(!d&&!u)if(r)i[s]&&i[s](l);else{if(!o)return console.log("🖴",s,"->",l),i[s].reject(new Error(a)),void delete i[s];null===(t=i[s])||void 0===t||null===(n=t.resolve)||void 0===n||n.call(t,l),delete i[s]}}},54927:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Be});var s={};n.r(s),n.d(s,{NIP05Id:()=>k,avatar:()=>x,canEncryptDecrypt:()=>z,canSignEventsAutomatically:()=>S,contacts:()=>_,displayName:()=>b,hasMoreContacts:()=>q,hasName:()=>w,name:()=>v,namedProfiles:()=>f,profileDescription:()=>C,profileLud06:()=>M,unreadChats:()=>T,unreadNotifications:()=>B});var i={};n.r(i),n.d(i,{addContactListToCache:()=>Q,addProfileToCache:()=>F,addRelay:()=>P,addToNIP05VerificationCache:()=>H,follow:()=>N,haveReadMessage:()=>J,haveReadNotifications:()=>V,removeRelay:()=>R,reorderFollows:()=>O,saveRelays:()=>U,setConfig:()=>X,setConfigLightningTips:()=>G,setDefaultRelays:()=>L,setFollows:()=>I,setKeys:()=>j,setRelayOpt:()=>E,setRelays:()=>D,setUnreadMessages:()=>Y,setUnreadNotifications:()=>K,unfollow:()=>A});var o={};n.r(o),n.d(o,{addEvent:()=>pe,cancelUseProfile:()=>ke,handleAddingProfileEventToCache:()=>Ce,initKeys:()=>le,launch:()=>re,launchWithoutKey:()=>de,publishContactList:()=>me,recommendRelay:()=>fe,restartMainSubscription:()=>ce,sendChatMessage:()=>ge,sendPost:()=>he,setMetadata:()=>ye,useNip05:()=>xe,useProfile:()=>be});var a=n(76058),l=n(63703);const r=()=>window.location.hostname.endsWith(".onion"),d={"wss://nostr-pub.wellorder.net":{read:!0,write:!0},"wss://nostr.onsats.org":{read:!0,write:!0},"wss://nostr-relay.wlvs.space":{read:!0,write:!0},"wss://nostr.bitcoiner.social":{read:!0,write:!0},"wss://relay.damus.io":{read:!0,write:!0},"wss://nostr.zebedee.cloud":{read:!0,write:!1},"wss://relay.nostr.info":{read:!0,write:!1},"wss://nostr-pub.semisol.dev":{read:!0,write:!1},"wss://nostr.walletofsatoshi.com":{read:!0,write:!1}},u=["wss://nostr-pub.wellorder.net","wss://nostr.swiss-enigma.ch","wss://nostr.cercatrova.me","wss://relay.damus.io","wss://relayer.fiatjaf.com","wss://nostr.rocks","wss://rsslay.fiatjaf.com","wss://nostr.zebedee.cloud","wss://nostr-2.zebedee.cloud","wss://expensive-relay.fiatjaf.com","wss://freedom-relay.herokuapp.com/ws","wss://nostr-relay.freeberty.net","wss://nostr.bitcoiner.social","wss://nostr-relay.wlvs.space","wss://nostr.onsats.org","wss://nostr-relay.untethr.me","wss://nostr.semisol.dev","wss://nostr-pub.semisol.dev","wss://nostr-verified.wellorder.net","wss://nostr.drss.io","wss://nostr.unknown.place","wss://nostr.openchain.fr","wss://nostr.delo.software","wss://relay.nostr.info","wss://relay.minds.com/nostr/v1/ws","wss://nostr.zaprite.io","wss://nostr.oxtr.dev","wss://nostr.ono.re","wss://relay.grunch.dev","wss://relay.cynsar.foundation","wss://nostr.sandwich.farm","wss://relay.nostr.ch","wss://nostr.mom","wss://nostr.walletofsatoshi.com","wss://nostr-relay.alekberg.net","wss://nostr.developer.li"],c={"ws://jgqaglhautb4k6e6i2g34jakxiemqp6z4wynlirltuukgkft2xuglmqd.onion":{read:!0,write:!0},"ws://wagvwfrdrikrqzp7h3b5lwl6btyuttu7mqpeji35ljzq36ovzgjhsfqd.onion":{read:!0,write:!0}};function p(){const e=r()?c:d,t=r()?Object.keys(c):u;let n=l.Z.getItem("config"),{timestamps:s,preferences:i}=n||{},{lastUserMainSync:o=0,lastFeedLoad:a=0}=s||{},{color:p,font:h="Roboto",lightningTips:g}=i||{},{primary:m="#ffffff",secondary:y="#aaaaaa",accent:f="#777777",background:w="#1f1f1f"}=p||{},{enabled:v=!0,lastMode:b="copy",lastWallet:k=null,presets:x=[10,100,1e3],oneClick:C={enabled:!1,amount:10}}=g||{};return n={timestamps:{lastUserMainSync:o,lastFeedLoad:a},preferences:{color:{primary:m,secondary:y,accent:f,background:w},font:h,lightningTips:{enabled:v,lastMode:b,lastWallet:k,presets:x,oneClick:C}}},{keys:l.Z.getItem("keys")||{},relays:l.Z.getItem("relays")||{},defaultRelays:e,optionalRelaysList:t,follows:l.Z.getItem("follows")||[],profilesCache:{},profilesCacheLRU:[],contactListCache:{},contactListCacheLRU:[],nip05VerificationCache:{},lastMessageRead:l.Z.getItem("lastMessageRead")||{},unreadMessages:{},lastNotificationRead:l.Z.getItem("lastNotificationRead")||0,unreadNotifications:0,config:n}}n(40702);var h=n(61993),g=n.n(h),m=n(18933),y=n(31262);function f(e,t){return Object.entries(e.profilesCache).reduce(((e,[n,s])=>t.hasName(n)?[...e,{...s,pubkey:n}]:e),[])}function w(e){return t=>{let{name:n,nip05:s}=e.profilesCache[t]||{};return(n||s||"").length>0}}function v(e){return t=>{let{name:n}=e.profilesCache[t]||{};return n}}function b(e,t){return t=>{let{name:n,nip05:s}=e.profilesCache[t]||{};return s?s.startsWith("_@")?s.slice(2):s:n||m.Z.methods.shorten(m.Z.methods.hexToBech32(t,"npub"))}}function k(e){return t=>{let{nip05:n}=e.profilesCache[t]||{};return n}}function x(e){return t=>{let{picture:n="data:image/png;base64,"+new(g())(t,40).toString()}=e.profilesCache[t]||{};return n}}function C(e){return t=>{let{about:n=""}=e.profilesCache[t]||{};return n}}function M(e){return t=>{let{lud06:n,lud16:s}=e.profilesCache[t]||{};return n||s?y.P6.isLnurl(n)?n.toLowerCase():y.P6.isLightningAddress(s)?m.Z.methods.lnAddrToLnurl(s):null:null}}function _(e){return t=>e.contactListCache[t]}function q(e){return t=>{var n;return(null===(n=e.contactListCache[t])||void 0===n?void 0:n.length)>6}}function T(e){return delete e.unreadMessages[e.keys.pub],Object.values(e.unreadMessages).filter((e=>e)).length}function B(e){return e.unreadNotifications}function S(e){return Boolean(e.keys.priv||window.nostr)}function z(e){return Boolean(e.keys.priv||window.nostr&&window.nostr.nip04)}n(84641),n(83269),n(46727);var Z=n(67694),W=n(50806),$=n(74961);function j(e,{mnemonic:t,priv:n,pub:s}={}){if(t||n||s||(t=(0,$.Ol)()),t){let e=(0,$.UH)(t);n=(0,$.ik)(e)}n&&(s=(0,Z.$3)(n)),e.keys={priv:n,pub:s}}function D(e,t){e.relays=t}function L(e,t){e.defaultRelays=t}function P(e,t){try{(0,W.O)(t),new URL(t)}catch(n){return}e.relays[t]={read:!0,write:!0}}function R(e,t){delete e.relays[t]}function E(e,{url:t,opt:n,value:s}){t in e.relays&&(e.relays[t][n]=s)}function U(e,t){e.relays=t}function I(e,t){e.follows=t}function N(e,t){e.keys.pub!==t&&(e.follows.includes(t)||e.follows.push(t))}function A(e,t){let n=e.follows.indexOf(t);n>=0&&e.follows.splice(n,1)}function O(e,t){e.follows=t}function F(e,t){t=JSON.parse(JSON.stringify(t));let{pubkey:n}=t;if(delete t.pubkey,n in e.profilesCache&&e.profilesCacheLRU.splice(e.profilesCacheLRU.indexOf(n),1),e.profilesCache[n]=t,n===e.keys.pub||e.profilesCacheLRU.push(n),e.profilesCacheLRU.length>3500){let t=e.profilesCacheLRU.shift();delete e.profilesCache[t]}}function H(e,{identifier:t,pubkey:n}){e.nip05VerificationCache[t]={pubkey:n,when:Math.round(Date.now()/1e3)}}function Q(e,t){t.pubkey in e.contactListCache&&e.contactListCacheLRU.splice(e.contactListCacheLRU.indexOf(t.pubkey),1);try{let n=t.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t,n,s])=>({pubkey:t,relay:n,petname:s})));n.length&&(e.contactListCache[t.pubkey]=n)}catch(n){return}if(t.pubkey===e.keys.pub||e.contactListCacheLRU.push(t.pubkey),e.contactListCacheLRU.length>150){let t=e.contactListCacheLRU.shift();delete e.contactListCache[t]}}function V(e){e.lastNotificationRead=Math.round(Date.now()/1e3)}function K(e,t){e.unreadNotifications=t}function J(e,t){e.lastMessageRead[t]=Math.round(Date.now()/1e3)}function Y(e,{peer:t,count:n}){e.unreadMessages[t]=n}function X(e,{key:t,value:n}){e.config[t]=n}function G(e,{key:t,value:n}){e.config.preferences.lightningTips[t]=n}var ee=n(55350),te=n(74827),ne=n(6827),se=n(60899),ie=n(22330),oe=n(34136),ae=n(26041);function le(e,t){e.commit("setKeys",t),e.commit("haveReadNotifications")}async function re(e){console.log("launch for ",e.state.keys.pub),e.state.keys.priv&&(0,oe.W1)(e.state.keys.priv);let{relays:t,follows:n}=e.state;if(!t||!Object.keys(t).length||!n||!n.length||"undefined"===n){let i=await(0,oe.MD)(e.state.keys.pub);if(!t||!Object.keys(t).length)try{t=JSON.parse(i.content),e.commit("setRelays",t)}catch(s){}if(!n||!n.length||"undefined"===n)try{n=i.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t)),e.commit("setFollows",n)}catch(s){}}e.dispatch("useProfile",{pubkey:e.state.keys.pub});for(let i of n)e.dispatch("useProfile",{pubkey:i});e.dispatch("restartMainSubscription")}async function de(e){e.dispatch("restartMainSubscription")}let ue={};async function ce(e){let t=Object.keys(e.state.relays).length?e.state.relays:e.state.defaultRelays;await(0,oe.JH)(t);let n="29f63b70d8961835b14062b195fc7d84fa810560b36dde0749e4bc084f0f8952",s=await(0,oe.h0)(n);if(setTimeout((()=>{s.cancel()}),6e4),ue.streamFeed||(ue.streamFeed=await(0,oe.oQ)(Math.round(Date.now()/1e3)-86400)),e.state.keys.pub){if(e.state.follows.length){let t={};ue.streamFollowsProfiles||(ue.streamFollowsProfiles=await(0,oe.ix)(e.state.follows,(async n=>{e.dispatch("handleAddingProfileEventToCache",n),t[n.pubkey]=t[n.pubkey]||0,t[n.pubkey]++,e.state.follows.length===Object.keys(t).length&&ue.streamFollowsProfiles.cancel()})))}ue.streamUser||(ue.streamUser=await(0,oe.sG)(e.state.keys.pub,(async t=>{if(3===t.kind){let n=await(0,oe.$d)(`\n          SELECT json_extract(event,'$.created_at') created_at\n          FROM nostr\n          WHERE json_extract(event,'$.kind') = 3 AND\n            json_extract(event,'$.pubkey') = '${e.state.keys.pub}'\n          LIMIT 1\n        `);if(n.length&&t.created_at<n[0].created_at)return;let s=JSON.parse(t.content);e.commit("setRelays",s);let i=t.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t));e.commit("setFollows",i),e.dispatch("restartMainSubscription")}else 0===t.kind&&e.dispatch("handleAddingProfileEventToCache",t)})))}}async function pe(e,{event:t,relay:n=null}){await(0,oe.LB)(t,n)}async function he(e,{message:t,tags:n=[],kind:s=1}){if(0!==t.length)try{const i={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:s,tags:n,content:t};let o=await(0,ie.B_)(i,e),a=await(0,oe.nY)(o);if(!a)throw new Error("could not publish post");return e.dispatch("addEvent",{event:o}),o}catch(i){return void ne.Z.create({message:`could not publish post: ${i}`,color:"negative"})}}async function ge(e,{now:t,pubkey:n,text:s,tags:i}){if(0===s.length)return;let o="???";try{var a,l,r;if(e.state.keys.priv)o=(0,ee.H)(e.state.keys.priv,n,s);else{if(await(null===(a=window)||void 0===a||null===(l=a.nostr)||void 0===l||null===(r=l.getPublicKey)||void 0===r?void 0:r.call(l))!==e.state.keys.pub)throw new Error("no private key available to encrypt!");o=await window.nostr.nip04.encrypt(n,s)}let d={pubkey:e.state.keys.pub,created_at:t,kind:4,tags:i,content:o},u=await(0,ie.B_)(d,e),c=await(0,oe.nY)(u);if(!c)throw new Error("could not publish message");return e.dispatch("addEvent",{event:u}),u}catch(d){return void ne.Z.create({message:`could not publish message: ${d}`,color:"negative"})}}async function me(e){let t=await(0,oe.MD)(e.state.keys.pub);var n=(null===t||void 0===t?void 0:t.tags)||[];let s=[];await Promise.all(e.state.follows.map((async e=>{let t=n.findIndex((([t,n])=>"p"===t&&n===e));t>=0?s.push(n[t]):s.push(await(0,ae.l_)(e))})));try{let t,n,i={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:3,tags:s,content:JSON.stringify(e.state.relays)},o=await(0,ie.B_)(i,e),a=await(0,oe.nY)(o);if(!a)throw new Error("could not publish updated list of followed keys and relays");return e.dispatch("addEvent",{event:o}),t=JSON.parse(o.content),n=o.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t)),e.commit("setFollows",n),e.commit("setRelays",t),(0,oe.JH)(t),await e.dispatch("addEvent",{event:o}),ne.Z.create({message:"updated and published list of followed keys and relays.",color:"positive"}),o}catch(i){return void ne.Z.create({message:`could not publish updated list of followed keys and relays: ${i}`,color:"negative"})}}async function ye(e,t){t.created_at&&delete t.created_at;try{let n={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:0,tags:[],content:JSON.stringify(t)},s=await(0,ie.B_)(n,e),i=await(0,oe.nY)(s);if(!i)throw new Error("could not publish updated profile event");return e.dispatch("addEvent",{event:s}),e.dispatch("handleAddingProfileEventToCache",s),ne.Z.create({message:"updated and published profile",color:"positive"}),s}catch(n){return void ne.Z.create({message:`could not publish updated profile: ${n}`,color:"negative"})}}async function fe(e,t){try{let n={pubkey:e.state.keys.pub,created_at:Math.round(Date.now()/1e3),kind:2,tags:[],content:t},s=await(0,ie.B_)(n,e),i=await(0,oe.nY)(s);if(!i)throw new Error("could not publish recommend relay event");return e.dispatch("addEvent",{event:s}),s}catch(n){return void ne.Z.create({message:`could not publish recommend relay event: ${n}`,color:"negative"})}}const we=(0,se.Z)((async(e,t)=>{ue.streamUserProfile?ue.streamUserProfile.update(t.slice(0,500)):ue.streamUserProfile=await(0,oe.ix)(t.slice(0,500),(async t=>{e.dispatch("handleAddingProfileEventToCache",t),e.dispatch("cancelUseProfile",{pubkey:t.pubkey})}))}),3e3);let ve={};async function be(e,{pubkey:t}){if(m.Z.methods.isKey(t))if(t in e.state.profilesCache)e.commit("addProfileToCache",{pubkey:t,...e.state.profilesCache[t]});else{let n=await(0,oe.NL)(t);if(n){let t=(0,ie.Wb)(n);e.dispatch("useNip05",{metadata:t})}else{ve[t]=ve[t]||{count:0,since:Date.now()},ve[t].count++;for(let e of Object.keys(ve))ve[e].since&&ve[e].since<Date.now()-3e4&&delete ve[e];ve[t]&&1===ve[t].count&&we(e,Object.keys(ve))}}}async function ke(e,{pubkey:t}){ve[t]&&(ve[t].count--,ve[t].count<=0&&(delete ve[t],we(e,Object.keys(ve))))}async function xe(e,{metadata:t}){if(""===t.nip05&&delete t.nip05,t.nip05){let n=e.state.nip05VerificationCache[t.nip05];if(n&&n.when>Date.now()/1e3-3600)n.pubkey!==t.pubkey&&delete t.nip05;else{let n=await(0,te.x)(t.nip05);e.commit("addToNIP05VerificationCache",{pubkey:n,identifier:t.nip05}),t.pubkey!==n&&delete t.nip05}}e.commit("addProfileToCache",t)}async function Ce(e,t){if(e.state.profilesCache[t.pubkey]&&t.created_at<=e.state.profilesCache[t.pubkey].created_at)return;let n=(0,ie.Wb)(t);e.commit("addProfileToCache",n),e.dispatch("useNip05",{metadata:n})}function Me(e){e.subscribe((({type:e,payload:t},n)=>{switch(e){case"setKeys":l.Z.set("keys",n.keys);break;case"setFollows":l.Z.set("follows",n.follows);break;case"setRelays":l.Z.set("relays",n.relays);break;case"setConfig":case"setConfigLightningTips":l.Z.set("config",n.config);break;case"haveReadNotifications":l.Z.set("lastNotificationRead",n.lastNotificationRead);break;case"haveReadMessage":l.Z.set("lastMessageRead",n.lastMessageRead);break}}))}function _e(e){e.subscribe((({type:t,payload:n},s)=>{switch(t){case"addRelay":case"removeRelay":case"setRelayOpt":case"saveRelays":case"follow":case"unfollow":case"reorderFollows":e.dispatch("publishContactList");break}}))}function qe(e){e.subscribe((({type:t,payload:n},s)=>{switch(t){case"addRelay":{let t=Object.assign({},e.state.relays);t[n]={read:!0,write:!0},(0,oe.JH)(t);break}case"saveRelays":(0,oe.JH)(n);break;case"follow":case"unfollow":e.dispatch("restartMainSubscription");break}}))}function Te(e){const t=async()=>{e.commit("setUnreadNotifications",await(0,oe.mX)(e.state.keys.pub,e.state.lastNotificationRead))},n=async t=>{e.commit("setUnreadMessages",{peer:t,count:await(0,oe.TE)(e.state.keys.pub,t,e.state.lastMessageRead[t]||0)})};let s=null;const i=()=>{if(e.state.keys.pub)s&&s.cancel(),s=(0,oe.BT)(e.state.keys.pub,(e=>{1===e.kind?t():4===e.kind&&n(e.pubkey)}));else{let i=setInterval((()=>{e.state.keys.pub&&!s&&((0,oe.BT)("p",e.state.keys.pub,(e=>{1===e.kind?t():4===e.kind&&n(e.pubkey)})),clearInterval(i))}),2e3)}t(),(0,oe.mw)(e.state.keys.pub).then((e=>{e.forEach((e=>{n(e.peer)}))}))};e.subscribeAction((({type:e,payload:t},n)=>{switch(e){case"restartMainSubscription":i();break}})),e.subscribe((({type:e,payload:s},i)=>{switch(e){case"haveReadNotifications":t();break;case"haveReadMessage":n(s);break}}))}const Be=(0,a.MT)({state:p,getters:s,mutations:i,actions:o,plugins:[Me,_e,qe,Te]})},22330:(e,t,n)=>{"use strict";n.d(t,{B_:()=>r,CX:()=>o,Wb:()=>a,nf:()=>l});n(40702),n(46727);var s=n(88995),i=n(18009);function o(e){return{id:e.id,pubkey:e.pubkey,created_at:e.created_at,kind:e.kind,tags:e.tags,content:e.content,sig:e.sig}}function a(e){try{let t=JSON.parse(e.content);for(let e of Object.keys(t))t[e]=s.sanitize(t[e]);return t.pubkey=e.pubkey,t.created_at=e.created_at,t}catch(t){return console.log("metadataFromEvent error",t),{}}}function l(e){var t;if(e.tags.filter((([e,t])=>"e"===e&&(!t||t.includes(" ")))).length)return!1;if("this workshop is awesome!"===e.content)return!1;if("Hello Nostr! :)"===e.content)return!1;if(""===e.content.trim())return!1;if(null!==(t=e.seen_on)&&void 0!==t&&t.length&&e.seen_on.includes("wss://rsslay.nostr.net"))return!1;try{return JSON.parse(e.content),!1}catch(n){}return!0}async function r(e,t){if(e.id=(0,i.s_)(e),t.state.keys.priv)e.sig=await(0,i.Y5)(e,t.state.keys.priv);else if(window.nostr){let t=await window.nostr.signEvent(e);switch(typeof t){case"string":e.sig=t;break;case"object":e.sig=t.sig;break;default:throw new Error("Failed to sign with Nostr extension.")}}return e}},26041:(e,t,n)=>{"use strict";n.d(t,{OV:()=>i,aR:()=>o,l_:()=>a,wn:()=>l});n(46727),n(40702);var s=n(34136);function i(e,t=5){if(!e)return"";let n=e.slice(0,4);return["npub","nsec","note"].includes(n)?e.slice(0,t+n.length)+"…"+e.slice(-t):e?e.slice(0,t)+"…"+e.slice(-t):""}function o(e,t,n){for(let s=0;s<e.length;s++){let i=e[s];if(n(i,t))return void e.splice(s,0,t)}e.push(t)}async function a(e){var t=["p",e];let n=await(0,s.NL)(e);if(n&&n.seen_on&&n.seen_on.length){let e=n.seen_on[Math.floor(Math.random()*n.seen_on.length)];t.push(e)}return t}async function l(e,...t){let n=await(0,s.uA)(e);if(n&&n.seen_on&&n.seen_on.length){let e=n.seen_on[Math.floor(Math.random()*n.seen_on.length)];return["e",n.id,e,...t]}return["e",e,"",...t]}},18933:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});n(40702),n(46727),n(18964),n(48170),n(47725),n(69359),n(56408),n(83269);var s=n(56366),i=n.n(s),o=n(26041),a=n(4376),l=n(34136),r=n(55350),d=n(84639),u=n(88995),c=n(40270),p=n(6827),h=n(31262);const{formatDate:g}=a.ZP;function m(e,t){return g(e,t,{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})}function y(e,t=!1){let n=new Date(1e3*e),s=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),i=Date.now();return i-s.getTime()<31536e6&&i>s.getTime()?m(s,t?"ddd D MMMM":"D MMMM"):m(s,t?"ddd D MMMM YYYY":"D MMMM YYYY")}const f={methods:{getLocation(){return location},json(e){return JSON.stringify(e,null,2)},log(e){return console.log(e)},toProfile(e){this.$router.push("/"+this.hexToBech32(e,"npub"))},toEvent(e){this.$router.push("/"+this.hexToBech32(e,"note"))},shorten:o.OV,niceDateUTC(e){let t=Math.floor(Date.now()/1e3);if(e>t)return y(e);if(e===t)return this.$t("now");let n=t-e;if(n<60)return`${n}${this.$t("s")}`;let s=Math.floor(n/60);if(s<60)return`${s}${this.$t("m")}`;let i=Math.floor(s/60);return i<24?`${i}${this.$t("h")}`:y(e)},dateUTC(e){return y(e,!0)},timeUTC(e){let t=new Date(1e3*e);return`${String(t.getUTCHours()).padStart(2,"0")}:${String(t.getUTCMinutes()).padStart(2,"0")} ${this.$t("UTC")}`},interpolateMentions(e,t){const n={profiles:[],replyEvents:[],mentionEvents:[]};if(e=String(e).trim(),""===e)return{text:e,replyEvents:[],mentionEvents:t.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t))};const s=(s,i)=>{if(t.length-1<Number(i)||t[Number(i)].length<2||!["e","p"].includes(t[Number(i)][0]))return s;if("e"===t[Number(i)][0]){const a=t[Number(i)][1];return n.mentionEvents.push(a),s.length===e.length?"":`[${(0,o.OV)(this.hexToBech32(a,"note"))}](/${this.hexToBech32(a,"note")})`}if("p"===t[Number(i)][0]){const e=t[Number(i)][1],n=this.$store.getters.displayName(e);return`[${n}](/${this.hexToBech32(e,"npub")})`}},i=(e,t,n)=>`${t}[${e}](/hashtag/${n})`,a=(e,t)=>{const n=this.$store.getters.displayName(t);return`[@${n}](/${t})`};let l=e.replace(/#\[(\d+)\]/g,s),r=l.replace(/(?<s>^|[\s])#([\w]{1,63})\b/g,i),d=r.replace(/@([\w]{64})/g,a),c=d,p=t.findIndex((([e,t,n,s])=>"e"===e&&t&&"root"===s));if(p>=0){let[e,s]=t[p];!n.mentionEvents.includes(s)&&n.replyEvents.length<2&&n.replyEvents.push(s);let i=t.find((([e,t,n,s])=>"e"===e&&t&&"reply"===s));if(i>=0){let[e,s]=t[i];!n.mentionEvents.includes(s)&&n.replyEvents.length<2&&n.replyEvents.push(s)}}return t.filter((([e,t,n,s])=>"e"===e&&t&&"mention"===s)).forEach((([e,t],s)=>{n.mentionEvents.includes(t)||n.mentionEvents.push(t)})),t.filter((([e,t])=>"e"===e&&t)).forEach((([e,t],s)=>{n.mentionEvents.includes(t)||n.replyEvents.includes(t)||(n.replyEvents.length<2?n.replyEvents.push(t):n.mentionEvents.push(t))})),{text:u.sanitize(c),replyEvents:n.replyEvents,mentionEvents:n.mentionEvents}},interpolateEventMentions(e){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.content,e.tags||[]))}))},interpolateMessageMentions(e){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.text,e.tags))}))},createMentionsProvider(e){const t=new(i())({menuContainer:document.getElementById("tribute-wrapper"),positionMenu:!1,selectTemplate:e=>`${this.hexToBech32(e.original.value.pubkey,"npub")}`,menuItemTemplate:e=>`\n            <div class="flex row no-wrap items-center" style="gap: .2rem; width: 100%;">\n              <div style="border-radius: 10px">\n                <img src=${this.$store.getters.avatar(e.original.value.pubkey)} style="object-fit: cover; height: 1.5rem; width: 1.5rem;"/>\n              </div>\n                <div class="text-bold">${e.string}</div>\n              ${this.$store.state.follows.includes(e.original.value.pubkey)?'<i class="notranslate material-icons text-secondary mr-1 -ml-1" aria-hidden="true" role="presentation">visibility</i>':""}\n              ${e.original.value.nip05?'<i class="notranslate material-icons text-accent mr-1 -ml-1" aria-hidden="true" role="presentation">verified</i>':""}\n                <div class="text-secondary text-caption">${(0,o.OV)(this.hexToBech32(e.original.value.pubkey,"npub"))}</div>\n              </div>\n            `,values:(e,t)=>{t(this.$store.getters.namedProfiles.map((e=>({key:this.$store.getters.displayName(e.pubkey),value:e}))))},noMatchTemplate:()=>{}});return{attach:e=>t.attach(e),detach:e=>t.detach(e)}},async processTaggedEvents(e,t){if(!Array.isArray(t))throw new Error("no array supplied");e.splice(10);let n={};for(let s of e)n[s]=await(0,l.w8)(s,(async i=>{this.$store.dispatch("useProfile",{pubkey:i.pubkey}),1===i.kind||2===i.kind?this.interpolateEventMentions(i):4===i.kind&&(i.text=await this.getPlaintext(i),this.interpolateMessageMentions(i)),Array.isArray(t)?t.push(i):console.log("processTaggedEvents events not array",e,i,t),n[s].cancel()}))},async getPlaintext(e){if(e.tags.find((([e,t])=>"p"===e&&t===this.$store.state.keys.pub)))return await this.decrypt(e.pubkey,e.content);if(e.pubkey===this.$store.state.keys.pub){let[t,n]=e.tags.find((([e])=>"p"===e));return await this.decrypt(n,e.content)}},async decrypt(e,t){try{var n,s,i;if(this.$store.state.keys.priv)return(0,r.p)(this.$store.state.keys.priv,e,t);if(await(null===(n=window)||void 0===n||null===(s=n.nostr)||void 0===s||null===(i=s.getPublicKey)||void 0===i?void 0:i.call(s))===this.$store.state.keys.pub)return await window.nostr.nip04.decrypt(e,t);throw new Error("no private key available to decrypt!")}catch(o){return"???"}},isKey(e){return!(!e||"string"!==typeof e)&&/^[0-9a-f]{64}$/.test(null===e||void 0===e?void 0:e.toLowerCase())},isBech32Key(e){if("string"!==typeof e)return!1;try{let{prefix:t}=d.bech32.decode(e.toLowerCase());return!!["npub","nsec"].includes(t)&&("npub"===t&&(this.watchOnly=!0),"nsec"===t&&(this.watchOnly=!1),this.isKey(this.bech32ToHex(e)))}catch(t){}return!1},bech32ToHex(e){try{let{words:t}=d.bech32.decode(e),n=c.Buffer.from(d.bech32.fromWords(t));return this.toHexString(n)}catch(t){}return""},hexToBech32(e,t){try{let n=d.bech32.toWords(this.fromHexString(e));return d.bech32.encode(t,n)}catch(n){}return""},toHexString(e){let t=e.reduce(((e,t)=>{let n=t.toString(16);return 1===n.length&&(n="0"+n),e+n}),"");return t},fromHexString(e){if(e.length%2!==0||!/^[0-9a-f]+$/i.test(e))return null;let t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return t},lnurlToLnAddr(e){try{let t=h.P6.decodeUrlOrAddress(e);if(!t)return null;let n=/^https:\/\/(?<domain>[a-zA-z0-9.]+)\/.well-known\/lnurlp\/(?<user>[a-zA-Z0-9_-]+)/,s=t.match(n);if(s)return`${s.groups.user}@${s.groups.domain}`}catch(t){}return null},lnAddrToLnurl(e){try{if(!h.P6.isLightningAddress(e))return null;let t=h.P6.decodeUrlOrAddress(e),n=d.bech32.toWords(c.Buffer.from(t,"utf8")),s=d.bech32.encode("lnurl",n,2e3);return s}catch(t){}},async getInvoice(e,t){if(0===e.toLowerCase().indexOf("lnbc"))return e;if(!t)return e;try{const{invoice:n}=await(0,h.Fl)({lnUrlOrAddress:e,tokens:t,fetchGet:e=>{let t=`https://proxy.astral.ninja/${e.url}`;return e.params&&(t.includes("?")?t+="&":t+="?",t+=new URLSearchParams(e.params)),fetch(t).then((e=>e.json())).catch((e=>{p.Z.create({message:"Error fetching invoice from LNURL. "+e.toString()})}))}});return n}catch(n){return p.Z.create({message:"Error fetching invoice from LNURL. "+n.toString()}),this.lnString}}}}},45032:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n(59835),i=n(86970);function o(e,t,n,o,a,l){const r=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn");return e.buttonText?((0,s.wg)(),(0,s.j4)(d,{key:0,icon:"content_copy",unelevated:"",clickable:"",onClick:e.copy,class:(0,i.C_)([""+e.buttonClass,"button-copy"]),size:e.buttonSize,dense:"",label:e.verbose||e.buttonLabel?e.buttonLabel||"copy":"",align:"left"},{default:(0,s.w5)((()=>[e.tooltipText?((0,s.wg)(),(0,s.j4)(r,{key:0},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.tooltipText),1)])),_:1})):(0,s.kq)("",!0)])),_:1},8,["onClick","class","size","label"])):(0,s.kq)("",!0)}var a=n(18933),l=n(6827);const r=(0,s.aZ)({name:"BaseButtonCopy",mixins:[a.Z],props:{buttonText:{type:String,required:!0},buttonLabel:{type:String,default:null},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1},tooltipText:{type:String,required:!1,default:""},element:{type:Object,default:null}},computed:{copyText(){var e,t;let n=null===(e=this.element)||void 0===e||null===(t=e.getSelection())||void 0===t?void 0:t.toString();return n||this.buttonText}},methods:{async copy(){let e=this.copyText;console.log(e),await navigator.clipboard.writeText(e),l.Z.create({message:`copied ${this.copyText.length<70?this.copyText:this.shorten(this.copyText,30)}`})}}});var d=n(11639),u=n(24455),c=n(46858),p=n(69984),h=n.n(p);const g=(0,d.Z)(r,[["render",o]]),m=g;h()(r,"components",{QBtn:u.Z,QTooltip:c.Z})},39057:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var s=n(59835),i=n(61957),o=n(86970);const a={class:"flex row justify-end"},l={class:"overflow-auto"},r=(0,s.Uk)(" metadata ");function d(e,t,n,d,u,c){const p=(0,s.up)("q-btn"),h=(0,s.up)("BaseRawEvent"),g=(0,s.up)("q-card"),m=(0,s.up)("q-dialog"),y=(0,s.up)("q-tooltip"),f=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(m,{modelValue:e.metadataDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.metadataDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,s.w5)((()=>[(0,s._)("div",a,[(0,s.wy)((0,s.Wm)(p,{icon:"close",flat:"",dense:""},null,512),[[f]])]),(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.events,(e=>((0,s.wg)(),(0,s.j4)(h,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(p,{icon:"info",unelevated:"",clickable:"",onClick:t[2]||(t[2]=(0,i.iM)((t=>e.toggleMetadataDialog()),["stop"])),class:(0,o.C_)([""+e.buttonClass,"button-info"]),size:e.buttonSize,label:e.verbose?"info":"",dense:"",align:"left"},{default:(0,s.w5)((()=>[e.verbose?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(y,{key:0},{default:(0,s.w5)((()=>[r])),_:1}))])),_:1},8,["class","size","label"])],64)}const u={class:"text-subtitle1"},c=(0,s.Uk)(" raw event data ");function p(e,t,n,i,a,l){const r=(0,s.up)("BaseButtonCopy"),d=(0,s.up)("q-card-section"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(p,{style:{"box-shadow":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s._)("div",u,[c,(0,s.Wm)(r,{"button-text":e.json(l.cleaned)},null,8,["button-text"])]),(0,s._)("pre",null,(0,o.zw)(e.json(l.cleaned)),1)])),_:1})])),_:1})}var h=n(18933),g=n(22330),m=n(45032),y=n(88995);const f={name:"BaseRawEvent",mixins:[h.Z],props:{event:{type:Object,required:!0}},components:{BaseButtonCopy:m.Z},computed:{cleaned(){return Array.isArray(this.event)?this.event.map((e=>(0,g.CX)(this.sanitize(e)))):(0,g.CX)(this.sanitize(this.event))}},methods:{sanitize(e){return JSON.parse(y.sanitize(JSON.stringify(this.event)))}}};var w=n(11639),v=n(44458),b=n(63190),k=n(69984),x=n.n(k);const C=(0,w.Z)(f,[["render",p]]),M=C;x()(f,"components",{QCard:v.Z,QCardSection:b.Z});const _=(0,s.aZ)({name:"BaseButtonInfo",emits:["dialog","hide"],components:{BaseRawEvent:M},data(){return{metadataDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleMetadataDialog(){this.metadataDialog=!this.metadataDialog,this.$emit("dialog",this.metadataDialog)}}});var q=n(87743),T=n(24455),B=n(46858),S=n(62146);const z=(0,w.Z)(_,[["render",d]]),Z=z;x()(_,"components",{QDialog:q.Z,QCard:v.Z,QBtn:T.Z,QTooltip:B.Z}),x()(_,"directives",{ClosePopup:S.Z})},78414:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(59835),i=n(86970),o=n(61957);const a=(0,s.Uk)(" tip with bitcoin lightning network ");function l(e,t,n,l,r,d){const u=(0,s.up)("q-tooltip"),c=(0,s.up)("BaseLightningCard"),p=(0,s.up)("q-dialog"),h=(0,s.up)("q-btn"),g=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.j4)(g,{class:"no-padding",flat:""},{default:(0,s.w5)((()=>[e.lnString&&this.$store.state.config.preferences.lightningTips.enabled?((0,s.wg)(),(0,s.j4)(h,{key:0,icon:"bolt",class:(0,i.C_)(["button-lightning",e.oneClick?"q-pr-none q-pl-sm":""]),onClick:(0,o.iM)(e.handleLightningTipClick,["stop"]),align:"left",size:e.size,unelevated:"",ripple:!1,dense:"",disable:e.loading},{default:(0,s.w5)((()=>[e.loading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:0},{default:(0,s.w5)((()=>[a])),_:1})),(0,s.Wm)(p,{modelValue:e.showLightningCard,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showLightningCard=t)},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{"ln-string":e.lnString,pubkey:e.pubkey,style:{padding:"1.5rem"}},null,8,["ln-string","pubkey"])])),_:1},8,["modelValue"])])),_:1},8,["class","onClick","size","disable"])):(0,s.kq)("",!0),e.oneClick?((0,s.wg)(),(0,s.j4)(h,{key:1,icon:"arrow_drop_down",class:"no-padding",dense:"",unelevated:"",size:e.size,onClick:t[1]||(t[1]=(0,o.iM)((t=>e.showLightningCard=!e.showLightningCard),["stop"]))},null,8,["size"])):(0,s.kq)("",!0)])),_:1})}var r=n(18933),d=n(65143),u=n(6827);const c=(0,s.aZ)({name:"BaseButtonLightning",mixins:[r.Z],components:{BaseLightningCard:d.Z},data(){return{showLightningCard:!1,oneClick:this.$store.state.config.preferences.lightningTips.oneClick.enabled,amount:this.$store.state.config.preferences.lightningTips.oneClick.amount,lnString:this.$store.getters.profileLud06(this.pubkey),loading:!1}},props:{pubkey:{type:String,required:!0},size:{type:String,required:!1,default:"sm"}},methods:{handleLightningTipClick(){window.webln&&this.$store.state.config.preferences.lightningTips.oneClick.enabled?this.sendTip():this.showLightningCard=!this.showLightningCard},async sendTip(){if(!window.webln)return;this.loading=!0;const e=await this.getInvoice(this.lnString,this.amount);if(e.startsWith("lnurl"))return u.Z.create({message:`invoice couldn't be fetched for ${this.$store.getters.displayName(this.pubkey)}, please use a different pay method`}),void(this.loading=!1);try{await window.webln.sendPayment(e),u.Z.create({message:`${this.amount} sats sent to ${this.$store.getters.displayName(this.pubkey)}`})}catch{u.Z.create({message:"one click tip unsuccessful"})}this.loading=!1}}});var p=n(11639),h=n(67236),g=n(24455),m=n(46858),y=n(87743),f=n(69984),w=n.n(f);const v=(0,p.Z)(c,[["render",l]]),b=v;w()(c,"components",{QBtnGroup:h.Z,QBtn:g.Z,QTooltip:m.Z,QDialog:y.Z})},73270:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(59835),i=n(86970);const o={class:"flex row justify-end"},a={class:"overflow-auto"},l=(0,s.Uk)(" seen on relays ");function r(e,t,n,r,d,u){const c=(0,s.up)("q-btn"),p=(0,s.up)("BaseRelayList"),h=(0,s.up)("q-card"),g=(0,s.up)("q-dialog"),m=(0,s.up)("q-tooltip"),y=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(g,{modelValue:e.relayListDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.relayListDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s._)("div",o,[(0,s.wy)((0,s.Wm)(c,{icon:"close",flat:"",dense:""},null,512),[[y]])]),(0,s._)("div",a,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.events,(e=>((0,s.wg)(),(0,s.j4)(p,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(c,{icon:"sync_alt",unelevated:"",clickable:"",onClick:e.toggleRelayListDialog,class:(0,i.C_)([""+e.buttonClass,"button-relays"]),size:e.buttonSize,label:e.verbose?"relays":"",dense:"",align:"left"},{default:(0,s.w5)((()=>[e.verbose?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(m,{key:0},{default:(0,s.w5)((()=>[l])),_:1}))])),_:1},8,["onClick","class","size","label"])],64)}var d=n(23738);const u=(0,s.aZ)({name:"BaseButtonRelays",emits:["dialog","hide"],components:{BaseRelayList:d.Z},data(){return{relayListDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleRelayListDialog(){this.relayListDialog=!this.relayListDialog,this.$emit("dialog",this.relayListDialog)}}});var c=n(11639),p=n(87743),h=n(44458),g=n(24455),m=n(46858),y=n(62146),f=n(69984),w=n.n(f);const v=(0,c.Z)(u,[["render",r]]),b=v;w()(u,"components",{QDialog:p.Z,QCard:h.Z,QBtn:g.Z,QTooltip:m.Z}),w()(u,"directives",{ClosePopup:y.Z})},65143:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ye});var s=n(59835),i=n(86970),o=n(61957);const a=e=>((0,s.dD)("data-v-7aa1d76e"),e=e(),(0,s.Cn)(),e),l={class:"lightning-card"},r=["align"],d={key:0,class:"flex column items-center"},u=a((()=>(0,s._)("span",{class:"text-bold",style:{"font-size":"1.1rem"}},"lightning tip for",-1))),c={key:1,class:"text-bold",style:{"font-size":"1.1rem"}},p={key:0},h=a((()=>(0,s._)("strong",null,"desc:",-1))),g=a((()=>(0,s._)("strong",null,"amount:",-1))),m={key:1},y=a((()=>(0,s._)("strong",null,"created date:",-1))),f={key:2},w=a((()=>(0,s._)("strong",null,"created time:",-1))),v={key:3},b=a((()=>(0,s._)("strong",null,"expires date:",-1))),k={key:4},x=a((()=>(0,s._)("strong",null,"expires time:",-1))),C={key:5},M=a((()=>(0,s._)("strong",null,"error:",-1))),_={key:0,class:"flex row items-center"},q={class:"break-word-wrap",style:{"font-size":".7rem","overflow-y":"auto","max-height":"170px","max-width":"200px"}};function T(e,t,n,a,T,B){const S=(0,s.up)("BaseUserCard"),z=(0,s.up)("BaseButtonCopy"),Z=(0,s.up)("q-btn"),W=(0,s.up)("q-tab-panel"),$=(0,s.up)("BaseQr"),j=(0,s.up)("BaseWallet"),D=(0,s.up)("q-tab-panels");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",{class:(0,i.C_)(["flex no-wrap justify-between",n.rowOrColumn]),style:{gap:"1rem"}},[(0,s._)("div",{style:(0,i.j5)([{"font-size":".9rem"},"row"===n.rowOrColumn?"gap: .5rem;":"gap: 1rem;"]),class:"flex column justify-between",align:"row"===n.rowOrColumn?"start":"center"},[n.pubkey?((0,s.wg)(),(0,s.iD)("div",d,[u,(0,s.Wm)(S,{pubkey:n.pubkey,"action-buttons":!1},null,8,["pubkey"])])):((0,s.wg)(),(0,s.iD)("div",c,"lightning "+(0,i.zw)(B.type),1)),B.bolt11?((0,s.wg)(),(0,s.iD)("div",{key:2,class:(0,i.C_)(["flex column","row"===n.rowOrColumn?"items-start":"items-center"])},[B.bolt11.description?((0,s.wg)(),(0,s.iD)("div",p,[h,(0,s.Uk)(" "+(0,i.zw)(B.bolt11.description),1)])):(0,s.kq)("",!0),(0,s._)("div",null,[g,(0,s.Uk)(" "+(0,i.zw)(B.bolt11.amount?`${B.bolt11.amount} sats`:"none specified"),1)]),B.bolt11.created?((0,s.wg)(),(0,s.iD)("div",m,[y,(0,s.Uk)(" "+(0,i.zw)(e.dateUTC(B.bolt11.created)),1)])):(0,s.kq)("",!0),B.bolt11.created?((0,s.wg)(),(0,s.iD)("div",f,[w,(0,s.Uk)(" "+(0,i.zw)(e.timeUTC(B.bolt11.created)),1)])):(0,s.kq)("",!0),B.bolt11.expires?((0,s.wg)(),(0,s.iD)("div",v,[b,(0,s.Uk)(" "+(0,i.zw)(e.dateUTC(B.bolt11.expires)),1)])):(0,s.kq)("",!0),B.bolt11.expires?((0,s.wg)(),(0,s.iD)("div",k,[x,(0,s.Uk)(" "+(0,i.zw)(e.timeUTC(B.bolt11.expires)),1)])):(0,s.kq)("",!0),B.bolt11.error?((0,s.wg)(),(0,s.iD)("div",C,[M,(0,s.Uk)(" "+(0,i.zw)(B.bolt11.error),1)])):(0,s.kq)("",!0)],2)):((0,s.wg)(),(0,s.iD)("div",{key:3,class:(0,i.C_)(["flex column","row"===n.rowOrColumn?"items-start":"items-center"])},[T.request.lnAddr?((0,s.wg)(),(0,s.iD)("div",_,[(0,s._)("span",null,(0,i.zw)(T.request.lnAddr),1),(0,s.Wm)(z,{"button-text":T.request.lnAddr,class:"q-pr-xs",onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["button-text"])])):(0,s.kq)("",!0)],2)),(0,s._)("div",{class:(0,i.C_)(["flex row no-wrap q-pt-xs","row"===n.rowOrColumn?" justify-start":" justify-center"]),style:{gap:".5rem"}},[(0,s.Wm)(z,{"button-text":n.lnString,"button-label":"copy",outline:"",class:"q-pr-xs",onClick:t[1]||(t[1]=(0,o.iM)((e=>B.updateMode("copy")),["stop"]))},null,8,["button-text"]),(0,s.Wm)(Z,{label:"qr",icon:"qr_code_2",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:t[2]||(t[2]=(0,o.iM)((e=>B.updateMode("qr")),["stop"]))}),(0,s.Wm)(Z,{label:"wallet",icon:"wallet",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:t[3]||(t[3]=(0,o.iM)((e=>B.updateMode("wallet")),["stop"]))})],2)],12,r),(0,s.Wm)(D,{modelValue:T.mode,"onUpdate:modelValue":t[4]||(t[4]=e=>T.mode=e),style:(0,i.j5)([{background:"unset"},"row"===n.rowOrColumn?"max-width: 50%; width: 50%":"max-width: 100%; width: 100%"])},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{name:"copy",class:(0,i.C_)(["no-padding flex items-center","row"===n.rowOrColumn?"justify-end":"justify-center"])},{default:(0,s.w5)((()=>[(0,s._)("div",q,(0,i.zw)(this.lnString.toLowerCase()),1)])),_:1},8,["class"]),(0,s.Wm)(W,{name:"qr",class:"no-padding flex items-center justify-center"},{default:(0,s.w5)((()=>[(0,s.Wm)($,{code:this.lnString,style:{height:"fit-content"}},null,8,["code"])])),_:1}),(0,s.Wm)(W,{name:"wallet",class:"no-padding flex items-center justify-center full-width"},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{"ln-string":n.lnString,pubkey:n.pubkey,bolt11:B.bolt11},null,8,["ln-string","pubkey","bolt11"])])),_:1})])),_:1},8,["modelValue","style"])],2)])}var B=n(18933),S=n(45032);const z={ref:"qr",style:{"object-fit":"cover","min-height":"200px","min-width":"200px",width:"100%"}};function Z(e,t,n,i,o,a){return(0,s.wg)(),(0,s.iD)("img",z,null,512)}n(40702),n(84641),n(83269);var W=n(21170);const $=(0,s.aZ)({name:"BaseQr",props:{code:{type:String,required:!0}},mounted(){let e=this.$refs.qr,t=e.clientWidth;e.style.height=`${t}px`,this.renderQr()},methods:{renderQr(e){this.showQr=!0;let t=W.Z.QrCode.encodeText(this.code,W.Z.QrCode.Ecc.MEDIUM),n=this.toSvgString(t,4);this.$refs.qr.src=n},toSvgString(e,t){let n="#FFFFFF",s="#000000";if(t<0)throw new RangeError("Border must be non-negative");let i=[];for(let r=0;r<e.size;r++)for(let n=0;n<e.size;n++)e.getModule(n,r)&&i.push(`M${n+t},${r+t}h1v1h-1z`);let o=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 ${e.size+2*t} ${e.size+2*t}" stroke="none">\n\t<rect width="100%" height="100%" fill="${n}"/>\n\t<path d="${i.join(" ")}" fill="${s}"/>\n</svg>\n`,a=new Blob([o],{type:"image/svg+xml"}),l=URL.createObjectURL(a);return l}}});var j=n(11639),D=n(490),L=n(69984),P=n.n(L);const R=(0,j.Z)($,[["render",Z]]),E=R;P()($,"components",{QItem:D.Z});const U={ref:"walletPicker",class:"wallet-picker flex column no-padding justify-center",style:{gap:"1rem",height:"100%",width:"100%"}},I={class:"flex row full-width items-center justify-center"},N={key:0,class:"flex row no-wrap items-center q-pa-xs",style:{gap:".5rem","font-size":"1.1rem",width:"100%"}},A=["src"],O={key:1,style:{"font-size":"1.1rem",width:"100%"}},F={class:"flex column no-wrap q-pa-sm base-select-list",style:{"max-height":"80%",gap:".5rem",background:"var(--q-background)","font-size":"1.1rem"}},H=["onClick"],Q=["src"],V={key:0,class:"flex row items-center justify-center",style:{gap:".7rem"}},K=(0,s._)("div",{style:{"font-size":"1.1rem"}}," sats",-1),J={key:1,class:"flex row justify-center",style:{gap:".3rem"}},Y={class:"flex column justify-center items-center",style:{"font-size":".9rem",width:"100%"}},X={key:0},G={key:1},ee={key:2};function te(e,t,n,a,l,r){const d=(0,s.up)("q-dialog"),u=(0,s.up)("BaseSelect"),c=(0,s.up)("q-btn"),p=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",U,[(0,s._)("div",I,[(0,s._)("div",null,[(0,s.Wm)(u,{selecting:e.showWalletPicker,onToggle:t[1]||(t[1]=t=>e.showWalletPicker=!e.showWalletPicker),style:{width:"100%"}},{default:(0,s.w5)((()=>[e.selectedWallet?((0,s.wg)(),(0,s.iD)("div",N,[e.loadingInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("img",{key:0,src:"wallet-icons/"+e.selectedWallet.image,style:{height:"1.5rem",width:"1.5rem","border-radius":".3rem"}},null,8,A)),(0,s._)("div",null,(0,i.zw)(e.selectedWallet.name),1)])):((0,s.wg)(),(0,s.iD)("div",O," select a wallet "))])),"list-items":(0,s.w5)((()=>[(0,s.Wm)(d,{modelValue:e.showWalletPicker,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showWalletPicker=t)},{default:(0,s.w5)((()=>[(0,s._)("div",F,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.wallets,((t,n)=>((0,s.wg)(),(0,s.iD)("li",{key:n,onClick:(0,o.iM)((n=>e.selectWallet(t)),["stop"]),class:"flex row items-center no-wrap q-pl-xs",style:{gap:".5rem"}},[e.loadingInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("img",{key:0,src:"wallet-icons/"+t.image,style:{height:"1.5rem",width:"1.5rem","border-radius":".3rem"}},null,8,Q)),(0,s._)("div",null,(0,i.zw)(t.name),1)],8,H)))),128))])])),_:1},8,["modelValue"])])),_:1},8,["selecting"])])]),e.isInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",V,[(0,s._)("div",{id:"amount-input",contenteditable:"",style:{"font-size":"2rem",padding:"0 .4rem","min-width":"2rem",outline:"none",border:"none"},onInput:t[2]||(t[2]=(...t)=>e.updateTipAmount&&e.updateTipAmount(...t)),onKeypress:t[3]||(t[3]=(0,o.D2)((t=>e.openInWallet()),["enter"]))},(0,i.zw)(e.tipAmount),33),K])),e.isInvoice?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",J,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.tipPresets,((t,n)=>((0,s.wg)(),(0,s.j4)(c,{key:n,label:t+" sats",size:"sm",outline:"",onClick:(0,o.iM)((n=>e.tipAmount=t),["stop"])},null,8,["label","onClick"])))),128)),(0,s.Wm)(c,{label:"other",size:"sm",outline:"",onClick:t[4]||(t[4]=(0,o.iM)((t=>e.focusAmount()),["stop"]))})])),(0,s._)("div",Y,[e.selectedWallet?!e.isInvoice&&e.selectedWallet&&0===e.tipAmount?((0,s.wg)(),(0,s.iD)("span",G,"please enter an amount greater than 0")):e.isInvoice||!e.selectedWallet||e.tipAmount?(0,s.wy)(((0,s.wg)(),(0,s.j4)(c,{key:3,spread:"",outline:"",class:"full-width",label:e.hasWebLn&&"lightning:"===e.selectedWallet.prefix?"pay":"open wallet",color:"primary",onClick:t[5]||(t[5]=(0,o.iM)((t=>e.openInWallet()),["stop"]))},null,8,["label"])),[[p]]):((0,s.wg)(),(0,s.iD)("span",ee,"please enter an amount")):((0,s.wg)(),(0,s.iD)("span",X,"please select a wallet"))])],512)}var ne=n(6827),se=n(16842);const ie=(0,s.aZ)({name:"BaseWallet",mixins:[B.Z],components:{BaseSelect:se.Z},props:{lnString:{type:String,required:!0,default:""},pubkey:{type:String,default:null},bolt11:{type:Object,default:null},extended:{type:Boolean,requred:!1,default:!1},size:{type:String,required:!1,default:"sm"}},data(){return{showWalletPicker:!1,loadingInvoice:!1,tipAmount:this.$store.state.config.preferences.lightningTips.presets[0],tipPresets:this.$store.state.config.preferences.lightningTips.presets,selectedWallet:null,wallets:[{name:"system default",prefix:"lightning:",image:"default.png"},{name:"browser extension (webln)",prefix:"lightning:",image:"webln.jpg"},{name:"Strike",prefix:"strike:lightning:",image:"strike.jpg"},{name:"Cash App",prefix:"squarecash://",image:"cashapp.jpg"},{name:"Muun",prefix:"muun:",image:"muun.jpg"},{name:"Breez",prefix:"breez:",image:"breez.jpg"},{name:"Phoenix",prefix:"phoenix://",image:"phoenix.jpg"},{name:"Wallet of Satoshi",prefix:"walletofsatoshi:lightning:",image:"wos.jpg"},{name:"Blixt",prefix:"blixtwallet:lightning:",image:"blixt.png"},{name:"Zeus LN",prefix:"zeusln:lightning:",image:"zeusln.jpg"},{name:"Bitcoin Beach",prefix:"bitcoinbeach://",image:"bbw.jpg"}],hasWebLn:!1,focusAmount(){setTimeout((async()=>{await this.$nextTick(),this.tipAmount=null,this.amountInput.focus()}),1)}}},computed:{amountInput(){return this.$refs.walletPicker.querySelector("#amount-input")},isInvoice(){return this.lnString.startsWith("lnbc")}},mounted(){this.selectedWallet=this.wallets.find((e=>e.name===this.$store.state.config.preferences.lightningTips.lastWallet)),this.hasWebLn=window.webln},methods:{selectWallet(e){this.selectedWallet=e,this.showWalletPicker=!1},updateTipAmount(e){let t=e.target.innerText,n=/^[0-9]+$/,s=t.match(n);if(!s)return void(this.tipAmount=null);let i=parseInt(t);this.tipAmount=i},async openInWallet(){if(!this.selectedWallet||!this.tipAmount)return;this.$store.commit("setConfigLightningTips",{key:"lastWallet",value:this.selectedWallet.name});let e=this.selectedWallet.prefix;e||(e="lightning:"),this.loadingInvoice=!0;const t=await this.getInvoice(this.lnString,this.tipAmount);if(t.startsWith("lnurl"))return ne.Z.create({message:`invoice couldn't be fetched for ${this.$store.getters.displayName(this.pubkey)}, please an different pay method`}),void(this.loadingInvoice=!1);if("lightning:"===e&&window.webln&&t.startsWith("lnbc"))try{await window.webln.sendPayment(t),ne.Z.create({message:`${this.bolt11?this.bolt11.amount:this.tipAmount} sats sent`})}catch{ne.Z.create({message:"payment unsuccessful"})}else window.open(`${e}${t}`,"_self");this.loadingInvoice=!1}}});var oe=n(87743),ae=n(24455),le=n(62146);const re=(0,j.Z)(ie,[["render",te]]),de=re;P()(ie,"components",{QDialog:oe.Z,QBtn:ae.Z}),P()(ie,"directives",{ClosePopup:le.Z});var ue=n(78621),ce=n(31262);const pe={name:"BaseLightningCard",mixins:[B.Z],props:{lnString:{type:String,required:!0},pubkey:{type:String,default:null},rowOrColumn:{type:String,default:"column"}},components:{BaseButtonCopy:S.Z,BaseQr:E,BaseWallet:de},data(){return{request:{},mode:this.$store.state.config.preferences.lightningTips.lastMode}},computed:{bolt11(){if(!this.lnString.toLowerCase().startsWith("lnbc"))return null;try{let e=ue.decode(this.lnString),t={};e.sections.forEach((({name:e,value:n})=>{t[e]=n}));let n=t.amount?t.amount/1e3:null,s=t.description,i=t.timestamp,o=t.expiry,a=parseInt(o),l=isNaN(a)?null:i+a,r=e.paymentRequest;return{amount:n,description:s,created:i,expires:l,request:r}}catch(e){console.log("invoice parsing error",e);let t=this.lnString;return{error:e,request:t}}},type(){return this.lnString.startsWith("lnbc")?"invoice":"lnurl"}},async mounted(){if(this.both11)return;if(!ce.P6.isLnurl(this.lnString))return void(this.request.error="invalid lnurl");let e=this.lnurlToLnAddr(this.lnString);e&&(this.request.lnAddr=e)},methods:{updateMode(e){this.mode=e,this.$store.commit("setConfigLightningTips",{key:"lastMode",value:e})}}};var he=n(89800),ge=n(84106);const me=(0,j.Z)(pe,[["render",T],["__scopeId","data-v-7aa1d76e"]]),ye=me;P()(pe,"components",{QBtn:ae.Z,QTabPanels:he.Z,QTabPanel:ge.Z})},50105:(e,t,n)=>{"use strict";n.d(t,{Z:()=>W});n(40702);var s=n(59835),i=n(86970),o=n(61957);const a={ref:"src",class:"hidden break-word-wrap"},l={ref:"append",class:"hidden break-word-wrap"},r=["innerHTML"],d={key:1};function u(e,t,n,u,c,p){const h=(0,s.up)("q-btn"),g=(0,s.up)("BaseLightningCard");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",a,[(0,s.WI)(e.$slots,"default")],512),(0,s._)("div",l,[(0,s.WI)(e.$slots,"append")],512),(0,s._)("div",{innerHTML:c.html,ref:"html",class:(0,i.C_)(["break-word-wrap dynamic-content",n.longForm?"long-form":""]),onClick:t[0]||(t[0]=(...e)=>p.handleClicks&&p.handleClicks(...e))},null,10,r),n.longForm?((0,s.wg)(),(0,s.j4)(h,{key:0,id:"long-form-button",dense:"",outline:"",rounded:"",color:"accent",class:"text-weight-light q-ma-sm justify-between",style:{"letter-spacing":".1rem","justify-content":"space-between"},label:"show full post",onClick:(0,o.iM)(p.expand,["stop"])},null,8,["onClick"])):(0,s.kq)("",!0),c.invoices.length?((0,s.wg)(),(0,s.iD)("div",d,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.invoices,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,"ln-string":e,class:"lt-sm",style:{padding:"1rem"}},null,8,["ln-string"])))),128)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.invoices,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,"ln-string":e,class:"gt-xs","row-or-column":"row",style:{padding:"1rem"}},null,8,["ln-string"])))),128))])):(0,s.kq)("",!0)],64)}n(18964),n(84641),n(83269);var c=n(27678),p=n.n(c),h=n(51994),g=n.n(h),m=n(64879),y=n.n(m),f=n(77984),w=n.n(f),v=n(89105),b=n.n(v),k=n(30651),x=n.n(k),C=n(18933),M=n(65143);const _=p()({html:!1,breaks:!0,linkify:!0});_.use(g()).use(y()).use(w()).use(b()).use(x()).use((e=>{var t=e.renderer.rules.link_open||function(e,t,n,s,i){return i.renderToken(e,t,n)};e.core.ruler.before("normalize","auto-imager",(e=>{e.src=e.src.replace(/https?:[^ \n]+/g,(e=>{if(e){let t=e.split("?")[0];if(t.endsWith(".gif")||t.endsWith(".png")||t.endsWith(".jpeg")||t.endsWith(".jpg")||t.endsWith(".svg")||t.endsWith(".webp")||t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))return`![](${e})`}return e}))})),e.renderer.rules.image=(e,t)=>{let n=e[t].attrs[[e[t].attrIndex("src")]][1],s=n.split("?")[0];return s.endsWith(".gif")||s.endsWith(".png")||s.endsWith(".jpeg")||s.endsWith(".jpg")||s.endsWith(".webp")||s.endsWith(".svg")?`<img src="${n}" async loading='lazy' style="max-width: 90%; max-height: 50vh;">`:s.endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".ogg")?`<video src="${n}" controls async style="max-width: 90%; max-height: 50vh;"></video>`:void 0},e.renderer.rules.link_open=function(e,n,s,i,o){var a=e[n],l=a.attrIndex("target"),r=a.attrIndex("href"),d=/\bhttps:\/\/(www.|m.)?youtu(be.com|.be)\/(watch\?v=|shorts\/)?(?<v>[a-zA-Z0-9_-]{11})(&t=(?<s>[0-9]+)s)?/;let u=a.attrs[r][1].match(d);if(u){let e=`https://www.youtube.com/embed/${u.groups.v}`;return u.groups.s&&(e+=`?start=${u.groups.s}`),`<iframe anonymous async style="height: 15rem; width: 90%; object-fit: cover;" src="${e}"\n          title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>\n          </iframe>`}var c=/^https?:\/\//;return c.test(a.attrs[r][1])&&(l<0?e[n].attrPush(["target","_blank"]):e[n].attrs[l][1]="_blank"),t(e,n,s,i,o)}})),_.linkify.tlds(["onion","eth"],!0).add("bitcoin:",null).add("lightning:",null).add("http:",{validate(e,t,n){var s=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(s)?s.match(n.re.http)[0].length:0},normalize(e,t){if(t.__text_cache__.length<150||e.text<23)return;let n=new URL(e.url),s=n.host;if((n.pathname+n.search+n.hash).length>10){let t=e.text.slice(-7);"/"===t[0]&&(t=t.slice(1)),s+=`/…/${t}`}e.text=s}}).set({fuzzyEmail:!1});const q={name:"BaseMarkdown",mixins:[C.Z],emits:["expand","resized"],components:{BaseLightningCard:M.Z},data(){return{html:"",invoices:[]}},props:{content:{type:String,default:"todo needs to be updated"},longForm:{type:Boolean,default:!1}},computed:{parsedContent(){const e=/\b(?<i>(lnbc|LNBC)[0-9a-zA-Z]*1[0-9a-zA-Z]+)\b/g,t=(e,t)=>(this.invoices.push(e.toLowerCase()),"");let n=this.content.replace(e,t);return n}},mounted(){this.render()},updated(){this.render()},methods:{render(){this.html=_.render(this.parsedContent)+this.$refs.append.innerHTML,this.$refs.html.querySelectorAll("img").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():e.requestFullscreen(),this.$emit("resized")})),e.addEventListener("load",(e=>{this.$emit("resized")}))}))},handleClicks(e){let{target:t}=e;if(t&&t.matches(".dynamic-content a:not([href*='://'])")&&t.href){const{altKey:n,ctrlKey:s,metaKey:i,shiftKey:o,button:a,defaultPrevented:l}=e;if(i||n||s||o)return;if(l)return;if(void 0!==a&&0!==a)return;if(t&&t.getAttribute){const e=t.getAttribute("target");if(/\b_blank\b/i.test(e))return}const r=new URL(t.href),d=r.pathname;window.location.pathname!==d&&e.preventDefault&&(e.preventDefault(),e.stopPropagation(),this.$router.push(d))}else t&&t.matches(".dynamic-content a[href*='://']")&&t.href&&e.stopPropagation()},expand(e){this.$emit("expand")}}};var T=n(11639),B=n(24455),S=n(69984),z=n.n(S);const Z=(0,T.Z)(q,[["render",u]]),W=Z;z()(q,"components",{QBtn:B.Z})},31244:(e,t,n)=>{"use strict";n.d(t,{Z:()=>z});var s=n(59835),i=n(86970),o=n(61957);const a={key:0,class:"text-accent timestamp"},l={class:"flex column message-bubbles"},r={key:0,class:"flex column text-left full-width q-pb-xs embeded-message",style:{display:"block"},clickable:!1},d={key:0,class:"reposts"};function u(e,t,n,u,c,p){const h=(0,s.up)("BasePost"),g=(0,s.up)("BaseMessage",!0),m=(0,s.up)("BaseUserName"),y=(0,s.up)("BaseMarkdown"),f=(0,s.up)("BaseButtonReply"),w=(0,s.up)("BaseButtonCopy"),v=(0,s.up)("BaseButtonInfo"),b=(0,s.up)("BaseButtonRelays"),k=(0,s.up)("q-list"),x=(0,s.up)("q-menu"),C=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["relative-position flex column",p.sent?"message-sent":"message-received"]),onClick:t[3]||(t[3]=(0,o.iM)((()=>{}),["stop"]))},[n.isEmbeded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",a,(0,i.zw)(e.timeUTC(n.event.created_at)),1)),(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.sequence,((a,l)=>((0,s.wg)(),(0,s.iD)("div",{key:l,class:(0,i.C_)(["message-bubble",(0===l||1===p.sequence.length?" first-message":"")+(l===p.sequence.length-1?" last-message":"")])},[!n.isEmbeded&&c.taggedEvents[a.id]&&c.render?((0,s.wg)(),(0,s.iD)("div",r,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.taggedEvents[a.id],(n=>((0,s.wg)(),(0,s.iD)("div",{key:n.id+"_"+c.taggedEvents[a.id].length+"_"+c.render},[1===n.kind||2===n.kind?((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(h,{event:n,"manual-focus":!1,"is-embeded":!0,onContextmenuCapture:(0,o.iM)((t=>e.toEvent(n.id)),["stop"])},null,8,["event","onContextmenuCapture"])])):4===n.kind?((0,s.wg)(),(0,s.j4)(g,{key:1,event:n,class:"no-padding no-margin","is-embeded":!0,clickable:"",onMounted:t[0]||(t[0]=t=>e.$emit("mounted")),onClickCapture:t[1]||(t[1]=(0,o.iM)((()=>{}),["prevent","stop"]))},null,8,["event"])):(0,s.kq)("",!0)])))),128))])):(0,s.kq)("",!0),n.isEmbeded?((0,s.wg)(),(0,s.iD)("div",{key:1,class:(0,i.C_)(["flex row justify-between q-gutter-md",p.sent?"reverse":""])},[(0,s.Wm)(m,{pubkey:a.pubkey,fallback:!0},null,8,["pubkey"]),(0,s._)("span",null,(0,i.zw)(e.niceDateUTC(n.event.created_at)),1)],2)):(0,s.kq)("",!0),(0,s.Wm)(y,{content:a.interpolated.text},null,8,["content"]),n.isEmbeded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(x,{key:2,modelValue:c.contextMenus[l],"onUpdate:modelValue":e=>c.contextMenus[l]=e,"touch-position":"","context-menu":"",persistent:c.persistentMenu,onClick:t[2]||(t[2]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{dense:"",class:"flex column q-gutter-xs q-pa-xs"},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(f,{"button-class":"text-accent full-width justify-start",verbose:!0,onReply:e=>p.reply(a)},null,8,["onReply"])])),[[C]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(w,{"button-class":"text-accent full-width justify-start","button-text":a.interpolated.text,verbose:!0},null,8,["button-text"])])),[[C]]),(0,s._)("div",null,[(0,s.Wm)(v,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])]),(0,s._)("div",null,[(0,s.Wm)(b,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue","persistent"]))],2)))),128))])],2)}n(40702);var c=n(19302),p=n(18933),h=n(73270),g=n(39057),m=n(45032);function y(e,t,n,o,a,l){const r=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(r,{icon:"reply",unelevated:"",clickable:"",onClick:t[0]||(t[0]=t=>e.$emit("reply")),class:(0,i.C_)([""+e.buttonClass,"button-reply"]),size:e.buttonSize,dense:"",label:e.verbose?"reply":"",align:"left"},null,8,["class","size","label"])}const f=(0,s.aZ)({name:"BaseButtonReply",emits:["reply"],props:{buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}});var w=n(11639),v=n(24455),b=n(69984),k=n.n(b);const x=(0,w.Z)(f,[["render",y]]),C=x;k()(f,"components",{QBtn:v.Z});var M=n(50105);const _={name:"BaseMessage",emits:["reply","mounted"],mixins:[p.Z],props:{event:{type:Object,required:!0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:h.Z,BaseButtonInfo:g.Z,BaseButtonCopy:m.Z,BaseButtonReply:C,BaseMarkdown:M.Z},setup(){const e=(0,c.Z)();e.platform.has.touch},data(){return{invisible:!0,menu:{},render:1,contextMenus:[],persistentMenu:!1,taggedEvents:{}}},computed:{sequence(){let e=[this.event].concat(this.event.appended).filter((e=>e));return this.render,e},sent(){return this.event.pubkey===this.$store.state.keys.pub}},mounted(){setTimeout((()=>{this.invisible=!1}),20);for(let t of this.sequence){var e;let n=(null===(e=t.tags)||void 0===e?void 0:e.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t)))||[];n.length&&(this.taggedEvents[t.id]=[],this.processTaggedEvents(n,this.taggedEvents[t.id]))}this.event.created_at<this.$store.state.lastMessageRead[this.bech32ToHex(this.$route.params.pubkey)]&&this.$emit("mounted")},methods:{reply(e){this.$emit("reply",e)},hideMenu(){this.contextMenus=this.contextMenus.map((e=>!1)),this.togglePersistentMenu(!1)},togglePersistentMenu(e){this.persistentMenu=e}}};var q=n(56362),T=n(13246),B=n(62146);const S=(0,w.Z)(_,[["render",u]]),z=S;k()(_,"components",{QMenu:q.Z,QList:T.Z}),k()(_,"directives",{ClosePopup:B.Z})},23738:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var s=n(59835),i=n(86970);const o=e=>((0,s.dD)("data-v-206b03ec"),e=e(),(0,s.Cn)(),e),a=o((()=>(0,s._)("span",{class:"text-bold",style:{"font-size":"1.1rem"}},"relays",-1))),l=(0,s.Uk)("  ( "),r={class:"text-secondary"},d=(0,s.Uk)(" seen "),u=(0,s.Uk)(" not seen "),c=(0,s.Uk)(" ) "),p={style:{"overflow-x":"scroll"}},h={class:"relay-list"},g=(0,s.Uk)("        "),m={key:0,class:"text-secondary",style:{overflow:"hidden"}},y=(0,s.Uk)("\n          "),f=(0,s.Uk)("\n            "),w=(0,s.Uk)("\n        "),v=(0,s.Uk)("\n        "),b={key:1,style:{overflow:"hidden"}},k=(0,s.Uk)("\n          "),x=(0,s.Uk)("\n            "),C=(0,s.Uk)("\n            "),M=(0,s.Uk)("\n        "),_=(0,s.Uk)("\n      ");function q(e,t,n,o,q,T){var B,S;const z=(0,s.up)("q-icon"),Z=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,[a,l,(0,s._)("span",r,[(0,s.Wm)(z,{name:"visibility",size:"xs",dense:""}),d]),(0,s._)("span",null,[(0,s.Wm)(z,{name:"visibility_off",size:"xs",dense:""}),u]),c]),(0,s._)("div",p,[(0,s._)("pre",h,[g,null!==(B=n.event)&&void 0!==B&&null!==(S=B.seen_on)&&void 0!==S&&S.length?((0,s.wg)(),(0,s.iD)("div",m,[y,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.event.seen_on,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"relay-item hide-scrollbar"},[f,(0,s.Wm)(z,{name:"visibility",size:"xs"}),(0,s.Uk)("\n            "+(0,i.zw)(e)+"\n          ",1)])))),128)),w])):(0,s.kq)("",!0),v,T.missingFrom.length?((0,s.wg)(),(0,s.iD)("div",b,[k,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.missingFrom,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"relay-item unseen-relay-item hide-scrollbar",clickable:""},[x,(0,s.Wm)(Z,{icon:"visibility",flat:"",unelevated:"",color:"secondary",size:"sm",class:"no-padding",dense:"",onClick:t=>T.publishTo(e)},null,8,["onClick"]),C,(0,s.Wm)(z,{name:"visibility_off",size:"xs",clickable:""}),(0,s.Uk)("\n            "+(0,i.zw)(e)+"\n          ",1)])))),128)),M])):(0,s.kq)("",!0),_])])])}n(40702);var T=n(34136),B=n(18933),S=n(22330);const z={name:"BaseRelayList",mixins:[B.Z],props:{event:{type:Object,required:!0}},computed:{missingFrom(){return this.event&&this.event.seen_on?Object.entries(this.$store.state.relays).filter((([e,t])=>t.write)).map((([e,t])=>e)).filter((e=>-1===this.event.seen_on.indexOf(e))):[]}},methods:{publishTo(e){(0,T.nY)((0,S.CX)(this.event),e)}}};var Z=n(11639),W=n(22857),$=n(24455),j=n(69984),D=n.n(j);const L=(0,Z.Z)(z,[["render",q],["__scopeId","data-v-206b03ec"]]),P=L;D()(z,"components",{QIcon:W.Z,QBtn:$.Z})},76877:(e,t,n)=>{"use strict";n.d(t,{Z:()=>M});var s=n(59835);const i={class:"flex column q-gutter-md"},o={key:0};function a(e,t,n,a,l,r){const d=(0,s.up)("BaseRelayCard");return(0,s.wg)(),(0,s.iD)("div",i,[n.listView?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",o,"added relay:")),(0,s.Wm)(d,{url:n.url},null,8,["url"])])}var l=n(18933),r=n(61957),d=n(86970);const u={class:"w-full ml-2"},c={class:"text-bold"};function p(e,t,n,i,o,a){const l=(0,s.up)("q-btn"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(p,{class:"cursor-pointer flex row justify-start items-center",flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{rounded:"",flat:"",color:"primary",size:"md",icon:n.url in e.$store.state.relays?"check":"add",label:n.url in e.$store.state.relays?"added":"add relay",disable:n.url in e.$store.state.relays,onClick:(0,r.iM)(a.addRelay,["stop"])},null,8,["icon","label","disable","onClick"]),(0,s._)("div",c,(0,d.zw)(a.cleanUrl),1)])),_:1})])}var h=n(88995);const g={name:"BaseRelayCard",props:{url:{type:String,required:!0}},computed:{cleanUrl(){return h.sanitize(this.url)}},methods:{addRelay(){this.$q.dialog({title:"Add relay?",message:`Add ${this.url} to your list of relays?`,cancel:{color:"accent"},ok:{color:"accent"}}).onOk((()=>{this.$store.commit("addRelay",this.url)}))}}};var m=n(11639),y=n(44458),f=n(24455),w=n(69984),v=n.n(w);const b=(0,m.Z)(g,[["render",p],["__scopeId","data-v-7551053b"]]),k=b;v()(g,"components",{QCard:y.Z,QBtn:f.Z});const x={name:"BaseRelayRecommend",mixins:[l.Z],components:{BaseRelayCard:k},props:{url:{type:String,required:!0},listView:{type:Boolean,default:!1}}},C=(0,m.Z)(x,[["render",a]]),M=C},16842:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});n(40702);var s=n(59835),i=n(86970),o=n(61957);const a={style:{cursor:"pointer","padding-left":".2rem"},class:"relative-position"},l={class:"q-pl-sm"},r={key:0,class:"base-select-list",style:{position:"absolute",top:"1.3rem","z-index":"1","max-height":"15rem","overflow-y":"auto",width:"100%"}},d={class:"",style:{display:"block","margin-block-start":".5rem","margin-block-end":".5rem","padding-inline-start":".5rem"}};function u(e,t,n,u,c,p){const h=(0,s.up)("q-icon");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",{class:"flex justify-between base-select no-wrap items-center",style:(0,i.j5)([{"border-radius":".5rem"},e.allowSelection?"cursor: pointer; opacity: 1;":"cursor: not-allowed; opacity: .5;"]),onClick:t[0]||(t[0]=(0,o.iM)(((...t)=>e.toggle&&e.toggle(...t)),["stop"]))},[(0,s._)("span",l,[(0,s.WI)(e.$slots,"default",{},void 0,!0)]),(0,s.Wm)(h,{name:e.selecting?"arrow_drop_up":"arrow_drop_down",size:"xs"},null,8,["name"])],4),e.selecting&&e.allowSelection?((0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("ul",d,[(0,s.WI)(e.$slots,"list-items",{},void 0,!0)])])):(0,s.kq)("",!0)])}const c=(0,s.aZ)({name:"BaseSelect",emits:["toggle"],props:{allowSelection:{type:Boolean,default:!0},selecting:{type:Boolean,default:!1}},methods:{toggle(){this.allowSelection&&this.$emit("toggle")}}});var p=n(11639),h=n(22857),g=n(69984),m=n.n(g);const y=(0,p.Z)(c,[["render",u],["__scopeId","data-v-3a4ec8e7"]]),f=y;m()(c,"components",{QIcon:h.Z})},35749:(e,t,n)=>{"use strict";n.d(t,{Z:()=>L});var s=n(59835),i=n(86970),o=n(61957);const a={class:"text-secondary pubkey",style:{opacity:".9","font-size":"95%","font-weight":"300"}};function l(e,t,n,l,r,d){const u=(0,s.up)("BaseUserAvatar"),c=(0,s.up)("BaseUserName"),p=(0,s.up)("BaseMarkdown"),h=(0,s.up)("BaseUserCardActions"),g=(0,s.up)("q-item-section"),m=(0,s.up)("q-item");return(0,s.wg)(),(0,s.j4)(m,{clickable:e.clickable,unelevated:"",outlined:"",class:(0,i.C_)(["no-padding flex row justify-start items-center cursor-pointer",(e.alignRight?"text-right reverse":"text-left")+(e.headerMode?" header-mode":"")+(e.hasTouch||e.headerMode||!e.actionButtons?"":" hidden-action-buttons")]),onClick:t[0]||(t[0]=(0,o.iM)((t=>e.toProfile(e.pubkey)),["stop"])),style:{"max-width":"100%",gap:".5rem"}},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(u,{pubkey:e.pubkey,"align-right":e.alignRight,size:e.headerMode?"10rem":"lg",class:(0,i.C_)(e.headerMode?"self-center":"")},null,8,["pubkey","align-right","size","class"])]),(0,s.Wm)(g,{class:(0,i.C_)(e.headerMode?"self-start":""),style:(0,i.j5)(e.headerMode?"":"white-space: nowrap; overflow: auto;")},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{pubkey:e.pubkey,"header-mode":e.headerMode,"show-verified":!0,class:(0,i.C_)(e.headerMode?" text-h6":""),"align-right":e.alignRight,"show-following":e.showFollowing,wrap:e.wrap},null,8,["pubkey","header-mode","class","align-right","show-following","wrap"]),(0,s._)("div",a,(0,i.zw)(e.shorten(e.npubKey)),1),e.headerMode?((0,s.wg)(),(0,s.j4)(p,{key:0,content:e.$store.getters.profileDescription(e.pubkey)},null,8,["content"])):(0,s.kq)("",!0),e.actionButtons?((0,s.wg)(),(0,s.j4)(h,{key:1,pubkey:e.pubkey,class:"action-buttons"},null,8,["pubkey"])):(0,s.kq)("",!0)])),_:1},8,["class","style"])])),_:1},8,["clickable","class"])}var r=n(19302),d=n(18933);n(40702);function u(e,t,n,a,l,r){const d=(0,s.up)("BaseButtonCopy"),u=(0,s.up)("BaseButtonMessage"),c=(0,s.up)("BaseButtonFollow"),p=(0,s.up)("BaseButtonLightning");return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["flex row no-wrap",e.buttonGroupClass]),style:{gap:".3rem"}},[(0,s.Wm)(d,{"button-text":e.npubKey,"button-size":"sm","text-color":"secondary","tooltip-text":"copy pubkey",onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["button-text"]),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(u,{key:0,"button-to":"/messages/"+e.npubKey,"button-size":"sm","text-color":"primary",onClick:t[1]||(t[1]=(0,o.iM)((()=>{}),["stop"]))},null,8,["button-to"])):(0,s.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(c,{key:1,pubkey:e.pubkey,"button-size":"sm",onClick:t[2]||(t[2]=(0,o.iM)((()=>{}),["stop"]))},null,8,["pubkey"])):(0,s.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.getters.profileLud06(e.pubkey)?((0,s.wg)(),(0,s.j4)(p,{key:2,pubkey:e.pubkey},null,8,["pubkey"])):(0,s.kq)("",!0)],2)}const c=(0,s.Uk)(" encrypted message ");function p(e,t,n,a,l,r){const d=(0,s.up)("q-tooltip"),u=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(u,{icon:"mail_lock",unelevated:"",clickable:"",class:(0,i.C_)([e.buttonClass,"button-message"]),size:e.buttonSize,to:e.buttonTo,onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"])),dense:""},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[c])),_:1})])),_:1},8,["class","size","to"])}const h=(0,s.aZ)({name:"BaseButtonMessage",props:{buttonTo:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},methods:{copy(){console.log(this.buttonText),navigator.clipboard.writeText(this.buttonText)}}});var g=n(11639),m=n(24455),y=n(46858),f=n(69984),w=n.n(f);const v=(0,g.Z)(h,[["render",p]]),b=v;function k(e,t,n,a,l,r){const d=(0,s.up)("q-icon"),u=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(c,{class:(0,i.C_)(e.buttonClass+(e.isFollowing?"button-unfollow":"button-follow")),size:e.buttonSize,unelevated:"","text-color":e.isFollowing?"":"secondary",dense:"",onClick:(0,o.iM)(e.toggleFollowing,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:e.isFollowing?"person_remove":"person_add",class:(0,i.C_)(e.isFollowing?"flip-horizontal":"")},null,8,["name","class"]),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.isFollowing?"unfollow":"follow"),1)])),_:1})])),_:1},8,["class","size","text-color","onClick"])}w()(h,"components",{QBtn:m.Z,QTooltip:y.Z});n(46727);const x=(0,s.aZ)({name:"BaseButtonFollow",props:{pubkey:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},computed:{isFollowing(){return this.$store.state.follows.includes(this.pubkey)}},methods:{toggleFollowing(){this.isFollowing?this.unfollow():this.follow()},unfollow(){this.$store.commit("unfollow",this.pubkey)},follow(){this.$store.commit("follow",this.pubkey)}}});var C=n(22857);const M=(0,g.Z)(x,[["render",k],["__scopeId","data-v-ebf5b4b0"]]),_=M;w()(x,"components",{QBtn:m.Z,QIcon:C.Z,QTooltip:y.Z});var q=n(45032),T=n(78414);const B=(0,s.aZ)({name:"BaseUserCardActions",mixins:[d.Z],props:{pubkey:{type:String,required:!0},buttonGroupClass:{type:String,required:!1,default:""}},components:{BaseButtonMessage:b,BaseButtonFollow:_,BaseButtonCopy:q.Z,BaseButtonLightning:T.Z},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}}),S=(0,g.Z)(B,[["render",u]]),z=S;var Z=n(50105);const W=(0,s.aZ)({name:"BaseUserCard",components:{BaseUserCardActions:z,BaseMarkdown:Z.Z},mixins:[d.Z],props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,required:!1,default:!1},clickable:{type:Boolean,required:!1,default:!0},headerMode:{type:Boolean,required:!1,default:!1},actionButtons:{type:Boolean,required:!1,default:!0},showFollowing:{type:Boolean,default:!1},wrap:{type:Boolean,default:!1}},setup(){const e=(0,r.Z)();let t=(null===e||void 0===e?void 0:e.platform.has.touch)||!1;return{hasTouch:t}},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}});var $=n(490),j=n(76749);const D=(0,g.Z)(W,[["render",l],["__scopeId","data-v-2f861818"]]),L=D;w()(W,"components",{QItem:$.Z,QItemSection:j.Z})},69159:()=>{},46601:()=>{},89214:()=>{}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,(()=>{var e=[];n.O=(t,s,i,o)=>{if(!s){var a=1/0;for(u=0;u<e.length;u++){for(var[s,i,o]=e[u],l=!0,r=0;r<s.length;r++)(!1&o||a>=o)&&Object.keys(n.O).every((e=>n.O[e](s[r])))?s.splice(r--,1):(l=!1,o<a&&(a=o));if(l){e.splice(u--,1);var d=i();void 0!==d&&(t=d)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,i,o]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"===typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"===typeof s.then)return s}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var l=2&i&&s;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>a[e]=()=>s[e]));return a["default"]=()=>s,n.d(o,a),o}})(),(()=>{n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,s)=>(n.f[s](e,t),t)),[]))})(),(()=>{n.u=e=>"js/"+(443===e?"about":e)+"."+{61:"43a24e37",101:"0f9ee849",389:"335a1956",430:"c053e8f0",431:"884277b5",443:"9f94f986",499:"a3bbcda2",506:"481ef41f",669:"73a702eb",721:"36ff66c0",734:"fe59e2f2",782:"50ecc0d0",980:"c5ce96d1"}[e]+".js"})(),(()=>{n.miniCssF=e=>"css/"+({143:"app",443:"about",736:"vendor"}[e]||e)+"."+{61:"f5c9dbbb",101:"78d74b0a",143:"fe0a1e65",389:"30b31f11",431:"ef3a97bf",443:"e5e1a81f",499:"b5ea16dd",721:"042f7f90",736:"459d2a15",980:"cf1f7b5e"}[e]+".css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="astral:";n.l=(s,i,o,a)=>{if(e[s])e[s].push(i);else{var l,r;if(void 0!==o)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==s||c.getAttribute("data-webpack")==t+o){l=c;break}}l||(r=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.setAttribute("data-webpack",t+o),l.src=s),e[s]=[i];var p=(t,n)=>{l.onerror=l.onload=null,clearTimeout(h);var i=e[s];if(delete e[s],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((e=>e(n))),t)return t(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),r&&document.head.appendChild(l)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{n.j=143})(),(()=>{n.p="/"})(),(()=>{var e=(e,t,n,s)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var o=o=>{if(i.onerror=i.onload=null,"load"===o.type)n();else{var a=o&&("load"===o.type?"missing":o.type),l=o&&o.target&&o.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+l+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=a,r.request=l,i.parentNode.removeChild(i),s(r)}};return i.onerror=i.onload=o,i.href=t,document.head.appendChild(i),i},t=(e,t)=>{for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var i=n[s],o=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(o===e||o===t))return i}var a=document.getElementsByTagName("style");for(s=0;s<a.length;s++){i=a[s],o=i.getAttribute("data-href");if(o===e||o===t)return i}},s=s=>new Promise(((i,o)=>{var a=n.miniCssF(s),l=n.p+a;if(t(a,l))return i();e(s,l,i,o)})),i={143:0};n.f.miniCss=(e,t)=>{var n={61:1,101:1,389:1,431:1,443:1,499:1,721:1,980:1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=s(e).then((()=>{i[e]=0}),(t=>{throw delete i[e],t})))}})(),(()=>{n.b=document.baseURI||self.location.href;var e={143:0};n.f.j=(t,s)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)s.push(i[2]);else{var o=new Promise(((n,s)=>i=e[t]=[n,s]));s.push(i[2]=o);var a=n.p+n.u(t),l=new Error,r=s=>{if(n.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var o=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",l.name="ChunkLoadError",l.type=o,l.request=a,i[1](l)}};n.l(a,r,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,s)=>{var i,o,[a,l,r]=s,d=0;if(a.some((t=>0!==e[t]))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(r)var u=r(n)}for(t&&t(s);d<a.length;d++)o=a[d],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},s=globalThis["webpackChunkastral"]=globalThis["webpackChunkastral"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=n.O(void 0,[736,64],(()=>n(84647)));s=n.O(s)})();
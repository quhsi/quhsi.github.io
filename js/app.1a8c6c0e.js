(()=>{var e={84647:(e,t,n)=>{"use strict";n(18964),n(40702);var s=n(61957),o=n(71947),i=n(60499),a=n(59835);function r(e,t,n,s,o,i){const r=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(r)}const l=(0,a.aZ)({name:"App"});var d=n(11639);const u=(0,d.Z)(l,[["render",r]]),c=u;var p=n(54927),h=n(23340),y=n(28339);const m=[{path:"/",component:()=>Promise.all([n.e(736),n.e(64),n.e(227)]).then(n.bind(n,12917)),children:[{path:"",component:()=>Promise.all([n.e(736),n.e(64),n.e(443)]).then(n.bind(n,29443)),name:"feed"},{path:"/follow",component:()=>Promise.all([n.e(736),n.e(64),n.e(61)]).then(n.bind(n,24384)),name:"follow"},{path:"/settings/:initUser?",component:()=>Promise.all([n.e(736),n.e(64),n.e(928)]).then(n.bind(n,20467)),name:"settings"},{path:"/messages/inbox",component:()=>Promise.all([n.e(736),n.e(669)]).then(n.bind(n,38669)),name:"inbox"},{path:"/messages/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(255)]).then(n.bind(n,4255)),name:"messages"},{path:"/:eventId(note[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(64),n.e(782)]).then(n.bind(n,92782)),name:"event"},{path:"/notifications",component:()=>Promise.all([n.e(736),n.e(64),n.e(431)]).then(n.bind(n,1938)),name:"notifications"},{path:"/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([n.e(736),n.e(64),n.e(365)]).then(n.bind(n,59689)),name:"profile"},{path:"/hashtag/:hashtagId([a-zA-Z0-9_]{1,63})",component:()=>Promise.all([n.e(736),n.e(64),n.e(430)]).then(n.bind(n,82430)),name:"hashtag"},{path:"/devTools",component:()=>Promise.all([n.e(736),n.e(101)]).then(n.bind(n,98101)),name:"devTools"},{path:"/:catchAll(.*)*",component:()=>Promise.all([n.e(736),n.e(506)]).then(n.bind(n,29506))}]}],f=m,g=(0,h.BC)((()=>{const e=y.PO,t=(0,y.p7)({routes:f,history:e("/")});return t}));async function v(e,t){const s=e(c);s.use(o.Z,t);const a="function"===typeof p["default"]?await(0,p["default"])({}):p["default"],{storeKey:r}=await Promise.resolve().then(n.bind(n,54927)),l=(0,i.Xl)("function"===typeof g?await g({store:a}):g);return a.$router=l,{app:s,store:a,storeKey:r,router:l}}var w=n(6827),b=n(97286),k=n(79231);const x={config:{dark:!0,notify:{closeBtn:!0}},plugins:{Notify:w.Z,Dialog:b.Z,Meta:k.ZP}},M="/";async function C({app:e,router:t,store:n,storeKey:s},o){let i=!1;const a=e=>{try{return t.resolve(e).href}catch(n){}return Object(e)===e?null:e},r=e=>{if(i=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=a(e);null!==t&&(window.location.href=t)},l=window.location.href.replace(window.location.origin,"");for(let u=0;!1===i&&u<o.length;u++)try{await o[u]({app:e,router:t,store:n,ssrContext:null,redirect:r,urlPath:l,publicPath:M})}catch(d){return d&&d.url?void r(d.url):void console.error("[Quasar] boot error:",d)}!0!==i&&(e.use(t),e.use(n,s),e.mount("#q-app"))}v(s.ri,x).then((e=>Promise.all([Promise.resolve().then(n.bind(n,92727)),Promise.resolve().then(n.bind(n,55635))]).then((t=>{const n=t.map((e=>e.default)).filter((e=>"function"===typeof e));C(e,n)}))))},92727:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>en});n(40702);var s=n(59835),o=n(86970),i=n(61957);const a=e=>((0,s.dD)("data-v-1b39a40a"),e=e(),(0,s.Cn)(),e),r={clickable:"",avatar:"",top:"",class:"relative-position"},l={key:0,class:"is-reply-connector"},d={key:1,class:"has-reply-connector"},u={class:"flex column no-wrap col full-width"},c={class:"q-pb-xs"},p=a((()=>(0,s._)("span",null,"in reply to ",-1))),h={key:2},y={key:3,class:"reposts flex column q-pr-md",clickable:!1},m=["color"],f={class:"text-primary text-thin col q-pl-xs",style:{"font-size":"90%","font-weight":"300"}},g={class:"flex row no-wrap"},v=(0,s.Uk)(" embed "),w=(0,s.Uk)(" repost "),b=(0,s.Uk)(" quote "),k=(0,s.Uk)(" reply "),x={class:"flex row no-wrap items-center"},M=(0,s.Uk)(" cancel "),C={key:5,style:{"min-height":"1rem"}},_=a((()=>(0,s._)("span",{class:"text-caption"}," copy the formatted event ID below and paste it in any post to embed this event ",-1))),q=a((()=>(0,s._)("br",null,null,-1))),T={class:"text-primary",style:{"word-break":"break-all"}},B={key:1,class:"full-width"},z={key:2,style:{"min-height":".5rem"}};function S(e,t,n,a,S,Z){const R=(0,s.up)("BaseUserAvatar"),$=(0,s.up)("q-item-label"),j=(0,s.up)("BaseButtonRelays"),E=(0,s.up)("BaseButtonInfo"),D=(0,s.up)("q-space"),P=(0,s.up)("BaseUserName"),W=(0,s.up)("BaseMarkdown"),U=(0,s.up)("BaseRelayRecommend"),L=(0,s.up)("BasePost",!0),N=(0,s.up)("q-tooltip"),I=(0,s.up)("q-icon"),F=(0,s.up)("q-tab"),O=(0,s.up)("q-tabs"),H=(0,s.up)("q-separator"),Q=(0,s.up)("q-btn"),A=(0,s.up)("q-item-section"),V=(0,s.up)("BaseButtonCopy"),J=(0,s.up)("q-tab-panel"),K=(0,s.up)("BasePostEntry"),Y=(0,s.up)("q-tab-panels"),X=(0,s.up)("BasePostThread");return(0,s.wg)(),(0,s.iD)("div",{color:"accent",class:(0,o.C_)(["post-padding cursor-pointer no-hover flex row no-wrap",(e.hasReply?"post-has-reply":"")+(e.isReply?" post-is-reply":"")+(e.highlighted?" post-highlighted":"")+(e.isChildReply?" post-is-child-reply":"")+(e.hasReplyChildren?" post-has-child-reply":"")]),clickable:"","manual-focus":"",onClick:t[14]||(t[14]=(0,i.iM)((t=>e.toEvent(e.event.id)),["stop"]))},[(0,s._)("div",r,[e.isReply?((0,s.wg)(),(0,s.iD)("div",l)):(0,s.kq)("",!0),(0,s.Wm)(R,{pubkey:e.event.pubkey,size:"1.5rem",round:!0,bordered:e.hasReply||e.isReply||e.hasReplyChildren||e.isChildReply,"hover-effect":!0,style:{"z-index":"1"}},null,8,["pubkey","bordered"]),e.hasReply?((0,s.wg)(),(0,s.iD)("div",d)):(0,s.kq)("",!0),"reply"===e.replyMode?((0,s.wg)(),(0,s.iD)("div",{key:2,class:"has-replying-connector",style:(0,o.j5)("height: "+e.postHeight+"px;")},null,4)):(0,s.kq)("",!0),e.hasReplyChildren?((0,s.wg)(),(0,s.iD)("div",{key:3,ref:"hasChildReplyConnector",class:"has-child-reply-connector",style:(0,o.j5)([{visibility:"hidden"},e.childReplyConnectorStyle()])},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.event.replies,((t,n)=>((0,s.wg)(),(0,s.iD)("div",{key:t[0].id,ref_for:!0,ref:"hasChildReplyConnectorTick",class:"has-child-reply-tick",style:(0,o.j5)(e.childReplyTickStyle(n))},null,4)))),128))],4)):(0,s.kq)("",!0)]),(0,s._)("div",u,[(0,s.Wm)(A,{ref:"postContent",class:"relative-position",style:{padding:"0 .2rem"}},{default:(0,s.w5)((()=>[(0,s._)("div",{class:"absolute-top-right flex row items-center post-info",style:{"z-index":"1"},onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"]))},[(0,s.Wm)($,{class:"q-pr-xs",style:{opacity:".8","font-size":"90%"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.niceDate(e.event.created_at)),1)])),_:1}),(0,s.Wm)(j,{"button-class":"text-secondary",event:e.event},null,8,["event"]),(0,s.Wm)(E,{"button-class":"text-secondary",event:e.event},null,8,["event"])]),(0,s._)("div",c,[(0,s.Wm)($,{caption:"",class:"text-secondary",style:{opacity:".7"}},{default:(0,s.w5)((()=>[(0,s._)("span",{onClick:t[1]||(t[1]=(0,i.iM)((t=>e.toProfile(e.event.pubkey)),["stop"]))},(0,o.zw)(e.shorten(e.hexToBech32(e.event.pubkey,"npub"))),1)])),_:1}),(0,s.Wm)(D),(0,s.Wm)($,{line:1,clickable:""},{default:(0,s.w5)((()=>[(0,s.Wm)(P,{pubkey:e.event.pubkey,"show-verified":!0,class:"text-bold","show-following":!0},null,8,["pubkey"])])),_:1}),!e.tagged||"event"==e.$route.name||e.isReply||e.isChildReply?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)($,{key:0,class:"q-pl-sm",style:{"font-size":".9rem"}},{default:(0,s.w5)((()=>[p,(0,s._)("a",{onClick:t[2]||(t[2]=(0,i.iM)((t=>e.toEvent(e.tagged)),["stop"]))},(0,o.zw)(e.shorten(e.hexToBech32(e.tagged,"note"))),1)])),_:1}))]),1===e.event.kind?((0,s.wg)(),(0,s.j4)(W,{key:0,content:e.event.interpolated.text,"long-form":e.isLongForm,onExpand:t[3]||(t[3]=t=>e.isLongForm=!e.isLongForm),onResized:t[4]||(t[4]=t=>e.calcConnectorValues(10))},null,8,["content","long-form"])):2===e.event.kind?((0,s.wg)(),(0,s.j4)(U,{key:1,url:e.sanitize(e.event.content)},null,8,["url"])):((0,s.wg)(),(0,s.iD)("pre",h," "+(0,o.zw)(e.cleanEvent)+" ",1)),e.isEmbeded||!e.isQuote&&!e.isRepost?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.reposts,((n,o)=>((0,s.wg)(),(0,s.j4)(L,{key:n.id+"_"+e.reposts.length+"_"+o,event:n,"manual-focus":!1,"is-embeded":!0,onClick:(0,i.iM)((t=>e.toEvent(n.id)),["stop"]),onResized:t[5]||(t[5]=t=>e.calcConnectorValues(10))},null,8,["event","onClick"])))),128))])),!e.isRepost&&e.$store.state.keys.pub&&-1!==e.replyDepth?((0,s.wg)(),(0,s.iD)("div",{key:4,class:(0,o.C_)(["flex row items-center no-wrap reply-buttons",e.replying?"justify-between":"justify-end"]),color:e.replying?"primary":""},[(0,s._)("div",f,(0,o.zw)(e.replyMode),1),(0,s._)("div",g,[(0,s.Wm)(O,{modelValue:e.replyMode,"onUpdate:modelValue":t[6]||(t[6]=t=>e.replyMode=t),class:"no-padding no-margin",unelevated:"",dense:"",flat:"","active-color":"primary",size:e.highlighted?"md":"sm",onClick:t[7]||(t[7]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{name:"embed",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{name:"link"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[v])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{name:"repost",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{name:"repeat"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[w])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{name:"quote",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{name:"format_quote"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[b])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{name:"reply",class:"no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{name:"chat_bubble_outline",class:"flip-horizontal"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[k])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","size"]),(0,s._)("div",x,[e.replyMode?((0,s.wg)(),(0,s.j4)(H,{key:0,color:"primary",size:"1px",vertical:"",spaced:"",class:(0,o.C_)(e.highlighted?"q-mt-sm":"q-mt-xs")},null,8,["class"])):(0,s.kq)("",!0),e.replyMode?((0,s.wg)(),(0,s.j4)(Q,{key:1,icon:"close",color:"primary",flat:"",dense:"",onClick:t[8]||(t[8]=(0,i.iM)((t=>e.replyMode=null),["stop"])),size:e.highlighted?"md":"sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[M])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0)])])],10,m)):((0,s.wg)(),(0,s.iD)("div",C))])),_:1},512),e.replyMode?((0,s.wg)(),(0,s.j4)(A,{key:0,class:"new-reply-box",ref:"replyContent"},{default:(0,s.w5)((()=>[(0,s.Wm)(Y,{modelValue:e.replyPanel,"onUpdate:modelValue":t[11]||(t[11]=t=>e.replyPanel=t),class:"no-padding full-width overflow-hidden",style:{"background-color":"inherit","max-width":"100%",padding:"0 .25 0 0"},onTransition:t[12]||(t[12]=t=>e.calcConnectorValues(10))},{default:(0,s.w5)((()=>[(0,s.Wm)(J,{name:"embed",class:"no-padding",onClick:t[9]||(t[9]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[_,(0,s.Wm)(V,{"button-text":e.hexToBech32(e.event.id,"note"),color:"primary",flat:"","tooltip-text":"copy event ID"},null,8,["button-text"]),q,(0,s._)("span",T,(0,o.zw)(e.hexToBech32(e.event.id,"note")),1)])),_:1}),(0,s.Wm)(J,{name:"reply",class:"q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(K,{event:e.event,"reply-mode":e.replyMode,onSent:e.replySent,onResized:t[10]||(t[10]=t=>e.calcConnectorValues(10))},null,8,["event","reply-mode","onSent"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,s.kq)("",!0),e.hasReplyChildren&&-1!==e.replyDepth?((0,s.wg)(),(0,s.iD)("div",B,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.event.replies,(n=>((0,s.wg)(),(0,s.iD)("div",{key:n[0].id,ref_for:!0,ref:"childReplyContent"},[(0,s.Wm)(X,{events:n,"reply-depth":e.replyDepth+1,onResized:t[13]||(t[13]=t=>e.calcConnectorValues(10)),onAddEvent:e.addEvent},null,8,["events","reply-depth","onAddEvent"])])))),128))])):(0,s.kq)("",!0),e.isRepost?((0,s.wg)(),(0,s.iD)("div",z)):(0,s.kq)("",!0)])],2)}var Z=n(22330),R=n(18933),$=n(73270),j=n(39057),E=n(80559),D=n(45317),P=n(76877),W=n(88995);const U=(0,s.aZ)({name:"BasePost",emits:["resized","add-event","mounted"],mixins:[R.Z],props:{event:{type:Object,required:!0},highlighted:{type:Boolean,default:!1},position:{type:String,default:"standalone"},replyDepth:{type:Number,default:0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:$.Z,BaseButtonInfo:j.Z,BaseButtonCopy:E.Z,BaseMarkdown:D.Z,BaseRelayRecommend:P.Z},data(){return{clicking:!1,replying:!1,childReplyHeights:[],postHeight:0,replyHeight:0,reposts:[],eventSub:null,replyMode:"",resizing:!1,trigger:1,isLongForm:!1}},computed:{tagged(){var e;let t=null===(e=this.event.interpolated)||void 0===e?void 0:e.replyEvents;return null!==t&&void 0!==t&&t.length?t[t.length-1]:null},isRepost(){var e;return""===(null===(e=this.event.interpolated)||void 0===e?void 0:e.text)&&this.event.interpolated.mentionEvents.length},isQuote(){var e;return(null===(e=this.event.interpolated)||void 0===e?void 0:e.text)&&this.event.interpolated.mentionEvents.length},mentionEvents(){var e;return null===(e=this.event.interpolated)||void 0===e?void 0:e.mentionEvents},isReply(){return"middle"===this.position||"last"===this.position},hasReply(){return"middle"===this.position||"first"===this.position},isChildReply(){return!!this.replyDepth},hasReplyChildren(){return!!(this.event.replies&&this.event.replies.length>0)},postContentWidth(){var e,t,n,s;return this.resizing?null===(e=this.$refs.postContent)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth:null===(n=this.$refs.postContent)||void 0===n||null===(s=n.$el)||void 0===s?void 0:s.clientWidth},postContentHeight(){var e,t,n,s;return this.resizing?null===(e=this.$refs.postContent)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientHeight:null===(n=this.$refs.postContent)||void 0===n||null===(s=n.$el)||void 0===s?void 0:s.clientHeight},replyContentHeight(){var e,t,n,s,o;return this.replyMode&&this.resizing&&null!==(e=this.$refs.replyContent)&&void 0!==e&&e.$el?null===(t=this.$refs.replyContent)||void 0===t||null===(n=t.$el)||void 0===n?void 0:n.clientHeight:(null===(s=this.$refs.replyContent)||void 0===s||null===(o=s.$el)||void 0===o?void 0:o.clientHeight)||0},replyPanel(){return"embed"===this.replyMode?"embed":this.replyMode?"reply":""},cleanEvent(){return this.sanitize(JSON.stringify((0,Z.CX)(this.event),null,2))}},mounted(){this.isEmbeded||!this.isQuote&&!this.isRepost||(Array.isArray(this.reposts)||(this.reposts=[]),this.processTaggedEvents(this.mentionEvents,this.reposts)),this.calcConnectorValues(),this.$emit("mounted"),this.isLongForm=this.event.content.length>600},activated(){this.calcConnectorValues(),this.trigger++},deactivated(){if(this.reposts.length)for(let e of this.reposts)this.$store.dispatch("cancelUseProfile",{pubkey:e.pubkey})},methods:{childReplyConnectorStyle(){var e;if(null!==(e=this.childReplyHeights)&&void 0!==e&&e.length){let e=this.postHeight+this.childReplyHeights.slice(0,-1).reduce(((e,t)=>e+t),0);return this.replyHeight&&(e+=this.replyHeight),"visibility: visible; height: "+e+"px"}return""},childReplyTickStyle(e){var t;if(null!==(t=this.childReplyHeights)&&void 0!==t&&t.length){let t=this.postHeight+this.childReplyHeights.filter(((t,n)=>n<e)).reduce(((e,t)=>e+t),0);return this.replyHeight&&(t+=this.replyHeight),"visibility: visible; top: "+t+"px"}return""},calcConnectorValues(e=2e3){this.resizing=!this.resizing,(0,s.Y3)((()=>{setTimeout((()=>{var e;(this.postHeight=this.postContentHeight,this.replyHeight=this.replyContentHeight,this.hasReplyChildren)&&(this.childReplyHeights=null===(e=this.$refs.childReplyContent)||void 0===e?void 0:e.map((e=>e.clientHeight)));this.$emit("resized")}),e)}))},toggleReplying(){""===this.replyMode?(this.replying=!0,this.replyMode="reply"):(this.replyMode="",this.replying=!1),this.calcConnectorValues(10)},replySent(e){this.replying=!1,this.replyMode="",this.$emit("add-event",e)},niceDate(e){return this.trigger,this.niceDateUTC(e)},addEvent(e){console.log("post reply threads add-event",e),this.$emit("add-event",e)},sanitize(e){return W.sanitize(e)}}});var L=n(11639),N=n(76749),I=n(33115),F=n(90136),O=n(47817),H=n(70900),Q=n(22857),A=n(46858),V=n(50926),J=n(24455),K=n(89800),Y=n(84106),X=n(69984),G=n.n(X);const ee=(0,L.Z)(U,[["render",S],["__scopeId","data-v-1b39a40a"]]),te=ee;G()(U,"components",{QItemSection:N.Z,QItemLabel:I.Z,QSpace:F.Z,QTabs:O.Z,QTab:H.Z,QIcon:Q.Z,QTooltip:A.Z,QSeparator:V.Z,QBtn:J.Z,QTabPanels:K.Z,QTabPanel:Y.Z});const ne={key:0,class:"text-bold flex row no-wrap items-center",style:{gap:".2rem"},clickable:""},se=(0,s.Uk)(" following "),oe={class:"flex row no-wrap items-center"},ie={key:0,style:{opacity:".9","font-size":"90%","font-weight":"300","line-height":"90%"}};function ae(e,t,n,a,r,l){const d=(0,s.up)("q-tooltip"),u=(0,s.up)("q-icon"),c=(0,s.up)("BaseButtonNIP05");return(0,s.wg)(),(0,s.iD)("div",{class:(0,o.C_)(["cursor-pointer flex",(n.alignRight?" justify-end":" justify-start")+(n.headerMode?" column items-start":" row items-center")+(n.wrap?"":" no-wrap")]),onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(n.pubkey)),["stop"])),style:(0,o.j5)([{gap:".1rem"},n.alignRight?"text-align: right;":"text-align: left"])},[e.$store.getters.name(n.pubkey)?((0,s.wg)(),(0,s.iD)("div",ne,[(0,s.Uk)((0,o.zw)(e.$store.getters.name(n.pubkey))+" ",1),n.showFollowing&&l.isFollow?((0,s.wg)(),(0,s.j4)(u,{key:0,name:"visibility",size:n.headerMode?"sm":"xs",color:"secondary"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[se])),_:1})])),_:1},8,["size"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",oe,[(0,s.Wm)(c,{pubkey:n.pubkey,"button-size":n.headerMode?"sm":"xs"},null,8,["pubkey","button-size"]),e.$store.getters.NIP05Id(n.pubkey)?((0,s.wg)(),(0,s.iD)("div",ie,(0,o.zw)(l.niceNIP05),1)):(0,s.kq)("",!0)])],6)}n(46727);const re={class:"flex row justify-end"},le={class:"overflow-auto"},de={class:"text-subtitle1 flex row overflow-auto items-end q-gutter-sm"},ue=(0,s.Uk)(" NIP05 identifier "),ce=["href"],pe={key:0},he=(0,s._)("div",null,[(0,s.Uk)("learn how to get NIP05 verified "),(0,s._)("a",{href:"https://gist.github.com/metasikander/609a538e6a03b2f67e5c8de625baed3e",target:"_"},"here")],-1),ye=(0,s.Uk)(" NIP05 verified ");function me(e,t,n,a,r,l){const d=(0,s.up)("q-btn"),u=(0,s.up)("q-spinner-orbit"),c=(0,s.up)("q-inner-loading"),p=(0,s.up)("q-card-section"),h=(0,s.up)("q-card"),y=(0,s.up)("q-dialog"),m=(0,s.up)("q-tooltip"),f=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(y,{modelValue:r.NIP05Dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>r.NIP05Dialog=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,s.w5)((()=>[(0,s._)("div",re,[(0,s.wy)((0,s.Wm)(d,{icon:"close",flat:"",dense:""},null,512),[[f]])]),(0,s._)("div",le,[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",de,[ue,(0,s._)("a",{href:l.NIP05Link,target:"_"},(0,o.zw)(l.NIP05Link),9,ce)]),l.NIP05Loaded?((0,s.wg)(),(0,s.iD)("pre",pe,(0,o.zw)(l.NIP05Formatted),1)):(0,s.kq)("",!0),(0,s.Wm)(c,{showing:!l.NIP05Loaded},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{color:"accent",size:"2rem"})])),_:1},8,["showing"]),he])),_:1})])])),_:1})])),_:1},8,["modelValue"]),e.$store.getters.NIP05Id(n.pubkey)?((0,s.wg)(),(0,s.j4)(d,{key:0,icon:"verified",color:"accent",flat:"",dense:"",size:n.buttonSize,class:"no-padding",clickable:"",onClick:(0,i.iM)(l.openNIP05,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[ye])),_:1})])),_:1},8,["size","onClick"])):(0,s.kq)("",!0)],64)}var fe=n(33688),ge=n.n(fe),ve=n(6827);const we={mixins:[R.Z],props:{pubkey:{type:String,required:!0},buttonSize:{type:String,default:"xs"}},data(){return{NIP05Dialog:!1,NIP05Data:{}}},computed:{NIP05Link(){let[e,t]=this.$store.getters.NIP05Id(this.pubkey).split("@");return t||(t=e,e="_"),`https://${t}/.well-known/nostr.json?name=${e}`},NIP05Formatted(){return this.json(this.NIP05Data)},NIP05Loaded(){return!!Object.keys(this.NIP05Data).length}},methods:{openNIP05(){this.loadNIP05Data(),this.NIP05Dialog=!this.NIP05Dialog},async loadNIP05Data(){try{this.NIP05Data=await(await ge()(this.NIP05Link)).json()}catch(e){ve.Z.create({message:"failed to fetch NIP05 identifier",color:"negative"})}}}};var be=n(87743),ke=n(44458),xe=n(63190),Me=n(60854),Ce=n(10786),_e=n(62146);const qe=(0,L.Z)(we,[["render",me]]),Te=qe;G()(we,"components",{QDialog:be.Z,QCard:ke.Z,QBtn:J.Z,QCardSection:xe.Z,QInnerLoading:Me.Z,QSpinnerOrbit:Ce.Z,QTooltip:A.Z}),G()(we,"directives",{ClosePopup:_e.Z});const Be={mixins:[R.Z],components:{BaseButtonNIP05:Te},props:{pubkey:{type:String,required:!0},wrap:{type:Boolean,default:!1},alignRight:{type:Boolean,default:!1},headerMode:{type:Boolean,default:!1},showFollowing:{type:Boolean,default:!1}},computed:{niceNIP05(){return this.$store.getters.NIP05Id(this.pubkey).split("@").map(((e,t)=>0!==t||"_"!==e&&e!==this.$store.getters.name(this.pubkey)?e:"")).join("@")},isFollow(){return this.$store.state.follows.includes(this.pubkey)}}},ze=(0,L.Z)(Be,[["render",ae]]),Se=ze;G()(Be,"components",{QIcon:Q.Z,QTooltip:A.Z});const Ze=["src"];function Re(e,t,n,a,r,l){const d=(0,s.up)("BaseButtonNIP05"),u=(0,s.up)("q-avatar");return(0,s.wg)(),(0,s.iD)("div",{class:(0,o.C_)((n.bordered?"bordered-avatar":"")+(n.hoverEffect?" hovered-avatar":""))},[(0,s.Wm)(u,{rounded:!n.round,class:"relative-position",size:n.size,onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(n.pubkey)),["stop"]))},{default:(0,s.w5)((()=>[(0,s._)("img",{src:e.$store.getters.avatar(n.pubkey),loading:"lazy",async:""},null,8,Ze),(0,s._)("div",{class:(0,o.C_)([n.alignRight?"icon-right":"icon-left","q-pt-xs"])},[n.showVerified?((0,s.wg)(),(0,s.j4)(d,{key:0,pubkey:n.pubkey,"button-size":"xs"},null,8,["pubkey"])):(0,s.kq)("",!0)],2)])),_:1},8,["rounded","size"])],2)}const $e={mixins:[R.Z],components:{BaseButtonNIP05:Te},props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,default:!1},size:{type:String,default:""},round:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},showVerified:{type:Boolean,default:!1},hoverEffect:{type:Boolean,default:!1}}};var je=n(61357);const Ee=(0,L.Z)($e,[["render",Re],["__scopeId","data-v-43e98880"]]),De=Ee;G()($e,"components",{QAvatar:je.Z});var Pe=n(8072);const We=e=>((0,s.dD)("data-v-1ed8d415"),e=e(),(0,s.Cn)(),e),Ue={key:1,clickable:!1,class:"embeded-message q-px-sm q-py-xs"},Le={class:"relative-position"},Ne={key:0,class:"flex row items-center",style:{gap:".3rem"}},Ie={class:"input-area"},Fe={id:"input-placeholder"},Oe={id:"input-readonly-highlight",contenteditable:"true",spellcheck:"false"},He=["contenteditable"],Qe=We((()=>(0,s._)("div",{id:"input-readonly",contenteditable:"true",spellcheck:"false"},null,-1))),Ae={key:0,class:"absolute-top full-width row justify-center q-my-md"},Ve={style:{"font-size":".9rem"}},Je={key:0,class:"q-pl-xs"},Ke=We((()=>(0,s._)("div",{class:"text-secondary"},"links added",-1))),Ye={dense:"",style:{"font-size":".8rem","font-weight":"300"}},Xe={class:"col-11",style:{"overflow-x":"auto"}},Ge={class:"flex row justify-between"},et=We((()=>(0,s._)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},[(0,s._)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),(0,s._)("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})],-1))),tt=(0,s.Uk)(" add emoji "),nt=(0,s.Uk)(" add link "),st=(0,s.Uk)(" how to mention users and posts "),ot=We((()=>(0,s._)("div",null,[(0,s._)("span",{class:"text-bold"},(0,o.zw)("to mention a user: ")),(0,s.Uk)(" "+(0,o.zw)("type ")+" "),(0,s._)("code",null,(0,o.zw)('"@"')),(0,s.Uk)(" "+(0,o.zw)(" and select user from menu that pops up or paste in npub key"))],-1))),it=We((()=>(0,s._)("span",{class:"text-bold"},(0,o.zw)("to mention a post: "),-1))),at=(0,s.Uk)("paste in note id (you can copy note id from embed "),rt=(0,s.Uk)(' button at the bottom of every post)"'),lt=(0,s.Uk)(" cancel "),dt={key:1,class:"char-left-label"},ut={key:0,class:"over-limit"},ct=(0,s.Uk)(" short form post "),pt=(0,s.Uk)(" long form post ");function ht(e,t,n,a,r,l){const d=(0,s.up)("BasePost"),u=(0,s.up)("q-btn"),c=(0,s.up)("BaseMessage"),p=(0,s.up)("q-list"),h=(0,s.up)("q-icon"),y=(0,s.up)("BaseUserAvatar"),m=(0,s.up)("q-spinner-orbit"),f=(0,s.up)("q-tooltip"),g=(0,s.up)("q-btn-toggle"),v=(0,s.up)("q-separator"),w=(0,s.up)("BaseEmojiPicker"),b=(0,s.up)("q-tab-panel"),k=(0,s.up)("BaseLinkForm"),x=(0,s.up)("q-tab-panels"),M=(0,s.up)("q-item"),C=(0,s.up)("q-circular-progress"),_=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.j4)(M,{unelevated:"",class:"q-pa-none post-entry-form flex coloumn",ref:"postEntry",onClick:t[20]||(t[20]=(0,i.iM)((()=>{}),["stop"])),onMouseup:t[21]||(t[21]=(0,i.iM)((()=>{}),["stop"])),onKeypress:t[22]||(t[22]=(0,i.D2)((0,i.iM)((()=>{}),["stop"]),["enter"])),onKeydown:t[23]||(t[23]=(0,i.iM)((()=>{}),["stop"])),onKeyup:t[24]||(t[24]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>["quote"===n.replyMode||"repost"===n.replyMode?((0,s.wg)(),(0,s.iD)("div",{key:0,class:(0,o.C_)(["reposts flex column q-px-sm q-py-xs","quote"===n.replyMode?"q-mb-sm":""]),clickable:!1},[(0,s.Wm)(d,{event:n.event,clickable:!1,"is-embeded":!0,"reply-depth":-1},null,8,["event"])],2)):(0,s.kq)("",!0),"reply"===n.messageMode&&n.event?((0,s.wg)(),(0,s.iD)("div",Ue,[(0,s._)("div",Le,[(0,s.Wm)(u,{icon:"close",flat:"",dense:"",onClick:t[0]||(t[0]=(0,i.iM)((t=>e.$emit("clear-event")),["stop"])),size:"xs",class:"absolute-top-right z-top"})]),n.event?((0,s.wg)(),(0,s.j4)(c,{key:0,event:n.event,clickable:!1,"is-embeded":!0},null,8,["event"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s.wy)((0,s._)("div",{class:"relative-position full-width",style:{gap:"5px"},onClick:t[9]||(t[9]=(0,i.iM)((()=>{}),["stop"]))},[(0,s.Wm)(p,{id:"tribute-wrapper",class:"overflow-auto flex row z-top",style:{"max-height":"40vh"},onClick:(0,i.iM)(r.focusInput,["stop"])},null,8,["onClick"]),!n.messageMode&&r.replyUserTags.length&&"embed"!==this.replyMode?((0,s.wg)(),(0,s.iD)("div",Ne,[(0,s.Wm)(h,{name:"alternate_email",color:"secondary",size:"sm"}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.replyUserTags,(t=>((0,s.wg)(),(0,s.j4)(u,{key:t,color:"secondary",outline:"",rounded:"",label:e.$store.getters.displayName(t),icon:"close",dense:"",size:"sm",class:"q-pr-sm","no-caps":"",onClick:(0,i.iM)((e=>l.removeReplyUserTag(t)),["stop"])},null,8,["label","onClick"])))),128))])):(0,s.kq)("",!0),(0,s._)("div",Ie,[(0,s.Wm)(y,{pubkey:e.$store.state.keys.pub,class:"avatar-image"},null,8,["pubkey"]),(0,s._)("span",Fe,(0,o.zw)(l.placeholderText),1),(0,s.wy)((0,s._)("div",Oe,null,512),[[i.F8,!r.longForm]]),(0,s._)("div",{id:"input-editable",contenteditable:!r.sending&&!r.mentionsUpdating,style:(0,o.j5)(r.mentionsUpdating?"opacity: .7;":""),onInput:t[1]||(t[1]=(...e)=>l.updateText&&l.updateText(...e)),onKeypress:[t[2]||(t[2]=(0,i.D2)(((...e)=>l.updateText&&l.updateText(...e)),["delete"])),t[5]||(t[5]=(0,i.D2)((0,i.iM)(((...e)=>l.send&&l.send(...e)),["ctrl"]),["enter"]))],onFocus:t[3]||(t[3]=(...e)=>l.textareaFocus&&l.textareaFocus(...e)),onBlur:t[4]||(t[4]=(...e)=>l.textareaBlur&&l.textareaBlur(...e)),onClick:t[6]||(t[6]=(0,i.iM)(((...e)=>l.updateText&&l.updateText(...e)),["stop"])),onTouchstart:t[7]||(t[7]=(0,i.iM)((()=>{}),["stop"])),onMousedown:t[8]||(t[8]=(0,i.iM)((()=>{}),["stop"]))},null,44,He),Qe,r.mentionsUpdating?((0,s.wg)(),(0,s.iD)("div",Ae,[(0,s.Wm)(m,{color:"accent",size:"md"})])):(0,s.kq)("",!0)])],512),[[i.F8,"repost"!==n.replyMode]]),(0,s._)("div",Ve,[r.links.length?((0,s.wg)(),(0,s.iD)("div",Je,[Ke,(0,s._)("ul",Ye,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.links,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:"flex row justify-between no-wrap",dense:""},[(0,s._)("div",Xe,[(0,s._)("strong",null,(0,o.zw)(l.linkName(e)),1),(0,s._)("span",null,(0,o.zw)(e.url),1)]),(0,s.Wm)(u,{icon:"remove_circle",clickable:"",onClick:(0,i.iM)((e=>l.removeLink(t)),["stop"]),flat:"",color:"negative",size:"xs",class:"no-padding"},null,8,["onClick"])])))),128))])])):(0,s.kq)("",!0)]),(0,s._)("div",{class:(0,o.C_)(["flex justify-between",r.toolSelected?"column":"row"]),onClick:t[19]||(t[19]=(0,i.iM)((()=>{}),["stop"]))},[(0,s._)("div",Ge,[(0,s.wy)((0,s.Wm)(g,{modelValue:r.toolSelected,"onUpdate:modelValue":t[13]||(t[13]=e=>r.toolSelected=e),class:(0,o.C_)(["flex",r.toolSelected?"column":"row"]),dense:"",unelevated:"","toggle-color":"","toggle-text-color":"accent",options:[{value:"emoji",slot:"emoji"},{value:"link",slot:"link"},{value:"help",slot:"help"}]},{emoji:(0,s.w5)((()=>[(0,s.Wm)(u,{unelevated:"",class:"no-padding button-emoji",dense:"",size:"sm",onClick:t[10]||(t[10]=(0,i.iM)((e=>l.toggleTool("emoji")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[et])),_:1}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[tt])),_:1})])),_:1})])),link:(0,s.w5)((()=>[(0,s.Wm)(u,{unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[11]||(t[11]=(0,i.iM)((e=>l.toggleTool("link")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"add_link",size:"sm"}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[nt])),_:1})])),_:1})])),help:(0,s.w5)((()=>[(0,s.Wm)(u,{unelevated:"",class:"no-padding button-link",dense:"",size:"sm",onClick:t[12]||(t[12]=(0,i.iM)((e=>l.toggleTool("help")),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"help",size:"xs"}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[st])),_:1})])),_:1})])),_:1},8,["modelValue","class"]),[[i.F8,"repost"!==n.replyMode]]),r.toolSelected?((0,s.wg)(),(0,s.j4)(M,{key:0,class:"col toolbox no-padding",ref:"toolbox"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{vertical:"",color:"accent",size:"1px"}),(0,s.Wm)(x,{modelValue:r.toolSelected,"onUpdate:modelValue":t[17]||(t[17]=e=>r.toolSelected=e),class:"no-padding full-width"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{name:"emoji",class:"no-padding",onClick:t[14]||(t[14]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{onEmojiSelected:l.insertEmoji,"per-line":l.emojiPerRow,class:"full-width"},null,8,["onEmojiSelected","per-line"])])),_:1}),(0,s.Wm)(b,{name:"link",class:"q-pa-xs",onClick:t[15]||(t[15]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{links:r.links,onLinkAdded:l.addLink},null,8,["links","onLinkAdded"])])),_:1}),(0,s.Wm)(b,{name:"help",class:"q-pa-xs",onClick:t[16]||(t[16]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[ot,(0,s._)("div",null,[it,(0,s._)("span",null,[at,(0,s.Wm)(h,{name:"link",size:"sm"}),rt])])])),_:1})])),_:1},8,["modelValue"])])),_:1},512)):(0,s.kq)("",!0)]),(0,s.Wm)(_,{class:"flex items-center",unelevated:""},{default:(0,s.w5)((()=>[r.toolSelected?((0,s.wg)(),(0,s.j4)(u,{key:0,icon:"close",unelevated:"",class:"col button-close",dense:"",onClick:(0,i.iM)(l.closeTools,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[lt])),_:1})])),_:1},8,["onClick"])):(0,s.kq)("",!0),r.text&&!n.messageMode?((0,s.wg)(),(0,s.iD)("div",dt,[l.charLeft()<=0&&!r.longForm?((0,s.wg)(),(0,s.iD)("span",ut,(0,o.zw)(l.charLeft()),1)):(0,s.kq)("",!0),l.charLeft()>0?((0,s.wg)(),(0,s.j4)(C,{key:1,"show-value":l.charLeft()<=25,value:r.text.length%r.charLimit/r.charLimit*100,size:l.charLeft()<=25?"1.5rem":"1.2rem","font-size":".6rem",thickness:l.charLeft()<=25?.2:.1,color:l.charLeft()<=25?"warning":"secondary","track-color":"transparent",class:"no-padding","instant-feedback":""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.charLeft()),1)])),_:1},8,["show-value","value","size","thickness","color"])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),!n.messageMode&&l.charLeft()<=0?((0,s.wg)(),(0,s.j4)(g,{key:2,modelValue:r.longForm,"onUpdate:modelValue":t[18]||(t[18]=e=>r.longForm=e),unelevated:"",dense:"","toggle-color":"primary",style:{border:"1px solid var(--q-primary)"},"text-color":"primary",class:"q-ml-md",options:[{value:!1,slot:"short"},{value:!0,slot:"long"}]},{short:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"short_text",size:"xs",style:(0,o.j5)(r.longForm?"":"color: var(--q-background")},null,8,["style"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[ct])),_:1})])),long:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"format_align_left",size:"xs",style:(0,o.j5)(r.longForm?"color: var(--q-background":"")},null,8,["style"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[pt])),_:1})])),_:1},8,["modelValue"])):(0,s.kq)("",!0),(0,s.Wm)(u,{flat:"",unelevated:"",color:"primary",type:"submit",onClick:(0,i.iM)(l.send,["stop"]),disable:!l.textValid()},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"send",style:(0,o.j5)("transform: translateX("+r.sendIconTranslation+"px);")},null,8,["style"])])),_:1},8,["onClick","disable"])])),_:1})],2)])),_:1},512)}n(38049),n(18964),n(42498);var yt=n(75103),mt=n(26041);function ft(e,t,n,o,a,r){const l=(0,s.up)("Picker");return(0,s.wg)(),(0,s.j4)(l,{data:a.emojiIndex,set:"google","emoji-size":22,"per-line":n.perLine,"show-preview":!1,"show-skin-tomes":!1,onSelect:r.emojiSelected,onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"]))},null,8,["data","per-line","onSelect"])}var gt=n(32859),vt=n(50502);let wt=new vt.xd(gt);const bt={name:"BaseEmojiPicker",emits:["emoji-selected"],props:{perLine:{type:Number,required:!0}},components:{Picker:vt.cW},data(){return{emojiIndex:wt}},methods:{emojiSelected(e){this.$emit("emoji-selected",e)}}},kt=(0,L.Z)(bt,[["render",ft]]),xt=kt;function Mt(e,t,n,o,i,a){const r=(0,s.up)("q-input"),l=(0,s.up)("q-btn"),d=(0,s.up)("q-form");return(0,s.wg)(),(0,s.j4)(d,{onSubmit:t[2]||(t[2]=e=>a.addLink({url:i.url,name:i.name})),class:"no-padding flex row items-center no-wrap justify-between"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{modelValue:i.url,"onUpdate:modelValue":t[0]||(t[0]=e=>i.url=e),type:"url",label:"url",dense:"",outlined:"",autofocus:"",color:"accent",class:"no-padding col-9"},null,8,["modelValue"]),(0,s.Wm)(r,{modelValue:i.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.name=e),label:"url name",disable:0===i.url.length,outlined:"",dense:"",color:"accent",class:"no-padding col-2"},null,8,["modelValue","disable"]),(0,s.Wm)(l,{icon:"add",type:"submit",disable:0===i.url.length,outline:"",round:"",color:"accent",size:"sm",class:"no-padding"},null,8,["disable"])])),_:1})}const Ct={name:"BaseLinkForm",emits:["link-added","link-removed"],props:{links:{type:Array,required:!0}},data(){return{url:"",name:""}},methods:{linkName(e){return e.name?`${e.name}: `:""},addLink(e){0===e.name.length&&delete e.name,this.$emit("link-added",e),this.url="",this.name=""},removeLink(e){this.$emit("link-removed",e)}}};var _t=n(8326),qt=n(66611);const Tt=(0,L.Z)(Ct,[["render",Mt]]),Bt=Tt;G()(Ct,"components",{QForm:_t.Z,QInput:qt.Z,QBtn:J.Z});var zt=n(31244),St=n(34136);const{getPaletteColor:Zt}=yt.ZP,Rt={name:"BasePostEntry",mixins:[R.Z],emits:["sent","resized","clear-event"],components:{BaseEmojiPicker:xt,BaseLinkForm:Bt,BaseMessage:zt.Z},props:{messageMode:{type:String,required:!1,default:""},replyMode:{type:String,required:!1,default:""},event:{type:Object,required:!1,default:null},autoFocus:{type:Boolean,default:!0}},data(){return{text:"",charLimit:280,sending:!1,toolSelected:"",sendIconTranslation:0,tags:[],mentionsUpdating:!1,focusInput(){setTimeout((async()=>{await this.$nextTick(),this.textarea.focus()}),1)},trigger:1,links:[],textareaRange:null,longForm:!1,replyUserTags:[]}},watch:{text(e,t){this.updateMentionsTags()},replyMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())},messageMode(e,t){e!==t&&(this.$emit("resized"),this.focusInput())}},computed:{postEntry(){return this.$refs.postEntry.$el},textarea(){return this.postEntry.querySelector("#input-editable")},readonlyTextarea(){return this.postEntry.querySelector("#input-readonly")},readonlyHighlightTextarea(){return this.postEntry.querySelector("#input-readonly-highlight")},placeholder(){return this.postEntry.querySelector("#input-placeholder")},profileMentionsProvider(){return this.createMentionsProvider()},postEntryWidth(){var e,t;return null===(e=this.$refs.postEntry)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth},toolboxWidth(){var e,t;return this.toolSelected?null===(e=this.$refs.toolbox)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth:0},emojiPerRow(){return this.toolboxWidth?Math.floor((this.toolboxWidth-10)/25):0},label(){if("reply"===this.messageMode)return"what's your reply?";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought?"}return"what's happening?"},placeholderText(){if(this.text.length)return"";if("reply"===this.messageMode)return"reply to message";if(this.messageMode)return"what's your message?";if(this.replyMode){if("reply"===this.replyMode)return"what's your reply?";if("quote"===this.replyMode)return"what's your thought on this?"}return"what's happening?"},textareaMentions(){return this.mentions()},hashtags(){if(0===this.text.length)return[];const e=/(?<s>^|[\s])#(?<i>[\w]{1,63})/g;let t=this.innertext.matchAll(e),n=[];for(let s of t)n.push(s.groups.i.toLowerCase());return n},caretRange(){const e="undefined"!==typeof window.getSelection;if(e&&this.trigger){const e=window.getSelection();if(0!==e.rangeCount){const t=e.getRangeAt(0);return t}}return null},hexPubkey(){return this.$route.params.pubkey?this.bech32ToHex(this.$route.params.pubkey):""}},mounted(){this.messageMode||this.profileMentionsProvider.attach(this.textarea),this.replyMode&&(this.replyUserTags=this.getReplyUserTags()),this.autoFocus&&this.focusInput(),this.$emit("resized")},activated(){},beforeUnmount(){this.messageMode||this.profileMentionsProvider.detach(this.textarea),this.reset(),this.$emit("resized")},methods:{updateText(e){this.trigger++,this.text=this.textarea.textContent,this.innertext=this.textarea.innerText,this.textareaRange=this.caretRange,this.updateReadonlyInput(),this.messageMode||this.updateReadonlyHightlightInput()},async send(){if(!this.textValid())return void console.log("text not valid");if(this.sending)return void console.log("send already in progress");let e;this.toolSelected="",this.sending=!0,this.animateSendIcon(),this.updateText(),await this.extractMentions(this.textarea,this.tags),e=this.replyMode?await this.sendReply():this.messageMode?await this.sendMessage():await this.sendPost(),e&&(this.messageMode||this.interpolateEventMentions(e),this.reset(),this.$emit("sent",e),this.replyMode||this.messageMode||this.toEvent(e.id)),this.sending=!1},async sendPost(){let e=Object.values(this.mentions()).map((e=>e.tag)),t=await this.formatMentionsForPublishing(e);this.appendHashtags(e),t=this.appendLinks(t);let n=await this.$store.dispatch("sendPost",{message:t,tags:e});if(n)return n},async sendReply(){"repost"===this.replyMode&&this.text&&(this.textarea.innerHTML="");let e=[],t=this.textarea.cloneNode(!0);this.replyUserTags.forEach((async t=>e.push(await(0,mt.l_)(t))));let n=this.event.tags.filter((([e,t])=>"e"===e&&t)).map((([...e])=>[...e]));if("quote"===this.replyMode||"repost"===this.replyMode){let n=await(0,mt.wn)(this.event.id,"mention");e.push(n),t.append(` #[${e.length-1}]`)}else{let t=n.find((([e,t,n,s])=>"e"===e&&"root"===s))||n.find((e=>"e"===e[0]&&!e[3]));t||1!==n.filter((([e,t,n,s])=>"e"===e&&"reply"===s)).length||(t=n.find((([e,t,n,s])=>"e"===e&&"reply"===s))),t?(e.push(await(0,mt.wn)(t[1],"root")),e.push(await(0,mt.wn)(this.event.id,"reply"))):e.push(await(0,mt.wn)(this.event.id,"root"))}let s=await this.formatMentionsForPublishing(e,!0,t);return this.appendHashtags(e),s=this.appendLinks(s),(0,St.nY)((0,Z.CX)(this.event)),await this.$store.dispatch("sendPost",{message:s,tags:e})},async sendMessage(){let e=Math.round(Date.now()/1e3),t=[];t.find((([e,t])=>t===this.hexPubkey))||t.push(["p",this.hexPubkey]),this.event&&!t.find((([e,t])=>t===this.event.id))&&t.push(await(0,mt.wn)(this.event.id,"mention"));let n=await this.formatMentionsForPublishing(t,!1);return n=this.appendLinks(n),await this.$store.dispatch("sendChatMessage",{now:e,pubkey:this.hexPubkey,text:n,tags:t})},async extractMentions(e,t){const n=/(?<t>note|npub)(?<v>[a-z0-9]{59})\b/g,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let o={},i=s.nextNode();while(i){let e=i.textContent;for(let s of e.matchAll(n)){let e=null;if("note"===s.groups.t)e="e";else{if("npub"!==s.groups.t)return;e="p"}let n=s[0],i=this.bech32ToHex(n),a=Object.entries(t),r=a.map((([e,t])=>t)).findIndex((([t,s])=>t===e&&s===n));if(-1!==r)o[n]=a[r][0];else if("e"===e){let e=`${this.shorten(n)}`;t[e]=await(0,mt.wn)(i,"mention"),o[n]=e}else{console.log("extract mentions",`"${n}"`,s);let e=`@${this.$store.getters.displayName(i)}`;t[e]=await(0,mt.l_)(i),o[n]=e}}e=e.replace(n,((e,t,n)=>o[e])),i.textContent=e,i=s.nextNode()}},mentions(e=this.textarea){if(0===this.text.length)return{};let t={};const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let s=n.nextNode(),o=0;while(s){for(let[e,n]of Object.entries(this.tags)){const i=new RegExp(`(?<i>${e})\\b`,"g");let a=s.textContent.matchAll(i);for(let e of a)this.tags[e.groups.i]&&(t[o+"."+e.index+"_"+e.groups.i]={el:s,pos:e.index,tag:Array.from(n),length:e.groups.i.length})}s=n.nextNode(),o++}return t},async formatMentionsForPublishing(e,t=!0,n=this.textarea.cloneNode(!0)){let s=this.mentions(n),o={el:null,offset:null};for(let a in s){let n=s[a],i=e.findIndex((([e,t])=>e===n.tag[0]&&t===n.tag[1]));if(-1===i){let s;"p"===n.tag[0]&&t?s=await(0,mt.l_)(n.tag[1]):"e"===n.tag[0]&&(s=await(0,mt.wn)(n.tag[1],"mention")),s&&(e.push(s),i=e.length-1)}o.el&&o.el!==n.el&&(o.offset=0);let r=o.el&&o.el===n.el?o.offset:0,l=new Range;l.setStart(n.el,n.pos+r),l.setEnd(n.el,n.pos+n.length+r);let d="p"!==n.tag[0]||t?`#[${i}]`:`@${n.tag[1]}`;this.insertText(d,l),o={el:n.el,offset:d.length-n.length+o.offset||0}}n.style.maxHeight="0",this.postEntry.appendChild(n);let i=n.innerText;return n.remove(),i},async updateMentionsTags(){this.trigger++;let{start:e}=this.startEndOfRange();const t=/(?<t>note|npub)(?<v>[a-z0-9]{59})/g;this.text.toLowerCase().match(t)&&(this.mentionsUpdating=!0,await this.extractMentions(this.textarea,this.tags),"#text"===e.el.nodeName&&e.pos>e.el.length?this.setCaret(e.el,e.el.length):this.setCaret(e.el,e.pos),this.updateText(),console.log("updateMentionTags",this.tags),Object.keys(this.tags).filter((e=>"p"===this.tags[e][0])).forEach((e=>{this.replyUserTags.includes(this.tags[e][1])||this.replyUserTags.push(this.tags[e][1])})),this.mentionsUpdating=!1)},startEndOfRange(e=this.caretRange){return{start:{el:e.startContainer,pos:e.startOffset},end:{el:e.endContainer,pos:e.endOffset}}},insertText(e,t=this.textareaRange){let{start:n,end:s}=this.startEndOfRange(t),o=n.el.textContent.slice(0,n.pos)+e+s.el.textContent.slice(s.pos);if(t.isCollapsed||(t.deleteContents(),s.el!==n.el&&s.el.remove()),"#text"===n.el.nodeName)n.el.textContent=o,this.setCaret(n.el,n.pos+e.length);else{let t=document.createTextNode(o);n.el.insertBefore(t,n.el.firstChild),this.setCaret(t,e.length)}this.updateText()},insertEmoji(e){this.trigger++,this.insertText(e.native)},animateSendIcon(){let e=setInterval((()=>{if(!this.sending)return clearInterval(e),void(this.sendIconTranslation=0);this.sendIconTranslation+=3,this.sendIconTranslation>50&&(this.sendIconTranslation-=this.postEntryWidth+40)}),50)},closeTools(){this.toolSelected=""},toggleTool(e){this.updateText(),this.toolSelected===e?this.closeTools():this.toolSelected=e},reset(){this.closeTools(),this.text="",this.textarea.innerHTML="",this.readonlyTextarea.innerHTML="",this.readonlyHighlightTextarea.innerHTML="",this.tags=[],this.links=[],this.focusInput()},appendHashtags(e){for(let t of this.hashtags)e.find((([e,n])=>n===t))||e.push(["t",t.toLowerCase()])},appendLinks(e){for(let t of this.links)t.name?e+=`\n[${t.name}](${t.url})`:e+=`\n${t.url}`;return e},setCaret(e,t){const n="undefined"!==typeof window.getSelection;if(n&&e){const n=window.getSelection(),s=document.createRange();n.removeAllRanges(),s.selectNodeContents(e),s.collapse(!0),s.setStart(e,t),n.addRange(s),this.focusInput()}},addLink(e){this.links.push(e)},linkName(e){return e.name?`${e.name}: `:""},removeLink(e){this.links.splice(e,1)},textareaFocus(e){const t=this.placeholder;t.style.opacity=".3"},textareaBlur(e){const t=this.placeholder;t.style.opacity=".6"},colorText(e){let t=document.createElement("span");return t.innerHTML=e,t.style.color=Zt("secondary"),t},updateReadonlyInput(){let e=this.textarea.innerHTML,t=Object.assign({},this.mentions());for(let n in t){let[t,s]=n.split("_");const o=new RegExp(`(?<i>${s})\\b`,"g");e=e.replaceAll(o,((e,t)=>this.colorText(s).outerHTML))}this.readonlyTextarea.innerHTML=e},updateReadonlyHightlightInput(){if(this.overCharLimit()){this.readonlyHighlightTextarea.innerHTML=this.textarea.innerHTML;let{el:e,pos:t}=this.charPos(this.charLimit,this.readonlyHighlightTextarea),n=e.length&&e.length>t,s=new Range;s.setStart(e,t),s.setEndAfter(this.readonlyHighlightTextarea.lastChild);let o=s.extractContents(),i=[].map.call(o.childNodes,((e,t)=>{if(0===t&&n)return"#text"===e.nodeName?e.textContent:e.innerHTML;let s=document.createElement("span");return s.style.background=Zt("negative"),s.style.opacity=".6",s.innerHTML=e.innerHTML,e.innerHTML=s.outerHTML,e.outerHTML})).join(""),a=document.createElement("span");a.innerHTML=i,a.style.background=Zt("negative"),a.style.opacity=".6";let r=new Range;r.setStart(e,t),r.collapse(!0),r.insertNode(a)}else this.readonlyHighlightTextarea.innerHTML=""},charPos(e,t=this.textarea){for(var n of t.childNodes)if(3===n.nodeType){if(n.length>=e)return{el:n,pos:e,char:-1};e-=n.length}else{let t=this.charPos(e,n);if(-1===t.char)return t;e=t.char}return{char:e}},extractUrls(e){const t=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;return e=e.replace(t,(e=>(this.addLink({url:e}),""))),e},charLeft(){return this.charLimit-this.text.length},overCharLimit(){return this.charLeft()<0},textValid(){return"repost"===this.replyMode||(!!this.links.length||!!this.text.length&&(!!this.messageMode||(!!this.longForm||!this.overCharLimit())))},getReplyUserTags(){if(!this.event||!this.event.tags)return[];let e=this.event.tags.filter((([e,t])=>"p"===e&&this.isKey(t))).map((([...e])=>[...e])),t=e.filter((([e,t])=>"p"===e)).map((([e,t])=>t)).slice(0,9);return t.find((e=>e===this.event.pubkey))||t.push(this.event.pubkey),t=t.filter((e=>e!==this.$store.state.keys.pub)),t},removeReplyUserTag(e){let t=this.mentions();Object.keys(t).forEach((n=>{let s=t[n];if(s.tag[1]===e){let e=new Range;e.setStart(s.el,s.pos),e.setEnd(s.el,s.pos+s.length),this.insertText("",e),this.updateText()}}));let n=Object.keys(this.tags).find((t=>e===this.tags[t][1]));delete this.tags[n],this.replyUserTags=this.replyUserTags.filter((t=>e!==t))}}};var $t=n(490),jt=n(13246),Et=n(1389),Dt=n(67236),Pt=n(11221),Wt=n(83302);const Ut=(0,L.Z)(Rt,[["render",ht],["__scopeId","data-v-1ed8d415"]]),Lt=Ut;function Nt(e,t,n,o,a,r){const l=(0,s.up)("BaseButtonShowMore"),d=(0,s.up)("BasePost"),u=(0,s.up)("q-list");return(0,s.wg)(),(0,s.j4)(u,{ref:"thread",class:"no-padding"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.filledEvents,((t,o)=>((0,s.wg)(),(0,s.iD)("div",{key:t.id+o,class:"no-padding"},["FILLER"===t.id?((0,s.wg)(),(0,s.j4)(l,{key:0,root:t.root},null,8,["root"])):"REPLIES"===t.id?((0,s.wg)(),(0,s.j4)(l,{key:1,root:t.root,"reply-count":t.replyCount},null,8,["root","reply-count"])):((0,s.wg)(),(0,s.j4)(d,{key:2,event:t,position:r.position(o),"reply-depth":n.replyDepth,onResized:r.resize,onAddEvent:r.addEvent,onClick:(0,i.iM)((n=>e.toEvent(t.id)),["stop"])},null,8,["event","position","reply-depth","onResized","onAddEvent","onClick"]))])))),128))])),_:1},512)}function It(e,t,n,o,a,r){const l=(0,s.up)("q-separator"),d=(0,s.up)("q-btn"),u=(0,s.up)("q-btn-group");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(l,{color:"accent"}),(0,s.Wm)(u,{flat:"",spread:"",dense:"","text-color":"accent"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{dense:"",flat:"",color:"accent",class:"text-weight-light",style:{"letter-spacing":".1rem"},onClick:(0,i.iM)(r.showMore,["stop"]),label:n.replyCount?n.replyCount+" replies":"show more"},null,8,["onClick","label"])])),_:1}),n.replyCount?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(l,{key:0,color:"accent"}))],64)}G()(Rt,"components",{QItem:$t.Z,QBtn:J.Z,QList:jt.Z,QIcon:Q.Z,QSpinnerOrbit:Ce.Z,QBtnToggle:Et.Z,QTooltip:A.Z,QSeparator:V.Z,QTabPanels:K.Z,QTabPanel:Y.Z,QBtnGroup:Dt.Z,QCheckbox:Pt.Z,QCircularProgress:Wt.Z});const Ft={name:"BaseButtonShowMore",mixins:[R.Z],props:{root:{type:String,required:!0},replyCount:{type:Number,default:0}},methods:{showMore(){this.toEvent(this.root)}}},Ot=(0,L.Z)(Ft,[["render",It]]),Ht=Ot;G()(Ft,"components",{QSeparator:V.Z,QBtnGroup:Dt.Z,QBtn:J.Z});const Qt={name:"BasePostThread",emits:["resized","add-event"],mixins:[R.Z],props:{events:{type:Array,required:!0},isAncestors:{type:Boolean,default:!1},replyDepth:{type:Number,default:0}},components:{BaseButtonShowMore:Ht},data(){return{resizing:!1}},computed:{root(){return this.events[0].id},filledEvents(){if(!this.resizing||this.resizing){if(0===this.events.length)return[];var e=[this.events[0]];if(1===this.events.length)return this.pushShowMore(e);for(let t=1;t<this.events.length;t++){let n=this.events[t],s=this.events[t-1],o=n.interpolated.replyEvents||[];o.length&&o[o.length-1]!==s.id&&e.push({id:"FILLER",root:s.id}),e.push(n)}return this.pushShowMore(e)}}},methods:{position(e){return this.isAncestors?1===this.filledEvents.length||0===e?"first":(this.filledEvents.length,"middle"):1===this.filledEvents.length?"single":0===e?"first":e===this.filledEvents.length-1?"last":"middle"},addEvent(e){console.log("basepostthread add-event",e),this.$emit("add-event",e)},resize(e){this.resizing=!this.resizing,this.$emit("resized")},pushShowMore(e){var t;let n=e[e.length-1];if(null!==(t=n.replies)&&void 0!==t&&t.length&&this.threadWidth()&&(this.replyDepth>=2||this.replyDepth>0&&this.threadWidth()<300)){let t=Object.assign({},n);t.replyCount=t.replies.length,t.replies=[],e.pop(),e.push(t),e.push({id:"REPLIES",root:t.id,replyCount:t.replyCount})}return e},threadWidth(){var e,t;return null===(e=this.$refs.thread)||void 0===e||null===(t=e.$el)||void 0===t?void 0:t.clientWidth}}},At=(0,L.Z)(Qt,[["render",Nt]]),Vt=At;G()(Qt,"components",{QList:jt.Z});const Jt={class:"text-h5 text-bold q-pt-md q-pb-sm q-px-sm"};function Kt(e,t,n,o,i,a){const r=(0,s.up)("q-separator");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",Jt,[(0,s.WI)(e.$slots,"default")]),e.separator?((0,s.wg)(),(0,s.j4)(r,{key:0,color:"accent",size:"1px"})):(0,s.kq)("",!0)])}const Yt=(0,s.aZ)({name:"BaseHeader",props:{separator:{type:Boolean,default:!0}}}),Xt=(0,L.Z)(Yt,[["render",Kt]]),Gt=Xt;G()(Yt,"components",{QSeparator:V.Z});const en=({app:e})=>{e.component("BasePost",te),e.component("BaseUserName",Se),e.component("BaseUserAvatar",De),e.component("BaseUserCard",Pe.Z),e.component("BasePostEntry",Lt),e.component("BasePostThread",Vt),e.component("BaseHeader",Gt)}},55635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var s=n(37912);const o={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday",Sun:"Sun",Mon:"Mon",Tues:"Tues",Wed:"Wed",Thurs:"Thurs",Fri:"Fri",Sat:"Sat",second:"second",day:"day",January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",UTC:"UTC",now:"now",s:"s",m:"m",h:"h",post:"post",follow:"follow",close:"close",setUser:"set user",read:"read",write:"write",reorderFollows:"reorder follows",cancel:"cancel",save:"save",searchProfiles:"search profiles",searchPosts:"search posts",feed:"feed",notifications:"notifications",messages:"messages",inbox:"inbox",settings:"settings",thread:"thread",event:"event",devTools:"dev tools",notFound:"Oops. Nothing here...",follows:"follows",followers:"followers",replies:"replies",profile:"profile",relays:"relays",faq:"faq",users:"users",nip05Maintainer:"NIP05 maintainer",inactiveRelays:"inactive relays",preferences:"preferences",colors:"colors",font:"font",noFollows:"no follows",noFollowers:"no followers",noRelays:"no relays",dragDropReorder:"drag and drop to reorder"},i={en:o},a=({app:e})=>{const t=(0,s.o)({locale:"en",fallbackLocale:"en",globalInjection:!0,messages:i});e.use(t)}},34136:(e,t,n)=>{"use strict";n.d(t,{$d:()=>Z,BT:()=>S,E1:()=>z,JH:()=>R,LB:()=>l,MD:()=>x,NL:()=>k,Qg:()=>h,TE:()=>b,UD:()=>r,Uk:()=>p,W1:()=>$,Zd:()=>d,dq:()=>m,g2:()=>B,h0:()=>T,ix:()=>q,jg:()=>v,mX:()=>w,mw:()=>c,nY:()=>j,oQ:()=>u,pq:()=>_,sG:()=>C,sM:()=>M,t_:()=>g,uA:()=>y,w8:()=>f});n(40702),n(84641),n(83269);const s=new Worker(new URL(n.p+n.u(734),n.b)),o={};function i(e,t){let n=e+" "+Math.random().toString().slice(-4);return s.postMessage({id:n,name:e,args:t}),new Promise(((e,t)=>{o[n]={resolve:e,reject:t}}))}function a(e,t,n){let i=e+" "+Math.random().toString().slice(-4);return o[i]=n,s.postMessage(JSON.stringify({id:i,name:e,args:t,stream:!0})),{update(...t){s.postMessage(JSON.stringify({id:i,name:e,args:t,stream:!0}))},cancel(){s.postMessage(JSON.stringify({id:i,cancel:!0})),delete o[i]}}}async function r(){return i("dbErase",[])}async function l(e){return i("dbSave",[e])}function d(e=Math.round(Date.now()/1e3),t=(()=>{})){return i("dbFeed",[e])}function u(e=Math.round(Date.now()/1e3),t=(()=>{})){return a("streamFeed",[e],t)}async function c(e){return i("dbChats",[e])}async function p(e,t,n=50,s=Math.round(Date.now()/1e3)){return i("dbMessages",[e,t,n,s])}async function h(e=(()=>{})){return a("listenMessages",[],e)}async function y(e){return i("dbEvent",[e])}async function m(e,t,n,s=(()=>{})){return a("dbStreamTagKind",[e,t,n],s)}async function f(e,t=(()=>{}),n=!1){return a("dbStreamEvent",[e,n],t)}async function g(e,t=50,n=Math.round(Date.now()/1e3)){return i("dbMentions",[e,t,n])}function v(e,t=(()=>{})){return a("listenMentions",[e],t)}async function w(e,t=Math.round(Date.now()/1e3)){return i("dbUnreadMentionsCount",[e,t])}async function b(e,t,n=Math.round(Date.now()/1e3)){return i("dbUnreadMessagesCount",[e,t,n])}async function k(e){return i("dbUserProfile",[e])}async function x(e){return i("dbUserFollows",[e])}async function M(e,t=Math.round(Date.now()/1e3),n=50){return i("dbUserNotes",[e,t,n])}function C(e,t=(()=>{})){return a("streamUser",[e],t)}function _(e,t=(()=>{})){return a("streamUserNotes",[e],t)}function q(e,t=(()=>{})){return a("streamUserProfile",[e],t)}function T(e,t=(()=>{})){return a("dbStreamUserFollows",[e],t)}function B(e,t=(()=>{})){return a("dbStreamUserFollows",[e],t)}function z(e,t=(()=>{})){return a("dbStreamUserFollowers",[e],t)}function S(e,t=(()=>{})){return a("streamUserTags",[e],t)}async function Z(e){return i("dbQuery",[e])}function R(e){return i("setRelays",[JSON.parse(JSON.stringify(e))])}function $(e){return i("setPrivateKey",[e])}function j(e,t){return i("publish",[JSON.parse(JSON.stringify(e)),t])}s.onmessage=e=>{var t,n;let{id:s,success:i,error:a,data:r,stream:l,type:d,notice:u}="string"===typeof e.data?JSON.parse(e.data):e.data;if(!d&&!u)if(l)o[s]&&o[s](r);else{if(!i)return console.log("🖴",s,"->",r),o[s].reject(new Error(a)),void delete o[s];null===(t=o[s])||void 0===t||null===(n=t.resolve)||void 0===n||n.call(t,r),delete o[s]}}},54927:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ce});var s={};n.r(s),n.d(s,{NIP05Id:()=>b,avatar:()=>k,canEncryptDecrypt:()=>B,canSignEventsAutomatically:()=>T,contacts:()=>M,displayName:()=>w,hasMoreContacts:()=>C,hasName:()=>g,name:()=>v,namedProfiles:()=>f,profileDescription:()=>x,unreadChats:()=>_,unreadNotifications:()=>q});var o={};n.r(o),n.d(o,{addContactListToCache:()=>H,addProfileToCache:()=>F,addRelay:()=>E,addToNIP05VerificationCache:()=>O,follow:()=>L,haveReadMessage:()=>V,haveReadNotifications:()=>Q,removeRelay:()=>D,reorderFollows:()=>I,saveRelays:()=>W,setConfig:()=>K,setDefaultRelays:()=>j,setFollows:()=>U,setKeys:()=>R,setRelayOpt:()=>P,setRelays:()=>$,setUnreadMessages:()=>J,setUnreadNotifications:()=>A,unfollow:()=>N});var i={};n.r(i),n.d(i,{addEvent:()=>de,cancelUseProfile:()=>ve,initKeys:()=>oe,launch:()=>ie,launchWithoutKey:()=>ae,publishContactList:()=>pe,recommendRelay:()=>ye,restartMainSubscription:()=>le,sendChatMessage:()=>ce,sendPost:()=>ue,setMetadata:()=>he,useNip05:()=>we,useProfile:()=>ge});var a=n(76058),r=n(63703);const l=()=>window.location.hostname.endsWith(".onion"),d={"wss://nostr-pub.wellorder.net":{read:!0,write:!0},"wss://nostr.onsats.org":{read:!0,write:!0},"wss://nostr-relay.wlvs.space":{read:!0,write:!0},"wss://nostr.bitcoiner.social":{read:!0,write:!0},"wss://relay.damus.io":{read:!0,write:!0},"wss://nostr.zebedee.cloud":{read:!0,write:!1},"wss://relay.nostr.info":{read:!0,write:!1},"wss://nostr-pub.semisol.dev":{read:!0,write:!1},"wss://nostr.walletofsatoshi.com":{read:!0,write:!1}},u=["wss://nostr-pub.wellorder.net","wss://relay.damus.io","wss://relayer.fiatjaf.com","wss://nostr.rocks","wss://rsslay.fiatjaf.com","wss://nostr.zebedee.cloud","wss://nostr-2.zebedee.cloud","wss://expensive-relay.fiatjaf.com","wss://freedom-relay.herokuapp.com/ws","wss://nostr-relay.freeberty.net","wss://nostr.bitcoiner.social","wss://nostr-relay.wlvs.space","wss://nostr.onsats.org","wss://nostr-relay.untethr.me","wss://nostr.semisol.dev","wss://nostr-pub.semisol.dev","wss://nostr-verified.wellorder.net","wss://nostr.drss.io","wss://nostr.unknown.place","wss://nostr.openchain.fr","wss://nostr.delo.software","wss://relay.nostr.info","wss://relay.minds.com/nostr/v1/ws","wss://nostr.zaprite.io","wss://nostr.oxtr.dev","wss://nostr.ono.re","wss://relay.grunch.dev","wss://relay.cynsar.foundation","wss://nostr.sandwich.farm","wss://relay.nostr.ch","wss://nostr.mom","wss://nostr.walletofsatoshi.com","wss://nostr-relay.alekberg.net"],c={"ws://jgqaglhautb4k6e6i2g34jakxiemqp6z4wynlirltuukgkft2xuglmqd.onion":{read:!0,write:!0},"ws://wagvwfrdrikrqzp7h3b5lwl6btyuttu7mqpeji35ljzq36ovzgjhsfqd.onion":{read:!0,write:!0}};function p(){const e=l()?c:d,t=l()?Object.keys(c):u;let n=r.Z.getItem("config"),{timestamps:s,preferences:o}=n||{},{lastUserMainSync:i=0,lastFeedLoad:a=0}=s||{},{color:p,font:h="Roboto"}=o||{},{primary:y="#ffffff",secondary:m="#aaaaaa",accent:f="#777777",background:g="#1f1f1f"}=p||{};return n={timestamps:{lastUserMainSync:i,lastFeedLoad:a},preferences:{color:{primary:y,secondary:m,accent:f,background:g},font:h}},{keys:r.Z.getItem("keys")||{},relays:r.Z.getItem("relays")||{},defaultRelays:e,optionalRelaysList:t,follows:r.Z.getItem("follows")||[],profilesCache:{},profilesCacheLRU:[],contactListCache:{},contactListCacheLRU:[],nip05VerificationCache:{},lastMessageRead:r.Z.getItem("lastMessageRead")||{},unreadMessages:{},lastNotificationRead:r.Z.getItem("lastNotificationRead")||0,unreadNotifications:0,config:n}}n(40702);var h=n(61993),y=n.n(h),m=n(18933);function f(e,t){return Object.entries(e.profilesCache).reduce(((e,[n,s])=>t.hasName(n)?[...e,{...s,pubkey:n}]:e),[])}function g(e){return t=>{let{name:n,nip05:s}=e.profilesCache[t]||{};return(n||s||"").length>0}}function v(e){return t=>{let{name:n}=e.profilesCache[t]||{};return n}}function w(e,t){return t=>{let{name:n,nip05:s}=e.profilesCache[t]||{};return s?s.startsWith("_@")?s.slice(2):s:n||m.Z.methods.shorten(m.Z.methods.hexToBech32(t,"npub"))}}function b(e){return t=>{let{nip05:n}=e.profilesCache[t]||{};return n}}function k(e){return t=>{let{picture:n="data:image/png;base64,"+new(y())(t,40).toString()}=e.profilesCache[t]||{};return n}}function x(e){return t=>{let{about:n=""}=e.profilesCache[t]||{};return n}}function M(e){return t=>e.contactListCache[t]}function C(e){return t=>{var n;return(null===(n=e.contactListCache[t])||void 0===n?void 0:n.length)>6}}function _(e){return delete e.unreadMessages[e.keys.pub],Object.values(e.unreadMessages).filter((e=>e)).length}function q(e){return e.unreadNotifications}function T(e){return Boolean(e.keys.priv||window.nostr)}function B(e){return Boolean(e.keys.priv||window.nostr&&window.nostr.nip04)}n(84641),n(83269),n(46727);var z=n(67694),S=n(50806),Z=n(74961);function R(e,{mnemonic:t,priv:n,pub:s}={}){if(t||n||s||(t=(0,Z.Ol)()),t){let e=(0,Z.UH)(t);n=(0,Z.ik)(e)}n&&(s=(0,z.$3)(n)),e.keys={priv:n,pub:s}}function $(e,t){e.relays=t}function j(e,t){e.defaultRelays=t}function E(e,t){try{(0,S.O)(t),new URL(t)}catch(n){return}e.relays[t]={read:!0,write:!0}}function D(e,t){delete e.relays[t]}function P(e,{url:t,opt:n,value:s}){t in e.relays&&(e.relays[t][n]=s)}function W(e,t){e.relays=t}function U(e,t){e.follows=t}function L(e,t){e.keys.pub!==t&&(e.follows.includes(t)||e.follows.push(t))}function N(e,t){let n=e.follows.indexOf(t);n>=0&&e.follows.splice(n,1)}function I(e,t){e.follows=t}function F(e,t){t=JSON.parse(JSON.stringify(t));let{pubkey:n}=t;if(delete t.pubkey,n in e.profilesCache&&e.profilesCacheLRU.splice(e.profilesCacheLRU.indexOf(n),1),e.profilesCache[n]=t,n===e.keys.pub||e.profilesCacheLRU.push(n),e.profilesCacheLRU.length>3500){let t=e.profilesCacheLRU.shift();delete e.profilesCache[t]}}function O(e,{identifier:t,pubkey:n}){e.nip05VerificationCache[t]={pubkey:n,when:Math.round(Date.now()/1e3)}}function H(e,t){t.pubkey in e.contactListCache&&e.contactListCacheLRU.splice(e.contactListCacheLRU.indexOf(t.pubkey),1);try{let n=t.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t,n,s])=>({pubkey:t,relay:n,petname:s})));n.length&&(e.contactListCache[t.pubkey]=n)}catch(n){return}if(t.pubkey===e.keys.pub||e.contactListCacheLRU.push(t.pubkey),e.contactListCacheLRU.length>150){let t=e.contactListCacheLRU.shift();delete e.contactListCache[t]}}function Q(e){e.lastNotificationRead=Math.round(Date.now()/1e3)}function A(e,t){e.unreadNotifications=t}function V(e,t){e.lastMessageRead[t]=Math.round(Date.now()/1e3)}function J(e,{peer:t,count:n}){e.unreadMessages[t]=n}function K(e,{key:t,value:n}){e.config[t]=n}var Y=n(55350),X=n(74827),G=n(6827),ee=n(60899),te=n(22330),ne=n(34136),se=n(26041);function oe(e,t){e.commit("setKeys",t),e.commit("haveReadNotifications")}async function ie(e){console.log("launch for ",e.state.keys.pub),e.state.keys.priv&&(0,ne.W1)(e.state.keys.priv);let{relays:t,follows:n}=e.state;if(!t||!Object.keys(t).length||!n||!n.length||"undefined"===n){let o=await(0,ne.MD)(e.state.keys.pub);if(!t||!Object.keys(t).length)try{t=JSON.parse(o.content),e.commit("setRelays",t)}catch(s){}if(!n||!n.length||"undefined"===n)try{n=o.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t)),e.commit("setFollows",n)}catch(s){}}e.dispatch("useProfile",{pubkey:e.state.keys.pub});for(let o of n)e.dispatch("useProfile",{pubkey:o});e.dispatch("restartMainSubscription")}async function ae(e){e.dispatch("restartMainSubscription")}let re={};async function le(e){let t=Object.keys(e.state.relays).length?e.state.relays:e.state.defaultRelays;await(0,ne.JH)(t);let n="29f63b70d8961835b14062b195fc7d84fa810560b36dde0749e4bc084f0f8952",s=await(0,ne.h0)(n);if(setTimeout((()=>{s.cancel()}),6e4),re.streamFeed||(re.streamFeed=await(0,ne.oQ)(Math.round(Date.now()/1e3)-86400)),e.state.keys.pub){if(e.state.follows.length){let t={};re.streamFollowsProfiles||(re.streamFollowsProfiles=await(0,ne.ix)(e.state.follows,(async n=>{let s=(0,te.Wb)(n);e.commit("addProfileToCache",s),e.dispatch("useNip05",{metadata:s}),t[n.pubkey]=t[n.pubkey]||0,t[n.pubkey]++,e.state.follows.length===Object.keys(t).length&&re.streamFollowsProfiles.cancel()})))}re.streamUser||(re.streamUser=await(0,ne.sG)(e.state.keys.pub,(async t=>{if(3===t.kind){let n=await(0,ne.$d)(`\n          SELECT json_extract(event,'$.created_at') created_at\n          FROM nostr\n          WHERE json_extract(event,'$.kind') = 3 AND\n            json_extract(event,'$.pubkey') = '${e.state.keys.pub}'\n          LIMIT 1\n        `);if(n.length&&t.created_at<n[0].created_at)return;let s=JSON.parse(t.content);e.commit("setRelays",s);let o=t.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t));e.commit("setFollows",o),e.dispatch("restartMainSubscription")}else if(0===t.kind){let n=await(0,ne.$d)(`\n          SELECT json_extract(event,'$.created_at') created_at\n          FROM nostr\n          WHERE json_extract(event,'$.kind') = 0 AND\n            json_extract(event,'$.pubkey') = '${e.state.keys.pub}'\n          LIMIT 1\n        `);if(n.length&&t.created_at<n[0].created_at)return;let s=(0,te.Wb)(t);e.commit("addProfileToCache",s)}})))}}async function de(e,{event:t,relay:n=null}){await(0,ne.LB)(t,n)}async function ue(e,{message:t,tags:n=[],kind:s=1}){if(0!==t.length){n.push(["client","astral"]);try{const o={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:s,tags:n,content:t};let i=await(0,te.B_)(o,e),a=await(0,ne.nY)(i);if(!a)throw new Error("could not publish post");return e.dispatch("addEvent",{event:i}),i}catch(o){return void G.Z.create({message:`could not publish post: ${o}`,color:"negative"})}}}async function ce(e,{now:t,pubkey:n,text:s,tags:o}){if(0===s.length)return;o.push(["client","astral"]);let i="???";try{var a,r,l;if(e.state.keys.priv)i=(0,Y.H)(e.state.keys.priv,n,s);else{if(await(null===(a=window)||void 0===a||null===(r=a.nostr)||void 0===r||null===(l=r.getPublicKey)||void 0===l?void 0:l.call(r))!==e.state.keys.pub)throw new Error("no private key available to encrypt!");i=await window.nostr.nip04.encrypt(n,s)}let d={pubkey:e.state.keys.pub,created_at:t,kind:4,tags:o,content:i},u=await(0,te.B_)(d,e),c=await(0,ne.nY)(u);if(!c)throw new Error("could not publish message");return e.dispatch("addEvent",{event:u}),u}catch(d){return void G.Z.create({message:`could not publish message: ${d}`,color:"negative"})}}async function pe(e){let t=await(0,ne.MD)(e.state.keys.pub);var n=(null===t||void 0===t?void 0:t.tags)||[];let s=[];await Promise.all(e.state.follows.map((async e=>{let t=n.findIndex((([t,n])=>"p"===t&&n===e));t>=0?s.push(n[t]):s.push(await(0,se.l_)(e))})));try{let t,n,o={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:3,tags:s,content:JSON.stringify(e.state.relays)},i=await(0,te.B_)(o,e),a=await(0,ne.nY)(i);if(!a)throw new Error("could not publish updated list of followed keys and relays");return e.dispatch("addEvent",{event:i}),t=JSON.parse(i.content),n=i.tags.filter((([e,t])=>"p"===e&&t)).map((([e,t])=>t)),e.commit("setFollows",n),e.commit("setRelays",t),(0,ne.JH)(t),await e.dispatch("addEvent",{event:i}),G.Z.create({message:"updated and published list of followed keys and relays.",color:"positive"}),i}catch(o){return void G.Z.create({message:`could not publish updated list of followed keys and relays: ${o}`,color:"negative"})}}async function he(e,t){try{let n={pubkey:e.state.keys.pub,created_at:Math.floor(Date.now()/1e3),kind:0,tags:[],content:JSON.stringify(t)},s=await(0,te.B_)(n,e),o=await(0,ne.nY)(s);if(!o)throw new Error("could not publish updated profile event");return e.dispatch("addEvent",{event:s}),e.commit("addProfileToCache",{pubkey:e.state.keys.pub,...t}),G.Z.create({message:"updated and published profile",color:"positive"}),s}catch(n){return void G.Z.create({message:`could not publish updated profile: ${n}`,color:"negative"})}}async function ye(e,t){try{let n={pubkey:e.state.keys.pub,created_at:Math.round(Date.now()/1e3),kind:2,tags:[],content:t},s=await(0,te.B_)(n,e),o=await(0,ne.nY)(s);if(!o)throw new Error("could not publish recommend relay event");return e.dispatch("addEvent",{event:s}),s}catch(n){return void G.Z.create({message:`could not publish recommend relay event: ${n}`,color:"negative"})}}const me=(0,ee.Z)((async(e,t)=>{re.streamUserProfile?re.streamUserProfile.update(t.slice(0,500)):re.streamUserProfile=await(0,ne.ix)(t.slice(0,500),(async t=>{if(t.pubkey in e.state.profilesCache)return;let n=(0,te.Wb)(t);e.commit("addProfileToCache",n),e.dispatch("useNip05",{metadata:n}),e.dispatch("cancelUseProfile",{pubkey:t.pubkey})}))}),3e3);let fe={};async function ge(e,{pubkey:t}){if(t in e.state.profilesCache)e.commit("addProfileToCache",{pubkey:t,...e.state.profilesCache[t]});else{let n=await(0,ne.NL)(t);if(n){let t=(0,te.Wb)(n);e.dispatch("useNip05",{metadata:t})}else{fe[t]=fe[t]||{count:0,since:Date.now()},fe[t].count++;for(let e of Object.keys(fe))fe[e].since&&fe[e].since<Date.now()-3e4&&delete fe[e];fe[t]&&1===fe[t].count&&me(e,Object.keys(fe))}}}async function ve(e,{pubkey:t}){fe[t]&&(fe[t].count--,fe[t].count<=0&&(delete fe[t],me(e,Object.keys(fe))))}async function we(e,{metadata:t}){if(""===t.nip05&&delete t.nip05,t.nip05){let n=e.state.nip05VerificationCache[t.nip05];if(n&&n.when>Date.now()/1e3-3600)n.pubkey!==t.pubkey&&delete t.nip05;else{let n=await(0,X.x)(t.nip05);e.commit("addToNIP05VerificationCache",{pubkey:n,identifier:t.nip05}),t.pubkey!==n&&delete t.nip05}}e.commit("addProfileToCache",t)}function be(e){e.subscribe((({type:e,payload:t},n)=>{switch(e){case"setKeys":r.Z.set("keys",n.keys);break;case"setFollows":r.Z.set("follows",n.follows);break;case"setRelays":r.Z.set("relays",n.relays);break;case"setConfig":r.Z.set("config",n.config);break;case"haveReadNotifications":r.Z.set("lastNotificationRead",n.lastNotificationRead);break;case"haveReadMessage":r.Z.set("lastMessageRead",n.lastMessageRead);break}}))}function ke(e){e.subscribe((({type:t,payload:n},s)=>{switch(t){case"addRelay":case"removeRelay":case"setRelayOpt":case"saveRelays":case"follow":case"unfollow":case"reorderFollows":e.dispatch("publishContactList");break}}))}function xe(e){e.subscribe((({type:t,payload:n},s)=>{switch(t){case"addRelay":{let t=Object.assign({},e.state.relays);t[n]={read:!0,write:!0},(0,ne.JH)(t);break}case"saveRelays":(0,ne.JH)(n);break;case"follow":case"unfollow":e.dispatch("restartMainSubscription");break}}))}function Me(e){const t=async()=>{e.commit("setUnreadNotifications",await(0,ne.mX)(e.state.keys.pub,e.state.lastNotificationRead))},n=async t=>{e.commit("setUnreadMessages",{peer:t,count:await(0,ne.TE)(e.state.keys.pub,t,e.state.lastMessageRead[t]||0)})};let s=null;const o=()=>{if(e.state.keys.pub)s&&s.cancel(),s=(0,ne.BT)(e.state.keys.pub,(e=>{1===e.kind?t():4===e.kind&&n(e.pubkey)}));else{let o=setInterval((()=>{e.state.keys.pub&&!s&&((0,ne.BT)("p",e.state.keys.pub,(e=>{1===e.kind?t():4===e.kind&&n(e.pubkey)})),clearInterval(o))}),2e3)}t(),(0,ne.mw)(e.state.keys.pub).then((e=>{e.forEach((e=>{n(e.peer)}))}))};e.subscribeAction((({type:e,payload:t},n)=>{switch(e){case"restartMainSubscription":o();break}})),e.subscribe((({type:e,payload:s},o)=>{switch(e){case"haveReadNotifications":t();break;case"haveReadMessage":n(s);break}}))}const Ce=(0,a.MT)({state:p,getters:s,mutations:o,actions:i,plugins:[be,ke,xe,Me]})},22330:(e,t,n)=>{"use strict";n.d(t,{B_:()=>l,CX:()=>i,Wb:()=>a,nf:()=>r});n(40702),n(46727);var s=n(88995),o=n(18009);function i(e){return{id:e.id,pubkey:e.pubkey,created_at:e.created_at,kind:e.kind,tags:e.tags,content:e.content,sig:e.sig}}function a(e){try{let t=JSON.parse(e.content);for(let e of Object.keys(t))t[e]=s.sanitize(t[e]);return t.pubkey=e.pubkey,t}catch(t){return console.log("metadataFromEvent error",t),{}}}function r(e){var t;if(e.tags.filter((([e,t])=>"e"===e&&(!t||t.includes(" ")))).length)return!1;if("this workshop is awesome!"===e.content)return!1;if("Hello Nostr! :)"===e.content)return!1;if(""===e.content.trim())return!1;if(null!==(t=e.seen_on)&&void 0!==t&&t.length&&e.seen_on.includes("wss://rsslay.nostr.net"))return!1;try{return JSON.parse(e.content),!1}catch(n){}return!0}async function l(e,t){if(e.id=(0,o.s_)(e),t.state.keys.priv)e.sig=await(0,o.Y5)(e,t.state.keys.priv);else if(window.nostr){let t=await window.nostr.signEvent(e);switch(typeof t){case"string":e.sig=t;break;case"object":e.sig=t.sig;break;default:throw new Error("Failed to sign with Nostr extension.")}}return e}},26041:(e,t,n)=>{"use strict";n.d(t,{OV:()=>o,aR:()=>i,l_:()=>a,wn:()=>r});n(46727),n(40702);var s=n(34136);function o(e,t=5){if(!e)return"";let n=e.slice(0,4);return["npub","nsec","note"].includes(n)?e.slice(0,t+n.length)+"…"+e.slice(-t):e?e.slice(0,t)+"…"+e.slice(-t):""}function i(e,t,n){for(let s=0;s<e.length;s++){let o=e[s];if(n(o,t))return void e.splice(s,0,t)}e.push(t)}async function a(e){var t=["p",e];let n=await(0,s.NL)(e);if(n&&n.seen_on&&n.seen_on.length){let e=n.seen_on[Math.floor(Math.random()*n.seen_on.length)];t.push(e)}return t}async function r(e,...t){let n=await(0,s.uA)(e);if(n&&n.seen_on&&n.seen_on.length){let e=n.seen_on[Math.floor(Math.random()*n.seen_on.length)];return["e",n.id,e,...t]}return["e",e,"",...t]}},18933:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});n(40702),n(46727),n(18964),n(48170),n(47725),n(69359),n(56408);var s=n(56366),o=n.n(s),i=n(26041),a=n(4376),r=n(34136),l=n(55350),d=n(11560),u=n(88995);const{formatDate:c}=a.ZP;function p(e,t){return c(e,t,{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})}function h(e,t=!1){let n=new Date(1e3*e),s=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),o=Date.now();return o-s.getTime()<31536e6&&o>s.getTime()?p(s,t?"ddd D MMMM":"D MMMM"):p(s,t?"ddd D MMMM YYYY":"D MMMM YYYY")}const y={methods:{getLocation(){return location},json(e){return JSON.stringify(e,null,2)},log(e){return console.log(e)},toProfile(e){this.$router.push("/"+this.hexToBech32(e,"npub"))},toEvent(e){this.$router.push("/"+this.hexToBech32(e,"note"))},shorten:i.OV,niceDateUTC(e){let t=Math.floor(Date.now()/1e3);if(e>t)return h(e);if(e===t)return this.$t("now");let n=t-e;if(n<60)return`${n}${this.$t("s")}`;let s=Math.floor(n/60);if(s<60)return`${s}${this.$t("m")}`;let o=Math.floor(s/60);return o<24?`${o}${this.$t("h")}`:h(e)},dateUTC(e){return h(e,!0)},timeUTC(e){let t=new Date(1e3*e);return`${String(t.getUTCHours()).padStart(2,"0")}:${String(t.getUTCMinutes()).padStart(2,"0")} ${this.$t("UTC")}`},interpolateMentions(e,t){const n={profiles:[],replyEvents:[],mentionEvents:[]};if(e=String(e).trim(),""===e)return{text:e,replyEvents:[],mentionEvents:t.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t))};const s=(s,o)=>{if(t.length-1<Number(o)||t[Number(o)].length<2||!["e","p"].includes(t[Number(o)][0]))return s;if("e"===t[Number(o)][0]){const a=t[Number(o)][1];return n.mentionEvents.push(a),s.length===e.length?"":`[${(0,i.OV)(this.hexToBech32(a,"note"))}](/${this.hexToBech32(a,"note")})`}if("p"===t[Number(o)][0]){const e=t[Number(o)][1],n=this.$store.getters.displayName(e);return`[${n}](/${this.hexToBech32(e,"npub")})`}},o=(e,t,n)=>`${t}[${e}](/hashtag/${n})`,a=(e,t)=>{const n=this.$store.getters.displayName(t);return`[@${n}](/${t})`};let r=e.replace(/#\[(\d+)\]/g,s),l=r.replace(/(?<s>^|[\s])#([\w]{1,63})\b/g,o),d=l.replace(/@([\w]{64})/g,a),c=d,p=t.findIndex((([e,t,n,s])=>"e"===e&&t&&"root"===s));if(p>=0){let[e,s]=t[p];!n.mentionEvents.includes(s)&&n.replyEvents.length<2&&n.replyEvents.push(s);let o=t.find((([e,t,n,s])=>"e"===e&&t&&"reply"===s));if(o>=0){let[e,s]=t[o];!n.mentionEvents.includes(s)&&n.replyEvents.length<2&&n.replyEvents.push(s)}}return t.filter((([e,t,n,s])=>"e"===e&&t&&"mention"===s)).forEach((([e,t],s)=>{n.mentionEvents.includes(t)||n.mentionEvents.push(t)})),t.filter((([e,t])=>"e"===e&&t)).forEach((([e,t],s)=>{n.mentionEvents.includes(t)||n.replyEvents.includes(t)||(n.replyEvents.length<2?n.replyEvents.push(t):n.mentionEvents.push(t))})),{text:u.sanitize(c),replyEvents:n.replyEvents,mentionEvents:n.mentionEvents}},interpolateEventMentions(e){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.content,e.tags||[]))}))},interpolateMessageMentions(e){Array.isArray(e)||(e=[e]),e.forEach((e=>{e.interpolated||(e.interpolated=this.interpolateMentions(e.text,e.tags))}))},createMentionsProvider(e){const t=new(o())({menuContainer:document.getElementById("tribute-wrapper"),positionMenu:!1,selectTemplate:e=>`${this.hexToBech32(e.original.value.pubkey,"npub")}`,menuItemTemplate:e=>`\n            <div class="flex row no-wrap items-center" style="gap: .2rem; width: 100%;">\n              <div style="border-radius: 10px">\n                <img src=${this.$store.getters.avatar(e.original.value.pubkey)} style="object-fit: cover; height: 1.5rem; width: 1.5rem;"/>\n              </div>\n                <div class="text-bold">${e.string}</div>\n              ${this.$store.state.follows.includes(e.original.value.pubkey)?'<i class="notranslate material-icons text-secondary mr-1 -ml-1" aria-hidden="true" role="presentation">visibility</i>':""}\n              ${e.original.value.nip05?'<i class="notranslate material-icons text-accent mr-1 -ml-1" aria-hidden="true" role="presentation">verified</i>':""}\n                <div class="text-secondary text-caption">${(0,i.OV)(this.hexToBech32(e.original.value.pubkey,"npub"))}</div>\n              </div>\n            `,values:(e,t)=>{t(this.$store.getters.namedProfiles.map((e=>({key:this.$store.getters.displayName(e.pubkey),value:e}))))},noMatchTemplate:()=>{}});return{attach:e=>t.attach(e),detach:e=>t.detach(e)}},async processTaggedEvents(e,t){if(!Array.isArray(t))throw new Error("no array supplied");e.splice(10);let n={};for(let s of e)n[s]=await(0,r.w8)(s,(async o=>{this.$store.dispatch("useProfile",{pubkey:o.pubkey}),1===o.kind||2===o.kind?this.interpolateEventMentions(o):4===o.kind&&(o.text=await this.getPlaintext(o),this.interpolateMessageMentions(o)),Array.isArray(t)?t.push(o):console.log("processTaggedEvents events not array",e,o,t),n[s].cancel()}))},async getPlaintext(e){if(e.tags.find((([e,t])=>"p"===e&&t===this.$store.state.keys.pub)))return await this.decrypt(e.pubkey,e.content);if(e.pubkey===this.$store.state.keys.pub){let[t,n]=e.tags.find((([e])=>"p"===e));return await this.decrypt(n,e.content)}},async decrypt(e,t){try{var n,s,o;if(this.$store.state.keys.priv)return(0,l.p)(this.$store.state.keys.priv,e,t);if(await(null===(n=window)||void 0===n||null===(s=n.nostr)||void 0===s||null===(o=s.getPublicKey)||void 0===o?void 0:o.call(s))===this.$store.state.keys.pub)return await window.nostr.nip04.decrypt(e,t);throw new Error("no private key available to decrypt!")}catch(i){return"???"}},isKey(e){var t;return!(null===e||void 0===e||null===(t=e.toLowerCase())||void 0===t||!t.match(/^[0-9a-f]{64}$/))},isBech32Key(e){if("string"!==typeof e)return!1;try{let{prefix:t}=(0,d.Jx)(e.toLowerCase());if(!["npub","nsec"].includes(t))return!1;if("npub"===t&&(this.watchOnly=!0),"nsec"===t&&(this.watchOnly=!1),!this.isKey(this.bech32ToHex(e)))return!1}catch(t){return!1}return!0},bech32ToHex(e){try{let{data:t}=(0,d.Jx)(e);return this.toHexString(t)}catch(t){}return""},hexToBech32(e,t){try{let n=this.fromHexString(e);return(0,d.cv)(t,n,"bech32")}catch(n){}return""},toHexString(e){return e.reduce(((e,t)=>{let n=t.toString(16);return 1===n.length&&(n="0"+n),e+n}),"")},fromHexString(e){if(e.length%2!==0||!/^[0-9a-f]+$/i.test(e))return null;let t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return t}}}},80559:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n(59835),o=n(86970);function i(e,t,n,i,a,r){const l=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn");return e.buttonText?((0,s.wg)(),(0,s.j4)(d,{key:0,icon:"content_copy",unelevated:"",clickable:"",onClick:e.copy,class:(0,o.C_)([""+e.buttonClass,"button-copy"]),size:e.buttonSize,dense:"",label:e.verbose||e.buttonLabel?e.buttonLabel||"copy":"",align:"left"},{default:(0,s.w5)((()=>[e.tooltipText?((0,s.wg)(),(0,s.j4)(l,{key:0},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.tooltipText),1)])),_:1})):(0,s.kq)("",!0)])),_:1},8,["onClick","class","size","label"])):(0,s.kq)("",!0)}var a=n(18933),r=n(6827);const l=(0,s.aZ)({name:"BaseButtonCopy",mixins:[a.Z],props:{buttonText:{type:String,required:!0},buttonLabel:{type:String,default:null},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1},tooltipText:{type:String,required:!1,default:""},element:{type:Object,default:null}},computed:{copyText(){var e,t;let n=null===(e=this.element)||void 0===e||null===(t=e.getSelection())||void 0===t?void 0:t.toString();return n||this.buttonText}},methods:{copy(){let e=this.copyText;console.log(e),navigator.clipboard.writeText(e),r.Z.create({message:`copied ${this.copyText.length<70?this.copyText:this.shorten(this.copyText,30)}`})}}});var d=n(11639),u=n(24455),c=n(46858),p=n(69984),h=n.n(p);const y=(0,d.Z)(l,[["render",i]]),m=y;h()(l,"components",{QBtn:u.Z,QTooltip:c.Z})},39057:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var s=n(59835),o=n(61957),i=n(86970);const a={class:"flex row justify-end"},r={class:"overflow-auto"},l=(0,s.Uk)(" metadata ");function d(e,t,n,d,u,c){const p=(0,s.up)("q-btn"),h=(0,s.up)("BaseRawEvent"),y=(0,s.up)("q-card"),m=(0,s.up)("q-dialog"),f=(0,s.up)("q-tooltip"),g=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(m,{modelValue:e.metadataDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.metadataDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{class:"flex column no-wrap",style:{"max-height":"90%"}},{default:(0,s.w5)((()=>[(0,s._)("div",a,[(0,s.wy)((0,s.Wm)(p,{icon:"close",flat:"",dense:""},null,512),[[g]])]),(0,s._)("div",r,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.events,(e=>((0,s.wg)(),(0,s.j4)(h,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(p,{icon:"info",unelevated:"",clickable:"",onClick:t[2]||(t[2]=(0,o.iM)((t=>e.toggleMetadataDialog()),["stop"])),class:(0,i.C_)([""+e.buttonClass,"button-info"]),size:e.buttonSize,label:e.verbose?"info":"",dense:"",align:"left"},{default:(0,s.w5)((()=>[e.verbose?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(f,{key:0},{default:(0,s.w5)((()=>[l])),_:1}))])),_:1},8,["class","size","label"])],64)}const u={class:"text-subtitle1"},c=(0,s.Uk)(" raw event data ");function p(e,t,n,o,a,r){const l=(0,s.up)("BaseButtonCopy"),d=(0,s.up)("q-card-section"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(p,{style:{"box-shadow":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s._)("div",u,[c,(0,s.Wm)(l,{"button-text":e.json(r.cleaned)},null,8,["button-text"])]),(0,s._)("pre",null,(0,i.zw)(e.json(r.cleaned)),1)])),_:1})])),_:1})}var h=n(18933),y=n(22330),m=n(80559),f=n(88995);const g={name:"BaseRawEvent",mixins:[h.Z],props:{event:{type:Object,required:!0}},components:{BaseButtonCopy:m.Z},computed:{cleaned(){return Array.isArray(this.event)?this.event.map((e=>(0,y.CX)(this.sanitize(e)))):(0,y.CX)(this.sanitize(this.event))}},methods:{sanitize(e){return JSON.parse(f.sanitize(JSON.stringify(this.event)))}}};var v=n(11639),w=n(44458),b=n(63190),k=n(69984),x=n.n(k);const M=(0,v.Z)(g,[["render",p]]),C=M;x()(g,"components",{QCard:w.Z,QCardSection:b.Z});const _=(0,s.aZ)({name:"BaseButtonInfo",emits:["dialog","hide"],components:{BaseRawEvent:C},data(){return{metadataDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleMetadataDialog(){this.metadataDialog=!this.metadataDialog,this.$emit("dialog",this.metadataDialog)}}});var q=n(87743),T=n(24455),B=n(46858),z=n(62146);const S=(0,v.Z)(_,[["render",d]]),Z=S;x()(_,"components",{QDialog:q.Z,QCard:w.Z,QBtn:T.Z,QTooltip:B.Z}),x()(_,"directives",{ClosePopup:z.Z})},73270:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(59835),o=n(86970);const i={class:"flex row justify-end"},a={class:"overflow-auto"},r=(0,s.Uk)(" seen on relays ");function l(e,t,n,l,d,u){const c=(0,s.up)("q-btn"),p=(0,s.up)("BaseRelayList"),h=(0,s.up)("q-card"),y=(0,s.up)("q-dialog"),m=(0,s.up)("q-tooltip"),f=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(y,{modelValue:e.relayListDialog,"onUpdate:modelValue":t[0]||(t[0]=t=>e.relayListDialog=t),onBeforeHide:t[1]||(t[1]=t=>e.$emit("hide"))},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s.wy)((0,s.Wm)(c,{icon:"close",flat:"",dense:""},null,512),[[f]])]),(0,s._)("div",a,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.events,(e=>((0,s.wg)(),(0,s.j4)(p,{key:e.id,event:e},null,8,["event"])))),128))])])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(c,{icon:"sync_alt",unelevated:"",clickable:"",onClick:e.toggleRelayListDialog,class:(0,o.C_)([""+e.buttonClass,"button-relays"]),size:e.buttonSize,label:e.verbose?"relays":"",dense:"",align:"left"},{default:(0,s.w5)((()=>[e.verbose?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(m,{key:0},{default:(0,s.w5)((()=>[r])),_:1}))])),_:1},8,["onClick","class","size","label"])],64)}var d=n(23738);const u=(0,s.aZ)({name:"BaseButtonRelays",emits:["dialog","hide"],components:{BaseRelayList:d.Z},data(){return{relayListDialog:!1}},props:{event:{type:Object,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}},computed:{events(){return Array.isArray(this.event)?this.event:[this.event]}},methods:{toggleRelayListDialog(){this.relayListDialog=!this.relayListDialog,this.$emit("dialog",this.relayListDialog)}}});var c=n(11639),p=n(87743),h=n(44458),y=n(24455),m=n(46858),f=n(62146),g=n(69984),v=n.n(g);const w=(0,c.Z)(u,[["render",l]]),b=w;v()(u,"components",{QDialog:p.Z,QCard:h.Z,QBtn:y.Z,QTooltip:m.Z}),v()(u,"directives",{ClosePopup:f.Z})},45317:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});n(40702);var s=n(59835),o=n(86970),i=n(61957);const a={ref:"src",class:"hidden break-word-wrap"},r={ref:"append",class:"hidden break-word-wrap"},l=["innerHTML"];function d(e,t,n,d,u,c){const p=(0,s.up)("q-btn"),h=(0,s.up)("BaseInvoice");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",a,[(0,s.WI)(e.$slots,"default")],512),(0,s._)("div",r,[(0,s.WI)(e.$slots,"append")],512),(0,s._)("div",{innerHTML:u.html,ref:"html",class:(0,o.C_)(["break-word-wrap dynamic-content",n.longForm?"long-form":""]),onClick:t[0]||(t[0]=(...e)=>c.handleClicks&&c.handleClicks(...e))},null,10,l),n.longForm?((0,s.wg)(),(0,s.j4)(p,{key:0,id:"long-form-button",dense:"",outline:"",rounded:"",color:"accent",class:"text-weight-light q-ma-sm justify-between",style:{"letter-spacing":".1rem","justify-content":"space-between"},label:"show full post",onClick:(0,i.iM)(c.expand,["stop"])},null,8,["onClick"])):(0,s.kq)("",!0),u.invoice?((0,s.wg)(),(0,s.j4)(h,{key:1,invoice:u.invoice},null,8,["invoice"])):(0,s.kq)("",!0)],64)}n(18964),n(84641),n(83269);var u=n(27678),c=n.n(u),p=n(51994),h=n.n(p),y=n(64879),m=n.n(y),f=n(77984),g=n.n(f),v=n(89105),w=n.n(v),b=n(30651),k=n.n(b),x=n(18933),M=n(78621);const C=e=>((0,s.dD)("data-v-38a6ebd3"),e=e(),(0,s.Cn)(),e),_={style:{border:"3px double var(--q-accent)",padding:".5rem",margin:".3rem"}},q={class:"flex row no-wrap justify-between full-width"},T=C((()=>(0,s._)("div",{class:"text-bold",style:{"font-size":"1.1rem"}},"lightning invoice",-1))),B={key:0},z={key:1},S={key:2},Z={class:"flex row no-wrap justify-start q-pt-xs",style:{gap:".5rem"}},R={key:0,class:"break-word-wrap",style:{"overflow-y":"auto","max-height":"170px"}},$={ref:"qr",style:{"object-fit":"cover","min-height":"200px","min-width":"200px"}};function j(e,t,n,a,r,l){const d=(0,s.up)("BaseButtonCopy"),u=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)("div",_,[(0,s._)("div",q,[(0,s._)("div",{style:(0,o.j5)([{"font-size":".8rem"},r.showQr?"":"width: 60%"]),class:"flex column"},[T,l.description?((0,s.wg)(),(0,s.iD)("div",B,"desc: "+(0,o.zw)(l.description),1)):(0,s.kq)("",!0),(0,s._)("div",null,"amount: "+(0,o.zw)(l.amount?`${l.amount} sats`:"none specified"),1),(0,s._)("div",null,"created date: "+(0,o.zw)(e.dateUTC(l.created)),1),(0,s._)("div",null,"created time: "+(0,o.zw)(e.timeUTC(l.created)),1),l.expires?((0,s.wg)(),(0,s.iD)("div",z,"expires date: "+(0,o.zw)(e.dateUTC(l.expires)),1)):(0,s.kq)("",!0),l.expires?((0,s.wg)(),(0,s.iD)("div",S,"expires time: "+(0,o.zw)(e.timeUTC(l.expires)),1)):(0,s.kq)("",!0),(0,s._)("div",Z,[(0,s.Wm)(d,{"button-text":l.request,"button-label":"copy invoice",outline:"",class:"q-pr-xs",onClick:t[0]||(t[0]=(0,i.iM)((e=>r.showQr=!1),["stop"]))},null,8,["button-text"]),(0,s.Wm)(u,{label:"show qr",icon:"qr_code_2",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:(0,i.iM)(l.renderQr,["stop"])},null,8,["onClick"])])],4),(0,s._)("div",{class:"flex column",style:(0,o.j5)([{"font-size":".7rem",padding:".4rem"},r.showQr?"":"width: 40%"])},[r.showQr?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",R,(0,o.zw)(l.request),1)),(0,s.wy)((0,s._)("img",$,null,512),[[i.F8,r.showQr]])],4)])])}var E=n(80559),D=n(21170);const P={name:"BaseInvoice",mixins:[x.Z],props:{invoice:{type:Object,required:!0}},components:{BaseButtonCopy:E.Z},data(){return{showQr:!1}},computed:{includesAmount(){return"separator"!==this.invoice.sections[2].name},amount(){return this.includesAmount?this.invoice.sections[2].value/1e3:null},description(){return this.includesAmount?this.invoice.sections[6].value:this.invoice.sections[5].value},created(){return this.includesAmount?parseInt(this.invoice.sections[4].value):parseInt(this.invoice.sections[3].value)},expires(){let e=this.includesAmount?parseInt(this.invoice.sections[8].value):parseInt(this.invoice.sections[7].value),t=parseInt(e);return isNaN(t)?null:this.created+t},request(){return this.invoice.paymentRequest}},mounted(){},methods:{renderQr(e){this.showQr=!0;let t=D.Z.QrCode.encodeText(this.request,D.Z.QrCode.Ecc.MEDIUM),n=this.toSvgString(t,4);this.$refs.qr.src=n,console.log("qr",t)},toSvgString(e,t){let n="#FFFFFF",s="#000000";if(t<0)throw new RangeError("Border must be non-negative");let o=[];for(let l=0;l<e.size;l++)for(let n=0;n<e.size;n++)e.getModule(n,l)&&o.push(`M${n+t},${l+t}h1v1h-1z`);let i=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 ${e.size+2*t} ${e.size+2*t}" stroke="none">\n\t<rect width="100%" height="100%" fill="${n}"/>\n\t<path d="${o.join(" ")}" fill="${s}"/>\n</svg>\n`,a=new Blob([i],{type:"image/svg+xml"}),r=URL.createObjectURL(a);return r}}};var W=n(11639),U=n(24455),L=n(69984),N=n.n(L);const I=(0,W.Z)(P,[["render",j],["__scopeId","data-v-38a6ebd3"]]),F=I;N()(P,"components",{QBtn:U.Z});const O=c()({html:!1,breaks:!0,linkify:!0});O.use(h()).use(m()).use(g()).use(w()).use(k()).use((e=>{var t=e.renderer.rules.link_open||function(e,t,n,s,o){return o.renderToken(e,t,n)};e.core.ruler.before("normalize","auto-imager",(e=>{e.src=e.src.replace(/https?:[^ \n]+/g,(e=>{if(e){let t=e.split("?")[0];if(t.endsWith(".gif")||t.endsWith(".png")||t.endsWith(".jpeg")||t.endsWith(".jpg")||t.endsWith(".svg")||t.endsWith(".webp")||t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))return`![](${e})`}return e}))})),e.renderer.rules.image=(e,t)=>{let n=e[t].attrs[[e[t].attrIndex("src")]][1],s=n.split("?")[0];return s.endsWith(".gif")||s.endsWith(".png")||s.endsWith(".jpeg")||s.endsWith(".jpg")||s.endsWith(".webp")||s.endsWith(".svg")?`<img src="${n}" async loading='lazy' style="max-width: 90%; max-height: 50vh;">`:s.endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".ogg")?`<video src="${n}" controls async style="max-width: 90%; max-height: 50vh;"></video>`:void 0},e.renderer.rules.link_open=function(e,n,s,o,i){var a=e[n],r=a.attrIndex("target"),l=a.attrIndex("href"),d=/\bhttps:\/\/(www.|m.)?youtu(be.com|.be)\/(watch\?v=|shorts\/)?(?<v>[a-zA-Z0-9_-]{11})(&t=(?<s>[0-9]+)s)?/;let u=a.attrs[l][1].match(d);if(u){let e=`https://www.youtube.com/embed/${u.groups.v}`;return u.groups.s&&(e+=`?start=${u.groups.s}`),`<iframe anonymous async style="height: 15rem; width: 90%; object-fit: cover;" src="${e}"\n          title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>\n          </iframe>`}var c=/^https?:\/\//;return c.test(a.attrs[l][1])&&(r<0?e[n].attrPush(["target","_blank"]):e[n].attrs[r][1]="_blank"),t(e,n,s,o,i)}})),O.linkify.tlds(["onion","eth"],!0).add("bitcoin:",null).add("lightning:",null).add("http:",{validate(e,t,n){var s=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(s)?s.match(n.re.http)[0].length:0},normalize(e,t){if(t.__text_cache__.length<150||e.text<23)return;let n=new URL(e.url),s=n.host;if((n.pathname+n.search+n.hash).length>10){let t=e.text.slice(-7);"/"===t[0]&&(t=t.slice(1)),s+=`/…/${t}`}e.text=s}}).set({fuzzyEmail:!1});const H={name:"BaseMarkdown",mixins:[x.Z],emits:["expand","resized"],components:{BaseInvoice:F},data(){return{html:"",invoice:null}},props:{content:{type:String,default:"todo needs to be updated"},longForm:{type:Boolean,default:!1}},computed:{parsedContent(){const e=/\b(?<i>(lnbc|LNBC)[0-9a-zA-Z]*1[0-9a-zA-Z]+)\b/g,t=(e,t)=>{try{return this.invoice=M.decode(e),""}catch(n){return console.log("invoice parsing error",n),e}};let n=this.content.replace(e,t);return n}},mounted(){this.render()},updated(){this.render()},methods:{render(){this.html=O.render(this.parsedContent)+this.$refs.append.innerHTML,this.$refs.html.querySelectorAll("img").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():e.requestFullscreen(),this.$emit("resized")})),e.addEventListener("load",(e=>{this.$emit("resized")}))}))},handleClicks(e){let{target:t}=e;if(t&&t.matches(".dynamic-content a:not([href*='://'])")&&t.href){const{altKey:n,ctrlKey:s,metaKey:o,shiftKey:i,button:a,defaultPrevented:r}=e;if(o||n||s||i)return;if(r)return;if(void 0!==a&&0!==a)return;if(t&&t.getAttribute){const e=t.getAttribute("target");if(/\b_blank\b/i.test(e))return}const l=new URL(t.href),d=l.pathname;window.location.pathname!==d&&e.preventDefault&&(e.preventDefault(),e.stopPropagation(),this.$router.push(d))}else t&&t.matches(".dynamic-content a[href*='://']")&&t.href&&e.stopPropagation()},expand(e){this.$emit("expand")}}},Q=(0,W.Z)(H,[["render",d]]),A=Q;N()(H,"components",{QBtn:U.Z})},31244:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var s=n(59835),o=n(86970),i=n(61957);const a={key:0,class:"text-accent timestamp"},r={class:"flex column message-bubbles"},l={key:0,class:"flex column text-left full-width q-pb-xs embeded-message",style:{display:"block"},clickable:!1},d={key:0,class:"reposts"};function u(e,t,n,u,c,p){const h=(0,s.up)("BasePost"),y=(0,s.up)("BaseMessage",!0),m=(0,s.up)("BaseUserName"),f=(0,s.up)("BaseMarkdown"),g=(0,s.up)("BaseButtonReply"),v=(0,s.up)("BaseButtonCopy"),w=(0,s.up)("BaseButtonInfo"),b=(0,s.up)("BaseButtonRelays"),k=(0,s.up)("q-list"),x=(0,s.up)("q-menu"),M=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",{class:(0,o.C_)(["relative-position flex column",p.sent?"message-sent":"message-received"]),onClick:t[3]||(t[3]=(0,i.iM)((()=>{}),["stop"]))},[n.isEmbeded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",a,(0,o.zw)(e.timeUTC(n.event.created_at)),1)),(0,s._)("div",r,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.sequence,((a,r)=>((0,s.wg)(),(0,s.iD)("div",{key:r,class:(0,o.C_)(["message-bubble",(0===r||1===p.sequence.length?" first-message":"")+(r===p.sequence.length-1?" last-message":"")])},[!n.isEmbeded&&c.taggedEvents[a.id]&&c.render?((0,s.wg)(),(0,s.iD)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.taggedEvents[a.id],(n=>((0,s.wg)(),(0,s.iD)("div",{key:n.id+"_"+c.taggedEvents[a.id].length+"_"+c.render},[1===n.kind||2===n.kind?((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(h,{event:n,"manual-focus":!1,"is-embeded":!0,onContextmenuCapture:(0,i.iM)((t=>e.toEvent(n.id)),["stop"])},null,8,["event","onContextmenuCapture"])])):4===n.kind?((0,s.wg)(),(0,s.j4)(y,{key:1,event:n,class:"no-padding no-margin","is-embeded":!0,clickable:"",onMounted:t[0]||(t[0]=t=>e.$emit("mounted")),onClickCapture:t[1]||(t[1]=(0,i.iM)((()=>{}),["prevent","stop"]))},null,8,["event"])):(0,s.kq)("",!0)])))),128))])):(0,s.kq)("",!0),n.isEmbeded?((0,s.wg)(),(0,s.iD)("div",{key:1,class:(0,o.C_)(["flex row justify-between q-gutter-md",p.sent?"reverse":""])},[(0,s.Wm)(m,{pubkey:a.pubkey,fallback:!0},null,8,["pubkey"]),(0,s._)("span",null,(0,o.zw)(e.niceDateUTC(n.event.created_at)),1)],2)):(0,s.kq)("",!0),(0,s.Wm)(f,{content:a.interpolated.text},null,8,["content"]),n.isEmbeded?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(x,{key:2,modelValue:c.contextMenus[r],"onUpdate:modelValue":e=>c.contextMenus[r]=e,"touch-position":"","context-menu":"",persistent:c.persistentMenu,onClick:t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{dense:"",class:"flex column q-gutter-xs q-pa-xs"},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(g,{"button-class":"text-accent full-width justify-start",verbose:!0,onReply:e=>p.reply(a)},null,8,["onReply"])])),[[M]]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(v,{"button-class":"text-accent full-width justify-start","button-text":a.interpolated.text,verbose:!0},null,8,["button-text"])])),[[M]]),(0,s._)("div",null,[(0,s.Wm)(w,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])]),(0,s._)("div",null,[(0,s.Wm)(b,{"button-class":"text-accent full-width justify-start",event:a,verbose:!0,onHide:p.hideMenu,onDialog:p.togglePersistentMenu},null,8,["event","onHide","onDialog"])])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue","persistent"]))],2)))),128))])],2)}n(40702);var c=n(19302),p=n(18933),h=n(73270),y=n(39057),m=n(80559);function f(e,t,n,i,a,r){const l=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(l,{icon:"reply",unelevated:"",clickable:"",onClick:t[0]||(t[0]=t=>e.$emit("reply")),class:(0,o.C_)([""+e.buttonClass,"button-reply"]),size:e.buttonSize,dense:"",label:e.verbose?"reply":"",align:"left"},null,8,["class","size","label"])}const g=(0,s.aZ)({name:"BaseButtonReply",emits:["reply"],props:{buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}});var v=n(11639),w=n(24455),b=n(69984),k=n.n(b);const x=(0,v.Z)(g,[["render",f]]),M=x;k()(g,"components",{QBtn:w.Z});var C=n(45317);const _={name:"BaseMessage",emits:["reply","mounted"],mixins:[p.Z],props:{event:{type:Object,required:!0},isEmbeded:{type:Boolean,default:!1}},components:{BaseButtonRelays:h.Z,BaseButtonInfo:y.Z,BaseButtonCopy:m.Z,BaseButtonReply:M,BaseMarkdown:C.Z},setup(){const e=(0,c.Z)();e.platform.has.touch},data(){return{invisible:!0,menu:{},render:1,contextMenus:[],persistentMenu:!1,taggedEvents:{}}},computed:{sequence(){let e=[this.event].concat(this.event.appended).filter((e=>e));return this.render,e},sent(){return this.event.pubkey===this.$store.state.keys.pub}},mounted(){setTimeout((()=>{this.invisible=!1}),20);for(let t of this.sequence){var e;let n=(null===(e=t.tags)||void 0===e?void 0:e.filter((([e,t])=>"e"===e&&t)).map((([e,t])=>t)))||[];n.length&&(this.taggedEvents[t.id]=[],this.processTaggedEvents(n,this.taggedEvents[t.id]))}this.event.created_at<this.$store.state.lastMessageRead[this.bech32ToHex(this.$route.params.pubkey)]&&this.$emit("mounted")},methods:{reply(e){this.$emit("reply",e)},hideMenu(){this.contextMenus=this.contextMenus.map((e=>!1)),this.togglePersistentMenu(!1)},togglePersistentMenu(e){this.persistentMenu=e}}};var q=n(56362),T=n(13246),B=n(62146);const z=(0,v.Z)(_,[["render",u]]),S=z;k()(_,"components",{QMenu:q.Z,QList:T.Z}),k()(_,"directives",{ClosePopup:B.Z})},23738:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var s=n(59835),o=n(86970);const i=e=>((0,s.dD)("data-v-206b03ec"),e=e(),(0,s.Cn)(),e),a=i((()=>(0,s._)("span",{class:"text-bold",style:{"font-size":"1.1rem"}},"relays",-1))),r=(0,s.Uk)("  ( "),l={class:"text-secondary"},d=(0,s.Uk)(" seen "),u=(0,s.Uk)(" not seen "),c=(0,s.Uk)(" ) "),p={style:{"overflow-x":"scroll"}},h={class:"relay-list"},y=(0,s.Uk)("        "),m={key:0,class:"text-secondary",style:{overflow:"hidden"}},f=(0,s.Uk)("\n          "),g=(0,s.Uk)("\n            "),v=(0,s.Uk)("\n        "),w=(0,s.Uk)("\n        "),b={key:1,style:{overflow:"hidden"}},k=(0,s.Uk)("\n          "),x=(0,s.Uk)("\n            "),M=(0,s.Uk)("\n            "),C=(0,s.Uk)("\n        "),_=(0,s.Uk)("\n      ");function q(e,t,n,i,q,T){var B,z;const S=(0,s.up)("q-icon"),Z=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,[a,r,(0,s._)("span",l,[(0,s.Wm)(S,{name:"visibility",size:"xs",dense:""}),d]),(0,s._)("span",null,[(0,s.Wm)(S,{name:"visibility_off",size:"xs",dense:""}),u]),c]),(0,s._)("div",p,[(0,s._)("pre",h,[y,null!==(B=n.event)&&void 0!==B&&null!==(z=B.seen_on)&&void 0!==z&&z.length?((0,s.wg)(),(0,s.iD)("div",m,[f,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.event.seen_on,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"relay-item hide-scrollbar"},[g,(0,s.Wm)(S,{name:"visibility",size:"xs"}),(0,s.Uk)("\n            "+(0,o.zw)(e)+"\n          ",1)])))),128)),v])):(0,s.kq)("",!0),w,T.missingFrom.length?((0,s.wg)(),(0,s.iD)("div",b,[k,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.missingFrom,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"relay-item unseen-relay-item hide-scrollbar",clickable:""},[x,(0,s.Wm)(Z,{icon:"visibility",flat:"",unelevated:"",color:"secondary",size:"sm",class:"no-padding",dense:"",onClick:t=>T.publishTo(e)},null,8,["onClick"]),M,(0,s.Wm)(S,{name:"visibility_off",size:"xs",clickable:""}),(0,s.Uk)("\n            "+(0,o.zw)(e)+"\n          ",1)])))),128)),C])):(0,s.kq)("",!0),_])])])}n(40702);var T=n(34136),B=n(18933),z=n(22330);const S={name:"BaseRelayList",mixins:[B.Z],props:{event:{type:Object,required:!0}},computed:{missingFrom(){return this.event&&this.event.seen_on?Object.entries(this.$store.state.relays).filter((([e,t])=>t.write)).map((([e,t])=>e)).filter((e=>-1===this.event.seen_on.indexOf(e))):[]}},methods:{publishTo(e){(0,T.nY)((0,z.CX)(this.event),e)}}};var Z=n(11639),R=n(22857),$=n(24455),j=n(69984),E=n.n(j);const D=(0,Z.Z)(S,[["render",q],["__scopeId","data-v-206b03ec"]]),P=D;E()(S,"components",{QIcon:R.Z,QBtn:$.Z})},76877:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var s=n(59835);const o={class:"flex column q-gutter-md"},i={key:0};function a(e,t,n,a,r,l){const d=(0,s.up)("BaseRelayCard");return(0,s.wg)(),(0,s.iD)("div",o,[n.listView?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",i,"added relay:")),(0,s.Wm)(d,{url:n.url},null,8,["url"])])}var r=n(18933),l=n(61957),d=n(86970);const u={class:"w-full ml-2"},c={class:"text-bold"};function p(e,t,n,o,i,a){const r=(0,s.up)("q-btn"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(p,{class:"cursor-pointer flex row justify-start items-center",flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{rounded:"",flat:"",color:"primary",size:"md",icon:n.url in e.$store.state.relays?"check":"add",label:n.url in e.$store.state.relays?"added":"add relay",disable:n.url in e.$store.state.relays,onClick:(0,l.iM)(a.addRelay,["stop"])},null,8,["icon","label","disable","onClick"]),(0,s._)("div",c,(0,d.zw)(a.cleanUrl),1)])),_:1})])}var h=n(88995);const y={name:"BaseRelayCard",props:{url:{type:String,required:!0}},computed:{cleanUrl(){return h.sanitize(this.url)}},methods:{addRelay(){this.$q.dialog({title:"Add relay?",message:`Add ${this.url} to your list of relays?`,cancel:{color:"accent"},ok:{color:"accent"}}).onOk((()=>{this.$store.commit("addRelay",this.url)}))}}};var m=n(11639),f=n(44458),g=n(24455),v=n(69984),w=n.n(v);const b=(0,m.Z)(y,[["render",p],["__scopeId","data-v-7551053b"]]),k=b;w()(y,"components",{QCard:f.Z,QBtn:g.Z});const x={name:"BaseRelayRecommend",mixins:[r.Z],components:{BaseRelayCard:k},props:{url:{type:String,required:!0},listView:{type:Boolean,default:!1}}},M=(0,m.Z)(x,[["render",a]]),C=M},8072:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var s=n(59835),o=n(86970),i=n(61957);const a={class:"text-secondary pubkey",style:{opacity:".9","font-size":"95%","font-weight":"300"}};function r(e,t,n,r,l,d){const u=(0,s.up)("BaseUserAvatar"),c=(0,s.up)("BaseUserName"),p=(0,s.up)("BaseMarkdown"),h=(0,s.up)("BaseUserCardActions"),y=(0,s.up)("q-item-section"),m=(0,s.up)("q-item");return(0,s.wg)(),(0,s.j4)(m,{clickable:e.clickable,unelevated:"",outlined:"",class:(0,o.C_)(["no-padding flex row justify-start items-center cursor-pointer",(e.alignRight?"text-right reverse":"text-left")+(e.headerMode?" header-mode":"")+(e.hasTouch||e.headerMode||!e.actionButtons?"":" hidden-action-buttons")]),onClick:t[0]||(t[0]=(0,i.iM)((t=>e.toProfile(e.pubkey)),["stop"])),style:{"max-width":"100%",gap:".5rem"}},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(u,{pubkey:e.pubkey,"align-right":e.alignRight,size:e.headerMode?"10rem":"lg",class:(0,o.C_)(e.headerMode?"self-center":"")},null,8,["pubkey","align-right","size","class"])]),(0,s.Wm)(y,{class:(0,o.C_)(e.headerMode?"self-start":""),style:(0,o.j5)(e.headerMode?"":"white-space: nowrap; overflow: auto;")},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{pubkey:e.pubkey,"header-mode":e.headerMode,"show-verified":!0,class:(0,o.C_)(e.headerMode?" text-h6":""),"align-right":e.alignRight,"show-following":e.showFollowing,wrap:e.wrap},null,8,["pubkey","header-mode","class","align-right","show-following","wrap"]),(0,s._)("div",a,(0,o.zw)(e.shorten(e.npubKey)),1),e.headerMode?((0,s.wg)(),(0,s.j4)(p,{key:0,content:e.$store.getters.profileDescription(e.pubkey)},null,8,["content"])):(0,s.kq)("",!0),e.actionButtons?((0,s.wg)(),(0,s.j4)(h,{key:1,pubkey:e.pubkey,class:"action-buttons"},null,8,["pubkey"])):(0,s.kq)("",!0)])),_:1},8,["class","style"])])),_:1},8,["clickable","class"])}var l=n(19302),d=n(18933);n(40702);function u(e,t,n,a,r,l){const d=(0,s.up)("BaseButtonCopy"),u=(0,s.up)("BaseButtonMessage"),c=(0,s.up)("BaseButtonFollow");return(0,s.wg)(),(0,s.iD)("div",{class:(0,o.C_)(["flex row no-wrap",e.buttonGroupClass]),style:{gap:".3rem"}},[(0,s.Wm)(d,{"button-text":e.npubKey,"button-size":"sm","text-color":"secondary","tooltip-text":"copy pubkey",onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"]))},null,8,["button-text"]),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(u,{key:0,"button-to":"/messages/"+e.npubKey,"button-size":"sm","text-color":"primary",onClick:t[1]||(t[1]=(0,i.iM)((()=>{}),["stop"]))},null,8,["button-to"])):(0,s.kq)("",!0),e.pubkey!==e.$store.state.keys.pub&&e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(c,{key:1,pubkey:e.pubkey,"button-size":"sm",onClick:t[2]||(t[2]=(0,i.iM)((()=>{}),["stop"]))},null,8,["pubkey"])):(0,s.kq)("",!0)],2)}const c=(0,s.Uk)(" encrypted message ");function p(e,t,n,a,r,l){const d=(0,s.up)("q-tooltip"),u=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(u,{icon:"mail_lock",unelevated:"",clickable:"",class:(0,o.C_)([e.buttonClass,"button-message"]),size:e.buttonSize,to:e.buttonTo,onClick:t[0]||(t[0]=(0,i.iM)((()=>{}),["stop"])),dense:""},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[c])),_:1})])),_:1},8,["class","size","to"])}const h=(0,s.aZ)({name:"BaseButtonMessage",props:{buttonTo:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},methods:{copy(){console.log(this.buttonText),navigator.clipboard.writeText(this.buttonText)}}});var y=n(11639),m=n(24455),f=n(46858),g=n(69984),v=n.n(g);const w=(0,y.Z)(h,[["render",p]]),b=w;function k(e,t,n,a,r,l){const d=(0,s.up)("q-icon"),u=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(c,{class:(0,o.C_)(e.buttonClass+(e.isFollowing?"button-unfollow":"button-follow")),size:e.buttonSize,unelevated:"","text-color":e.isFollowing?"":"secondary",dense:"",onClick:(0,i.iM)(e.toggleFollowing,["stop"])},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{name:e.isFollowing?"person_remove":"person_add",class:(0,o.C_)(e.isFollowing?"flip-horizontal":"")},null,8,["name","class"]),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.isFollowing?"unfollow":"follow"),1)])),_:1})])),_:1},8,["class","size","text-color","onClick"])}v()(h,"components",{QBtn:m.Z,QTooltip:f.Z});n(46727);const x=(0,s.aZ)({name:"BaseButtonFollow",props:{pubkey:{type:String,required:!0},buttonClass:{type:String,required:!1,default:""},buttonSize:{type:String,required:!1,default:"sm"}},computed:{isFollowing(){return this.$store.state.follows.includes(this.pubkey)}},methods:{toggleFollowing(){this.isFollowing?this.unfollow():this.follow()},unfollow(){this.$store.commit("unfollow",this.pubkey)},follow(){this.$store.commit("follow",this.pubkey)}}});var M=n(22857);const C=(0,y.Z)(x,[["render",k],["__scopeId","data-v-ebf5b4b0"]]),_=C;v()(x,"components",{QBtn:m.Z,QIcon:M.Z,QTooltip:f.Z});var q=n(80559);const T=(0,s.aZ)({name:"BaseUserCardActions",mixins:[d.Z],props:{pubkey:{type:String,required:!0},buttonGroupClass:{type:String,required:!1,default:""}},components:{BaseButtonMessage:b,BaseButtonFollow:_,BaseButtonCopy:q.Z},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}}),B=(0,y.Z)(T,[["render",u]]),z=B;var S=n(45317);const Z=(0,s.aZ)({name:"BaseUserCard",components:{BaseUserCardActions:z,BaseMarkdown:S.Z},mixins:[d.Z],props:{pubkey:{type:String,required:!0},alignRight:{type:Boolean,required:!1,default:!1},clickable:{type:Boolean,required:!1,default:!0},headerMode:{type:Boolean,required:!1,default:!1},actionButtons:{type:Boolean,required:!1,default:!0},showFollowing:{type:Boolean,default:!1},wrap:{type:Boolean,default:!1}},setup(){const e=(0,l.Z)();let t=(null===e||void 0===e?void 0:e.platform.has.touch)||!1;return{hasTouch:t}},computed:{npubKey(){return this.hexToBech32(this.pubkey,"npub")}}});var R=n(490),$=n(76749);const j=(0,y.Z)(Z,[["render",r],["__scopeId","data-v-2f861818"]]),E=j;v()(Z,"components",{QItem:R.Z,QItemSection:$.Z})},69159:()=>{},46601:()=>{}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,(()=>{var e=[];n.O=(t,s,o,i)=>{if(!s){var a=1/0;for(u=0;u<e.length;u++){for(var[s,o,i]=e[u],r=!0,l=0;l<s.length;l++)(!1&i||a>=i)&&Object.keys(n.O).every((e=>n.O[e](s[l])))?s.splice(l--,1):(r=!1,i<a&&(a=i));if(r){e.splice(u--,1);var d=o();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[s,o,i]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(s,o){if(1&o&&(s=this(s)),8&o)return s;if("object"===typeof s&&s){if(4&o&&s.__esModule)return s;if(16&o&&"function"===typeof s.then)return s}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var r=2&o&&s;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((e=>a[e]=()=>s[e]));return a["default"]=()=>s,n.d(i,a),i}})(),(()=>{n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,s)=>(n.f[s](e,t),t)),[]))})(),(()=>{n.u=e=>"js/"+(443===e?"about":e)+"."+{61:"7e95968c",101:"19e4d6cf",227:"e5f11564",255:"61b1a4e3",365:"d48a6ba8",430:"c053e8f0",431:"884277b5",443:"9f94f986",506:"481ef41f",669:"73a702eb",734:"7987bd36",782:"50ecc0d0",928:"57ff63ee"}[e]+".js"})(),(()=>{n.miniCssF=e=>"css/"+({143:"app",443:"about",736:"vendor"}[e]||e)+"."+{61:"f5c9dbbb",101:"78d74b0a",143:"890944d8",227:"58084b04",255:"62642ca7",365:"74026801",431:"ef3a97bf",443:"e5e1a81f",736:"459d2a15",928:"3441959b"}[e]+".css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="astral:";n.l=(s,o,i,a)=>{if(e[s])e[s].push(o);else{var r,l;if(void 0!==i)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==s||c.getAttribute("data-webpack")==t+i){r=c;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.setAttribute("data-webpack",t+i),r.src=s),e[s]=[o];var p=(t,n)=>{r.onerror=r.onload=null,clearTimeout(h);var o=e[s];if(delete e[s],r.parentNode&&r.parentNode.removeChild(r),o&&o.forEach((e=>e(n))),t)return t(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),l&&document.head.appendChild(r)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{n.j=143})(),(()=>{n.p="/"})(),(()=>{var e=(e,t,n,s)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var i=i=>{if(o.onerror=o.onload=null,"load"===i.type)n();else{var a=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=r,o.parentNode.removeChild(o),s(l)}};return o.onerror=o.onload=i,o.href=t,document.head.appendChild(o),o},t=(e,t)=>{for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var o=n[s],i=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===e||i===t))return o}var a=document.getElementsByTagName("style");for(s=0;s<a.length;s++){o=a[s],i=o.getAttribute("data-href");if(i===e||i===t)return o}},s=s=>new Promise(((o,i)=>{var a=n.miniCssF(s),r=n.p+a;if(t(a,r))return o();e(s,r,o,i)})),o={143:0};n.f.miniCss=(e,t)=>{var n={61:1,101:1,227:1,255:1,365:1,431:1,443:1,928:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=s(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}})(),(()=>{n.b=document.baseURI||self.location.href;var e={143:0};n.f.j=(t,s)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)s.push(o[2]);else{var i=new Promise(((n,s)=>o=e[t]=[n,s]));s.push(o[2]=i);var a=n.p+n.u(t),r=new Error,l=s=>{if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var i=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",r.name="ChunkLoadError",r.type=i,r.request=a,o[1](r)}};n.l(a,l,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,s)=>{var o,i,[a,r,l]=s,d=0;if(a.some((t=>0!==e[t]))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(l)var u=l(n)}for(t&&t(s);d<a.length;d++)i=a[d],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},s=globalThis["webpackChunkastral"]=globalThis["webpackChunkastral"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=n.O(void 0,[736,64],(()=>n(84647)));s=n.O(s)})();
"use strict";(globalThis["webpackChunkastral"]=globalThis["webpackChunkastral"]||[]).push([[967],{25296:(e,t,o)=>{o.r(t),o.d(t,{default:()=>kt});o(40702);var s=o(59835),n=o(61957);const i=["href"],l=["href"],a={id:"layout-container",ripple:!1},r={id:"left-drawer",class:"flex justify-end"},c={id:"middle-page"},d={key:0,id:"post-entry",unelevated:"",class:"gt-xs flex column align-self relative-position"},u=(0,s._)("div",{id:"bottom-drawer-placeholder"},null,-1),p={id:"right-drawer",class:"flex justify-start"},m={key:0,id:"bottom-message-entry",unelevated:"",class:"flex column align-self relative-position q-px-md"},y={key:1,id:"bottom-post-entry-top-border"},h={key:2,id:"bottom-post-entry",unelevated:"",class:"flex column align-self relative-position q-px-md"},g=(0,s.Uk)(" click to collapse/expand or drag to move "),k=(0,s.Uk)("forward"),w=(0,s.Uk)("scroll to top"),f=(0,s.Uk)("back");function b(e,t,o,b,v,q){const _=(0,s.up)("TheKeyInitializationDialog"),C=(0,s.up)("q-dialog"),$=(0,s.up)("TheUserMenu"),x=(0,s.up)("router-view"),z=(0,s.up)("q-page-container"),P=(0,s.up)("q-btn"),M=(0,s.up)("BasePostEntry"),Z=(0,s.up)("TheSearchMenu"),E=(0,s.up)("q-page-sticky"),S=(0,s.up)("q-tooltip"),U=(0,s.up)("q-icon"),W=(0,s.up)("q-fab"),B=(0,s.up)("q-layout"),R=(0,s.Q2)("touch-pan");return(0,s.wg)(),(0,s.j4)(B,null,{default:(0,s.w5)((()=>[e.updatingFont?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("link",{key:0,id:"font-link",rel:"stylesheet",href:`https://fonts.googleapis.com/css2?family=${e.googleFontsName}`},null,8,i)),(0,s._)("link",{id:"emoji-font-link",rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display-swap"},null,8,l),e.$store.state.keys.pub?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(C,{key:1,modelValue:e.initializeKeys,"onUpdate:modelValue":t[0]||(t[0]=t=>e.initializeKeys=t),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{style:{"max-height":"85vh"},onLookAround:e.setLookingAroundMode},null,8,["onLookAround"])])),_:1},8,["modelValue"])),(0,s._)("div",a,[(0,s._)("div",r,[(0,s.Wm)($,{"item-mode":e.$q.screen.width<1023,"show-compact-mode-items":e.$q.screen.width<700,posting:e.postEntryOpen,onTogglePostEntry:e.togglePostEntry,onScrollToRect:e.scrollToRect,onSetUser:t[1]||(t[1]=t=>e.lookingAround=!1)},null,8,["item-mode","show-compact-mode-items","posting","onTogglePostEntry","onScrollToRect"])]),(0,s._)("div",c,[(0,s.Wm)(z,{ref:"pageContainer"},{default:(0,s.w5)((()=>[(0,s.Wm)(x,null,{default:(0,s.w5)((({Component:t})=>[((0,s.wg)(),(0,s.j4)(s.Ob,{include:e.cachedPages},[((0,s.wg)(),(0,s.j4)((0,s.LL)(t),{key:e.$route.path,"looking-around":e.lookingAround,onScrollToRect:e.scrollToRect,onReplyEvent:e.setReplyEvent,onUpdateFont:e.updateFont},null,40,["looking-around","onScrollToRect","onReplyEvent","onUpdateFont"]))],1032,["include"]))])),_:1})])),_:1},512),e.$q.screen.width>=600&&e.postEntryOpen?((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(P,{icon:"close",flat:"",dense:"",onClick:e.togglePostEntry,class:"self-end",style:{position:"absolute",top:"0",right:"0","z-index":"1"}},null,8,["onClick"]),(0,s.Wm)(M,{event:e.replyEvent,onClearEvent:t[2]||(t[2]=t=>e.replyEvent=null),onSent:e.togglePostEntry,class:"q-px-md q-pt-sm"},null,8,["event","onSent"])])):(0,s.kq)("",!0),u]),(0,s._)("div",p,[(0,s.Wm)(Z)])]),e.$q.screen.width<600?((0,s.wg)(),(0,s.j4)(E,{key:2,onClick:(0,n.iM)(e.resizePostEntryPlaceholder,["stop"]),id:"bottom-drawer",position:"bottom",class:"z-top xs lt-sm"},{default:(0,s.w5)((()=>[e.messageMode?((0,s.wg)(),(0,s.iD)("div",m,[(0,s.Wm)(M,{event:e.replyEvent,"message-mode":e.messageMode,onClearEvent:t[3]||(t[3]=t=>e.replyEvent=null),onSent:t[4]||(t[4]=t=>e.replyEvent=null),onResized:e.resizePostEntryPlaceholder,"auto-focus":!1},null,8,["event","message-mode","onResized"])])):(0,s.kq)("",!0),e.messageMode?((0,s.wg)(),(0,s.iD)("div",y)):(0,s.kq)("",!0),e.postEntryOpen?((0,s.wg)(),(0,s.iD)("div",h,[(0,s.Wm)(M,{onSent:e.togglePostEntry,onResized:e.resizePostEntryPlaceholder,"auto-focus":!1},null,8,["onSent","onResized"])])):(0,s.kq)("",!0),(0,s.Wm)($,{id:"bottom-menu","compact-mode":!0,posting:e.postEntryOpen,onTogglePostEntry:e.togglePostEntry,onScrollToRect:e.scrollToRect,onSetUser:t[5]||(t[5]=t=>e.lookingAround=!1)},null,8,["posting","onTogglePostEntry","onScrollToRect"])])),_:1},8,["onClick"])):(0,s.kq)("",!0),(0,s.Wm)(E,{position:"top-right",offset:e.fabPos,id:"navagation-buttons"},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(W,{direction:"left",color:"accent",class:"no-margin no-padding z-top","model-value":!0,persistent:"",flat:"",padding:"xs",disable:e.draggingFab},{tooltip:(0,s.w5)((()=>[(0,s.Wm)(S,null,{default:(0,s.w5)((()=>[g])),_:1})])),icon:(0,s.w5)((()=>[(0,s.Wm)(U,{name:"drag_indicator"})])),"active-icon":(0,s.w5)((()=>[(0,s.Wm)(U,{name:"drag_indicator"})])),default:(0,s.w5)((()=>[(0,s.Wm)(P,{onClick:(0,n.iM)(e.forward,["stop"]),color:"primary",unelevated:"",round:"",outline:"",icon:"keyboard_arrow_right",disable:e.draggingFab},{default:(0,s.w5)((()=>[(0,s.Wm)(S,null,{default:(0,s.w5)((()=>[k])),_:1})])),_:1},8,["onClick","disable"]),(0,s.Wm)(P,{onClick:(0,n.iM)(e.scrollToTop,["stop"]),color:"primary",unelevated:"",round:"",outline:"",icon:"keyboard_double_arrow_up",disable:e.draggingFab||"inbox"===e.$route.name||"messages"===e.$route.name},{default:(0,s.w5)((()=>[(0,s.Wm)(S,null,{default:(0,s.w5)((()=>[w])),_:1})])),_:1},8,["onClick","disable"]),(0,s.Wm)(P,{onClick:(0,n.iM)(e.back,["stop"]),color:"primary",unelevated:"",round:"",outline:"",icon:"keyboard_arrow_left",disable:e.draggingFab},{default:(0,s.w5)((()=>[(0,s.Wm)(S,null,{default:(0,s.w5)((()=>[f])),_:1})])),_:1},8,["onClick","disable"])])),_:1},8,["disable"])),[[R,e.moveFab,void 0,{prevent:!0,mouse:!0}]])])),_:1},8,["offset"])])),_:1})}o(46727),o(18964);var v=o(43701),q=o(19302),_=o(86970);const C={key:1,style:{"min-height":"1rem"}},$={key:2,avatar:"",class:"q-mx-auto no-padding relative-position"},x={key:2,style:{"min-height":"1rem"}};function z(e,t,o,n,i,l){const a=(0,s.up)("BaseUserCard"),r=(0,s.up)("BaseUserAvatar"),c=(0,s.up)("q-item"),d=(0,s.up)("q-item-section"),u=(0,s.up)("q-icon"),p=(0,s.up)("q-badge"),m=(0,s.up)("BaseButtonPost"),y=(0,s.up)("BaseButtonSetUser"),h=(0,s.up)("q-list");return(0,s.wg)(),(0,s.j4)(h,{class:(0,_.C_)(e.compactMode?"flex row no-wrap justify-around items-center full-width":"text-right"),dense:e.compactMode},{default:(0,s.w5)((()=>[e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(c,{key:0,class:(0,_.C_)(["col no-padding flex items-center",e.compactMode?"justify-center":"justify-end"]),clickable:"",onClick:t[0]||(t[0]=t=>e.toProfile(e.$store.state.keys.pub))},{default:(0,s.w5)((()=>[e.compactMode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(a,{key:0,pubkey:e.$store.state.keys.pub,"align-right":!0,wrap:!0,class:"gt-sm"},null,8,["pubkey"])),e.compactMode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:1,pubkey:e.$store.state.keys.pub,"align-right":!0,"show-verified":!0,size:"lg",class:"q-mr-sm lt-md"},null,8,["pubkey"])),e.$store.state.keys.pub&&e.compactMode?((0,s.wg)(),(0,s.j4)(r,{key:2,pubkey:e.$store.state.keys.pub,"align-right":!0,size:"1.5rem"},null,8,["pubkey"])):(0,s.kq)("",!0)])),_:1},8,["class"])):(0,s.kq)("",!0),e.compactMode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",C)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.filteredUserMenuItems,(t=>((0,s.wg)(),(0,s.j4)(c,{clickable:"",class:(0,_.C_)(["menu-item",(e.$route.name===t.title||e.$route.path.split("/")[1]===t.title?"menu-item-active text-accent ":"")+(e.compactMode?"no-margin no-padding col":"self-end q-px-none")]),dense:e.compactMode,style:(0,_.j5)(e.compactMode?"":"min-height: 2.75rem;"),active:e.$route.name===t.title||e.$route.path.split("/")[1]===t.title,"active-class":"",onClick:o=>e.handleClick(o,t),key:t.title},{default:(0,s.w5)((()=>[e.compactMode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(d,{key:0,class:"gt-sm text-uppercase",style:{"font-size":"1rem"}},{default:(0,s.w5)((()=>[(0,s._)("div",null,(0,_.zw)(e.$t(t.title)),1)])),_:2},1024)),t.icon&&!e.compactMode?((0,s.wg)(),(0,s.j4)(d,{key:1,avatar:"",class:"relative-position no-padding",style:{"min-width":"2.5rem"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{outline:"",name:t.icon},null,8,["name"]),"notifications"===t.title&&e.$store.state.unreadNotifications?((0,s.wg)(),(0,s.j4)(p,{key:0,color:"secondary",floating:"",class:"q-mr-md text-bold",outline:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,_.zw)(e.$store.state.unreadNotifications),1)])),_:1})):(0,s.kq)("",!0),"messages"===t.title&&e.$store.getters.unreadChats?((0,s.wg)(),(0,s.j4)(p,{key:1,color:"secondary",floating:"",class:"q-mr-md text-bold",outline:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,_.zw)(e.$store.getters.unreadChats),1)])),_:1})):(0,s.kq)("",!0)])),_:2},1024)):(0,s.kq)("",!0),t.icon&&e.compactMode?((0,s.wg)(),(0,s.iD)("div",$,[(0,s.Wm)(u,{name:t.icon,size:"sm"},null,8,["name"]),t.badge&&e.$store.getters[t.badge]?((0,s.wg)(),(0,s.j4)(p,{key:0,color:"secondary",floating:"",rounded:"",style:{"margin-top":".2rem","margin-left":".1rem"}})):(0,s.kq)("",!0)])):(0,s.kq)("",!0)])),_:2},1032,["dense","style","active","onClick","class"])))),128)),e.compactMode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",x)),(0,s._)("div",{color:"primary",class:(0,_.C_)(["flex",e.compactMode?"col justify-center":"q-my-md justify-end"])},[e.$store.state.keys.pub?((0,s.wg)(),(0,s.j4)(m,{key:0,"is-open":e.posting,verbose:!0,onOpen:t[1]||(t[1]=t=>e.$emit("toggle-post-entry")),outline:!e.compactMode,flat:e.compactMode,color:"primary",size:e.compactMode?"sm":"lg",class:(0,_.C_)(e.compactMode?"":"q-px-sm")},null,8,["is-open","outline","flat","size","class"])):(0,s.kq)("",!0),e.$store.state.keys.pub?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(y,{key:1,onClick:t[2]||(t[2]=t=>e.handleClick(t,{title:"set-user"})),verbose:!0,outline:!e.compactMode,flat:e.compactMode,color:"primary",size:e.compactMode?"sm":"lg",class:(0,_.C_)(e.compactMode?"":"q-px-sm")},null,8,["outline","flat","size","class"]))],2)])),_:1},8,["class","dense"])}var P=o(18933),M=o(35749);const Z={key:0,class:"gt-sm",style:{"font-size":"1rem","font-weight":"700","letter-spacing":".05rem"}},E={key:0},S={key:1};function U(e,t,o,n,i,l){const a=(0,s.up)("q-icon"),r=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(r,{unelevated:"",clickable:"",size:e.buttonSize,class:"button-post",dense:"",onClick:t[0]||(t[0]=t=>e.$emit("open"))},{default:(0,s.w5)((()=>[e.verbose?((0,s.wg)(),(0,s.iD)("div",Z,[e.isOpen?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("span",E," "+(0,_.zw)(e.$t("post"))+" ",1)),e.isOpen?((0,s.wg)(),(0,s.iD)("span",S," "+(0,_.zw)(e.$t("close"))+" ",1)):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s.Wm)(a,{name:e.isOpen?"close":"chat_bubble_outline",class:(0,_.C_)(e.verbose?"":"flip-horizontal"),color:e.isOpen?"":"primary",size:e.buttonSize},null,8,["name","class","color","size"])])),_:1},8,["size"])}const W=(0,s.aZ)({name:"BaseButtonPost",emits:["open"],props:{isOpen:{type:Boolean,required:!0},buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}});var B=o(11639),R=o(24455),j=o(22857),K=o(69984),T=o.n(K);const Q=(0,B.Z)(W,[["render",U]]),D=Q;T()(W,"components",{QBtn:R.Z,QIcon:j.Z});const O={key:0,class:"gt-sm",style:{"font-size":"1rem","font-weight":"700","letter-spacing":".05rem"}};function I(e,t,o,n,i,l){const a=(0,s.up)("q-icon"),r=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.j4)(r,{unelevated:"",clickable:"",size:e.buttonSize,class:"button-set-user",dense:""},{default:(0,s.w5)((()=>[e.verbose?((0,s.wg)(),(0,s.iD)("div",O,[(0,s._)("span",null," "+(0,_.zw)(e.$t("setUser"))+" ",1)])):(0,s.kq)("",!0),(0,s.Wm)(a,{name:"login",color:"primary",size:e.buttonSize},null,8,["size"])])),_:1},8,["size"])}const F=(0,s.aZ)({name:"BaseButtonSetUser",props:{buttonSize:{type:String,required:!1,default:"sm"},verbose:{type:Boolean,default:!1}}}),L=(0,B.Z)(F,[["render",I]]),V=L;T()(F,"components",{QBtn:R.Z,QIcon:j.Z});const N=(0,s.aZ)({name:"TheUserMenu",mixins:[P.Z],emits:["toggle-post-entry","scroll-to-rect","set-user"],props:{iconMode:{type:Boolean,default:!1},compactMode:{type:Boolean,default:!1},showCompactModeItems:{type:Boolean,default:!1},posting:{type:Boolean,required:!0}},data(){return{userMenuItems:[{title:"feed",icon:"newspaper",to:"/",match:"feed"},{title:"notifications",badge:"unreadNotifications",icon:"notifications",to:"/notifications",match:"notifications"},{title:"messages",badge:"unreadChats",icon:"mail_lock",to:"/messages/inbox",match:"messages"},{title:"settings",icon:"settings",to:"/settings",match:"settings"},{title:"follow",icon:"search",to:"/follow",match:"follow",compactMenuOnly:!0}]}},components:{BaseUserCard:M.Z,BaseButtonPost:D,BaseButtonSetUser:V},computed:{filteredUserMenuItems(){return this.$store.state.keys.pub?this.compactMode||this.showCompactModeItems?this.userMenuItems:this.userMenuItems.filter((e=>!e.compactMenuOnly)):this.userMenuItems.filter((e=>"feed"===e.title))}},methods:{handleClick(e,t){if("set-user"===t.title)return this.$emit("scroll-to-rect",{top:0}),void this.$emit("set-user");"feed"===t.title&&"feed"===this.$route.name?(e.preventDefault(),this.$emit("scroll-to-rect",{top:0})):this.$router.push(t.to)}}});var A=o(13246),H=o(490),Y=o(50926),G=o(76749),J=o(20990),X=o(87743),ee=o(44458),te=o(62146);const oe=(0,B.Z)(N,[["render",z],["__scopeId","data-v-eda81f40"]]),se=oe;T()(N,"components",{QList:A.Z,QItem:H.Z,QSeparator:Y.Z,QItemSection:G.Z,QIcon:j.Z,QBadge:J.Z,QDialog:X.Z,QCard:ee.Z,QBtn:R.Z}),T()(N,"directives",{ClosePopup:te.Z});var ne=o(90205);const ie=e=>((0,s.dD)("data-v-3e282e4a"),e=e(),(0,s.Cn)(),e),le=ie((()=>(0,s._)("h1",{class:"text-h6 q-pr-md"},"welcome to astral",-1))),ae=ie((()=>(0,s._)("span",{class:"full-width"},"click here to learn about Nostr, your keys, and how to use astral",-1))),re=ie((()=>(0,s._)("span",{style:{padding:".2rem 0 0 .2rem"}},[(0,s.Uk)("note: after login this same information can be found in the "),(0,s._)("strong",null,"faq"),(0,s.Uk)(" section at the bottom of the settings page")],-1))),ce=ie((()=>(0,s._)("h2",{class:"text-subtitle2 q-pr-md"},"enter your key",-1))),de={key:0},ue={key:1},pe={key:2},me={key:3},ye=(0,s.Uk)(" generate keys "),he=(0,s.Uk)(" use public key from extension "),ge={class:"full-width flex row no-wrap items-center"},ke=ie((()=>(0,s._)("h2",{class:"text-subtitle2 q-pr-md"},"enter bootstrap relays (optional)",-1))),we=(0,s.Uk)(" the selected relays below will be queried to load your user profile, follows, and relay data from Nostr network. please ensure the list of selected relays includes relays you publish your Nostr data to, otherwise astral may not be able to find your data. "),fe={class:"flex row justify-between no-wrap items-end"},be=ie((()=>(0,s._)("span",null,"selected relays",-1))),ve={class:"flex row items-end",id:"new-relay-input"},qe={class:"relay-list",style:{border:"1px solid var(--q-primary)"}},_e=(0,s.Uk)("              "),Ce=["onClick"],$e=(0,s.Uk)("\n                "),xe={class:"flex row justify-between no-wrap"},ze=(0,s.Uk)("\n                  "),Pe={style:{overflow:"auto"}},Me=(0,s.Uk)("\n                  "),Ze=(0,s.Uk)("\n                "),Ee=(0,s.Uk)("\n              "),Se=(0,s.Uk)("\n            "),Ue={style:{"max-height":"6.75rem"}},We={class:"relay-list"},Be=(0,s.Uk)("              "),Re=["onClick"],je=(0,s.Uk)("\n                "),Ke={class:"flex row justify-between no-wrap"},Te=(0,s.Uk)("\n                  "),Qe={style:{overflow:"auto"}},De=(0,s.Uk)("\n                  "),Oe=(0,s.Uk)("\n                "),Ie=(0,s.Uk)("\n              "),Fe=(0,s.Uk)("\n            "),Le=ie((()=>(0,s._)("div",{style:{"min-height":"1rem"}},null,-1)));function Ve(e,t,o,i,l,a){const r=(0,s.up)("q-btn"),c=(0,s.up)("BaseInformation"),d=(0,s.up)("q-expansion-item"),u=(0,s.up)("q-btn-group"),p=(0,s.up)("q-input"),m=(0,s.up)("q-card-section"),y=(0,s.up)("q-form"),h=(0,s.up)("q-tooltip"),g=(0,s.up)("q-icon"),k=(0,s.up)("BaseSelectMultiple"),w=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(w,{class:"relative-position full-width"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{icon:"close",size:"md",flat:"",round:"",class:"absolute-top-right z-top",onClick:t[0]||(t[0]=t=>e.$emit("look-around"))}),le,(0,s.Wm)(d,{dense:"","expand-icon":"help","expanded-icon":"expand_less",class:"intro no-padding full-width items-center","header-class":"items-center"},{header:(0,s.w5)((()=>[ae])),default:(0,s.w5)((()=>[(0,s.Wm)(c),re])),_:1}),ce,(0,s.Wm)(y,{onSubmit:e.proceed},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"key-entry no-padding"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{spread:"",unelevated:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{size:"sm",color:"primary",label:"public key",outline:!e.watchOnly,"text-color":e.watchOnly?"dark":"",value:"true",onClick:t[1]||(t[1]=t=>e.watchOnly=!0),disable:e.isBech32Sec},null,8,["outline","text-color","disable"]),(0,s.Wm)(r,{size:"sm",color:"primary",label:"private key",outline:e.watchOnly,"text-color":e.watchOnly?"":"dark",value:"false",onClick:t[2]||(t[2]=t=>e.watchOnly=!1),disable:e.isBech32Pub},null,8,["outline","text-color","disable"])])),_:1}),(0,s.Wm)(p,{modelValue:e.key,"onUpdate:modelValue":t[3]||(t[3]=t=>e.key=t),ref:"keyInput","bottom-slots":"",outlined:"",label:e.watchOnly?"enter public key":"enter private key",dense:""},{hint:(0,s.w5)((()=>[!e.key&&e.watchOnly?((0,s.wg)(),(0,s.iD)("p",de," entering public key means you will need to enter private key each time you post content (either manually or by Nostr browser extension) ")):(0,s.kq)("",!0),e.key||e.watchOnly?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("p",ue," entering private key means astral will automatically sign with your private key each time you post content ")),e.key&&!e.isKeyValid?((0,s.wg)(),(0,s.iD)("p",pe,"not a valid key")):(0,s.kq)("",!0),e.isKeyValid?((0,s.wg)(),(0,s.iD)("p",me,"key is valid")):(0,s.kq)("",!0)])),append:(0,s.w5)((()=>[e.isKeyValid?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(r,{key:0,size:"sm",color:"primary",outline:"",onClick:e.generate},{default:(0,s.w5)((()=>[ye])),_:1},8,["onClick"])),e.hasExtension&&!e.isKeyValid?((0,s.wg)(),(0,s.j4)(r,{key:1,size:"sm",color:"primary",outline:"",onClick:e.getFromExtension},{default:(0,s.w5)((()=>[he])),_:1},8,["onClick"])):(0,s.kq)("",!0),(0,s.Wm)(r,{type:"submit",unelevated:"",size:"sm",color:"positive",label:e.isKeyValid?"proceed":"","icon-right":"login",style:{color:"var(--q-background) !important"},onClick:e.proceed,disabled:!e.isKeyValid},null,8,["label","onClick","disabled"])])),_:1},8,["modelValue","label"])])),_:1})])),_:1},8,["onSubmit"]),e.isKeyValid?((0,s.wg)(),(0,s.j4)(d,{key:0,dense:"","dense-toggle":"","default-opened":"",id:"bootstrap-relays"},{header:(0,s.w5)((()=>[(0,s._)("div",ge,[ke,(0,s.Wm)(g,{name:"info"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[we])),_:1})])),_:1})])])),default:(0,s.w5)((()=>[(0,s._)("div",fe,[be,(0,s._)("div",ve,[(0,s.Wm)(p,{modelValue:e.newRelay,"onUpdate:modelValue":t[4]||(t[4]=t=>e.newRelay=t),placeholder:"add a relay...","input-style":"padding: 0; width: 10rem;",onKeypress:(0,n.D2)(e.addNewRelay,["enter"]),dense:"",borderless:""},null,8,["modelValue","onKeypress"]),(0,s.Wm)(r,{icon:"add",color:"positive",size:"sm",flat:"",dense:"",onClick:(0,n.iM)(e.addNewRelay,["stop"])},null,8,["onClick"])])]),(0,s.Wm)(k,null,{selected:(0,s.w5)((()=>[(0,s._)("pre",qe,[_e,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Object.keys(e.selectedRelays),((t,o)=>((0,s.wg)(),(0,s.iD)("li",{key:o+"-"+t,class:"relay-item",onClick:(0,n.iM)((o=>delete e.selectedRelays[t]),["stop"])},[$e,(0,s._)("div",xe,[ze,(0,s._)("span",Pe,(0,_.zw)(t),1),Me,(0,s.Wm)(g,{name:"remove",size:"xs",color:"negative"}),Ze]),Ee],8,Ce)))),128)),Se])])),options:(0,s.w5)((()=>[(0,s._)("div",Ue,[(0,s._)("pre",We,[Be,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.optionalRelays,((t,o)=>((0,s.wg)(),(0,s.iD)("li",{key:o+"-"+t,class:"relay-item",onClick:(0,n.iM)((o=>e.selectedRelays[t]={read:!0,write:!1}),["stop"])},[je,(0,s._)("div",Ke,[Te,(0,s._)("span",Qe,(0,_.zw)(t),1),De,(0,s.Wm)(g,{name:"add",size:"xs",color:"positive",flat:""}),Oe]),Ie],8,Re)))),128)),Fe])])])),_:1})])),_:1})):(0,s.kq)("",!0),Le])),_:1})}var Ne=o(74961),Ae=o(67694),He=o(67903),Ye=o(37844);const Ge=(0,s.aZ)({name:"TheKeyInitializationDialog",mixins:[P.Z],emits:["look-around"],components:{BaseSelectMultiple:He.Z,BaseInformation:Ye.Z},setup(){return{focusKeyInput(){this.$refs.keyInput.focus()}}},data(){return{watchOnly:!1,key:null,hasExtension:!1,selectedRelays:this.$store.state.defaultRelays,newRelay:""}},computed:{icon(){return document.getElementById("icon").href},isKeyKey(){return!!this.isKey(this.hexKey)},isKeyValid(){var e;return!!this.isKeyKey||!!(0,Ne.jk)(null===(e=this.key)||void 0===e?void 0:e.toLowerCase())},isKeyInvalid(){return!this.isKeyValid},hexKey(){var e;return this.isBech32Key(this.key)?this.bech32ToHex(this.key):null===(e=this.key)||void 0===e?void 0:e.toLowerCase()},isBech32Pub(){return!!this.isBech32Key(this.key)&&this.key.toLowerCase().startsWith("npub")},isBech32Sec(){return!!this.isBech32Key(this.key)&&this.key.toLowerCase().startsWith("nsec")},optionalRelays(){let e=this.$store.state.optionalRelaysList.filter((e=>!(this.newRelay.length&&!e.toLowerCase().includes(this.newRelay.toLowerCase()))&&!this.selectedRelays[e]));return e}},async created(){this.$store.state.keys.pub||setTimeout((()=>{window.nostr&&(this.hasExtension=!0)}),1e3)},methods:{async getFromExtension(){try{this.key=await window.nostr.getPublicKey(),this.watchOnly=!0,this.focusKeyInput()}catch(e){this.$q.notify({message:`Failed to get a public key from a Nostr extension: ${e}`,color:"warning"})}},generate(){this.key=(0,Ae.wQ)(),this.watchOnly=!1,this.focusKeyInput()},proceed(){let e=this.hexKey;var t={};(0,Ne.jk)(e)?t.mnemonic=e:this.isKey(e)?this.watchOnly?t.pub=e:t.priv=e:console.warn("Proceed called with invalid key",e),this.$store.commit("setDefaultRelays",this.selectedRelays),this.$store.dispatch("initKeys",t),this.$store.dispatch("launch"),this.initializeKeys=!1,this.$router.push({name:"settings",params:{initUser:!0}})},addNewRelay(){this.newRelay&&this.newRelay.length&&(this.selectedRelays[this.newRelay]={read:!0,write:!1}),this.newRelay=""}}});var Je=o(61123),Xe=o(8326),et=o(63190),tt=o(67236),ot=o(66611),st=o(46858),nt=o(18149);const it=(0,B.Z)(Ge,[["render",Ve],["__scopeId","data-v-3e282e4a"]]),lt=it;T()(Ge,"components",{QDialog:X.Z,QCard:ee.Z,QBtn:R.Z,QExpansionItem:Je.Z,QForm:Xe.Z,QCardSection:et.Z,QBtnGroup:tt.Z,QInput:ot.Z,QIcon:j.Z,QTooltip:st.Z,QField:nt.Z});var at=o(57674);const{getVerticalScrollPosition:rt,setVerticalScrollPosition:ct}=v.ZP,dt=(0,s.aZ)({name:"MainLayout",components:{TheUserMenu:se,TheSearchMenu:ne.Z,TheKeyInitializationDialog:lt},setup(){const e=(0,q.Z)();return e},data(){return{cachedPages:["Feed","Notifications","DevTools","Settings","Inbox"],middlePagePos:{},fabPos:[0,10],draggingFab:!1,broadcastChannel:new BroadcastChannel("astral"),activeWindow:!1,timeout:null,hasLaunched:!1,postEntryOpen:!1,replyEvent:null,googleFontsName:"",updatingFont:!0,lookingAround:!1}},computed:{scrollingContainer(){var e;return this.$q.screen.width<600?window:null===(e=this.$refs.pageContainer)||void 0===e?void 0:e.$el},messageMode(){return"messages"===this.$route.name?this.replyEvent?"reply":"message":null},initializeKeys(){return!this.lookingAround}},created(){this.loadPreferences()},mounted(){var e;this.launch(),document.querySelector("#left-drawer").addEventListener("wheel",this.redirectScroll,{passive:!0}),this.$router.beforeEach(((e,t)=>{this.preserveScrollPos(e,t),"messages"===e.name&&this.postEntryOpen&&(this.postEntryOpen=!1)})),this.$router.afterEach(((e,t)=>{this.restoreScrollPos(e,t)}));let t=null===(e=this.$refs.pageContainer)||void 0===e?void 0:e.$el.getBoundingClientRect();t&&(this.fabPos[0]=t.right-t.width),this.updatingFont=!1,this.resizePostEntryPlaceholder()},beforeUnmount(){document.querySelector("#left-drawer").removeEventListener("wheel",this.redirectScroll)},methods:{redirectScroll(e){let t=rt(this.scrollingContainer);ct(this.scrollingContainer,t+e.deltaY)},preserveScrollPos(e,t){this.cachedPages.map((e=>e.toLowerCase())).includes(t.name)&&(this.middlePagePos[t.fullPath]=rt(this.scrollingContainer))},restoreScrollPos(e,t){this.middlePagePos[e.fullPath]?ct(this.scrollingContainer,this.middlePagePos[e.fullPath],500):this.scrollToTop()},scrollToTop(){ct(this.scrollingContainer,0,500)},back(){this.$router.go(-1)},forward(){this.$router.go(1)},moveFab(e){this.draggingFab=!0!==e.isFirst&&!0!==e.isFinal,this.fabPos=[this.fabPos[0]-e.delta.x,this.fabPos[1]+e.delta.y]},scrollToRect(e){let t=Math.max(e.top,0);ct(this.scrollingContainer,t,500)},async launch(){this.timeout=null,this.$store.state.keys.pub?this.$store.dispatch("launch"):this.$store.dispatch("launchWithoutKey"),this.hasLaunched=!0},togglePostEntry(){this.postEntryOpen=!this.postEntryOpen},setReplyEvent(e){this.replyEvent=e,console.log("event",e,this.replyEvent)},resizePostEntryPlaceholder(){setTimeout((()=>{var e;document.querySelector("#bottom-drawer-placeholder").style.minHeight=`${(null===(e=document.querySelector("#bottom-drawer"))||void 0===e?void 0:e.clientHeight)||0}px`}),1e3)},updateFont(e){this.updatingFont=!0,(0,at.Z)("font",e),this.googleFontsName=e.replace(" ","+"),this.updatingFont=!1},lightOrDark(e){var t,o,s,n;return e.match(/^rgb/)?(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),t=e[1],o=e[2],s=e[3]):(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")),t=e>>16,o=e>>8&255,s=255&e),n=Math.sqrt(t*t*.299+o*o*.587+s*s*.114),n>127.5?"light":"dark"},loadPreferences(){let{primary:e,secondary:t,accent:o,background:s}=this.$store.state.config.preferences.color;(0,at.Z)("primary",e),(0,at.Z)("secondary",t),(0,at.Z)("accent",o),(0,at.Z)("background",s),this.$q.dark.set("dark"===this.lightOrDark(s)),this.updateFont(this.$store.state.config.preferences.font)},setLookingAroundMode(){this.lookingAround=!0}}});var ut=o(77605),pt=o(12133),mt=o(30627),yt=o(88830),ht=o(2873);const gt=(0,B.Z)(dt,[["render",b]]),kt=gt;T()(dt,"components",{QLayout:ut.Z,QDialog:X.Z,QPageContainer:pt.Z,QSeparator:Y.Z,QBtn:R.Z,QPageSticky:mt.Z,QFab:yt.Z,QTooltip:st.Z,QIcon:j.Z}),T()(dt,"directives",{TouchPan:ht.Z})}}]);